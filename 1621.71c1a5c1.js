"use strict";(self.webpackChunkcos_ui=self.webpackChunkcos_ui||[]).push([[1621],{4323:(e,t,n)=>{n.d(t,{e:()=>xn});var a=n(35898),o=n.n(a),r=n(96486),c=n.n(r),i=n(13318),l=n(79468);const s=({accessToken:e,connectorsApiBasePath:t,connectorId:n})=>{const a=new i.ConnectorsApi(new i.Configuration({accessToken:e,basePath:t}));return(e,t)=>{const r=o().CancelToken.source();return a.getConnector(n,{cancelToken:r.token}).then((t=>{e(t.data)})).catch((e=>{o().isCancel(e)||t(e.response.data.reason)})),()=>{r.cancel("Operation canceled by the user.")}}},d=({accessToken:e,connectorsApiBasePath:t,connectorTypeId:n})=>{const a=new i.ConnectorTypesApi(new i.Configuration({accessToken:e,basePath:t}));return e=>{const t=o().CancelToken.source();return a.getConnectorTypeByID(n,{cancelToken:t.token}).then((t=>{e(t.data)})).catch((e=>{o().isCancel(e)||console.log("Error:",e.response.data.reason)})),()=>{t.cancel("Operation canceled by the user.")}}};var u=n(75418),p=n.n(u),m=n(31521),g=n(21012),v=n(91999);const f=({name:e,status:t})=>{const n=function(e){var t;const{t:n}=(0,m.useTranslation)(),a=[{value:C.Ready,label:n("running")},{value:C.Failed,label:n("failed")},{value:C.Assigning,label:n("creationPending")},{value:C.Assigned,label:n("creationInProgress")},{value:C.Updating,label:n("creationInProgress")},{value:C.Provisioning,label:n("creationInProgress")},{value:C.Deleting,label:n("deleting")},{value:C.Deleted,label:n("deleted")},{value:C.Disconnected,label:n("provisioning")}];return(null===(t=a.find((t=>t.value===e)))||void 0===t?void 0:t.label)||e}(t);return p().createElement(g.Flex,null,p().createElement(g.FlexItem,{spacer:{default:"spacerSm"}},p().createElement(E,{name:e,status:t})),p().createElement(g.FlexItem,null,n))},E=({name:e,status:t})=>{switch(null==t?void 0:t.toLowerCase()){case"ready":return p().createElement(v.CheckCircleIcon,{className:"cos--connectors__table--icon--completed"});case"failed":return p().createElement(v.ExclamationCircleIcon,{className:"cos--connectors__table--icon--failed"});case"accepted":return p().createElement(v.PendingIcon,null);case"provisioning":case"preparing":case"disconnected":return p().createElement(g.Spinner,{size:"md","aria-label":e,"aria-valuetext":"Creation in progress"});case"deprovision":case"deleted":return null}return p().createElement(v.PendingIcon,null)};var C;!function(e){e.Ready="ready",e.Failed="failed",e.Assigning="assigning",e.Assigned="assigned",e.Updating="updating",e.Provisioning="provisioning",e.Deleting="deleting",e.Deleted="deleted",e.Disconnected="disconnected"}(C||(C={}));var h=n(91031);const y="paginatedApi";var b;!function(e){e.Overview="overview",e.Configuration="configuration"}(b||(b={}));const S=(0,u.createContext)(null),T=({getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n,children:a})=>p().createElement(S.Provider,{value:{getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n}},a),k=()=>{const e=(0,u.useContext)(S);if(!e)throw new Error("useAppContext must be used inside an AppContextProvider");return Object.assign({},e)};var I=n(98068),x=n(9980),A=n(70655),P=n(98823);const D=({error:e})=>p().createElement("div",{role:"alert"},p().createElement("p",null,"Something went wrong: "),p().createElement("pre",null,e.message)),N=({children:e})=>p().createElement(P.ErrorBoundary,{FallbackComponent:D,resetKeys:[Date.now()]},e),w=(e,t)=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){const a=Promise.resolve({steps:!1,Configurator:!1});return new Promise((o=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){try{const a=yield B(t,e);yield O(a.remoteEntry),o(function(e,t){return(0,A.__awaiter)(this,void 0,void 0,(function*(){yield n.I("default");const a=window[e];yield a.init(n.S.default);const o=(yield window[e].get(t))();return console.log(`loaded federated configurator configuration from ${e}`,o),o.default}))}(a.scope,a.module))}catch(e){o(a)}}))))})),B=(e,t)=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){console.log("Fetched federated configurator remotes configuration",e);const n=e[t.id]||e[t.id.split("-")[0]];return console.log(`Candidate configuration for "${t.id}"`,n),n?(a=n)&&a.remoteEntry&&"string"==typeof a.remoteEntry&&a.scope&&"string"==typeof a.scope&&a.module&&"string"==typeof a.module?(console.log("Found a generic configuration for the connector",n),n):(console.log("Couldn't find a valid configuration for the requested connector"),Promise.reject()):(console.log("Couldn't find any configuration for the requested connector"),Promise.reject());var a})),O=e=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){return new Promise(((t,n)=>{const a=document.createElement("script");a.src=e,a.type="text/javascript",a.async=!0,a.onload=()=>{console.log(`Dynamic federated module loaded: ${e}`),document.head.removeChild(a),t()},a.onerror=()=>{console.error(`Dynamic federated module Error: ${e}`),console.log(`Dynamic federated module Removed: ${e}`),document.head.removeChild(a),n()},document.head.appendChild(a)}))}));const M=e=>{const t={};return e.forEach(((e,n)=>{t[n]=e})),t},_=e=>Object.keys(e).map((t=>{c().isEmpty(e[t])&&(e[t]="")})),j=({editMode:e,configuration:t,changeIsValid:n,onUpdateConfiguration:a})=>{var o;const{t:r}=(0,m.useTranslation)();return p().createElement(p().Fragment,null,p().createElement(g.Title,{headingLevel:"h3",size:g.TitleSizes["2xl"],className:"pf-u-pr-md pf-u-pb-md"},r("common")),p().createElement(g.Form,null,p().createElement(g.FormGroup,{label:r("connectorName"),isRequired:!0,fieldId:"connector-name",labelIcon:p().createElement(g.Popover,{bodyContent:p().createElement("p",null,r("connectorNamePopoverBody"))},p().createElement("button",{type:"button","aria-label":"More info for name field.",onClick:e=>e.preventDefault(),"aria-describedby":"simple-form-name-01",className:"pf-c-form__group-label-help"},p().createElement(v.HelpIcon,{noVerticalAlign:!0})))},e?p().createElement(g.TextInput,{value:t.name,onChange:e=>(e=>{a("common",Object.assign(Object.assign({},t),{name:e})),n(""!==e)})(e),id:"connector-name"}):p().createElement(g.Text,{component:g.TextVariants.p},t.name)),p().createElement(g.FormGroup,{label:r("serviceAccount"),fieldId:"service-account"},p().createElement(p().Fragment,null,p().createElement(g.FormGroup,{label:r("clientId"),isRequired:!0,fieldId:"clientId"},p().createElement(g.ClipboardCopy,{isReadOnly:!0,hoverTip:"copy",clickTip:"Copied"},null===(o=null==t?void 0:t.service_account)||void 0===o?void 0:o.client_id))))))};var L=n(75220),q=n(71322);const F=new(n.n(q)())({allErrors:!0,useDefaults:!1,strict:"log",strictSchema:!1});function R(e){const t=F.compile(e);return e=>{var n;return t(e),(null===(n=t.errors)||void 0===n?void 0:n.length)?{details:t.errors}:null}}var z=n(39443),G=n(38524),V=n(39494),H=n.n(V);const K=(e,t)=>void 0!==t?p().createElement(m.Translation,null,(n=>p().createElement(g.Popover,{bodyContent:t},p().createElement("button",{type:"button","aria-label":n("moreConnectorInfo",{name:e}),onClick:e=>e.preventDefault(),"aria-describedby":"form-group-label-info",className:"pf-c-form__group-label-help"},p().createElement(v.HelpIcon,{noVerticalAlign:!0}))))):void 0;class J extends(H()){constructor(e,t){super(e,t)}getField(e){const t=super.getField(e),{description:n,example:a,title:o}=t,r=(0,A.__rest)(t,["description","example","title"]);return Object.assign({helperText:(c=a,void 0!==c?`Example: ${c}`:void 0),labelIcon:K(o,n),title:o},r);var c}}const W=new L.Resolver,$=({schema:e,configuration:t,onChange:n,editCase:a,duplicateMode:o})=>{e.type=e.type||"object";try{delete e.properties.steps}catch(e){}const r=R(e),i=new J(e,r),{required:l}=i.schema;const s=(e,t)=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){const a=JSON.parse(JSON.stringify(e));let o=[];if(void 0!==a.data_shape){o=yield function(){var e;return(0,A.__awaiter)(this,void 0,void 0,(function*(){const t=JSON.parse(JSON.stringify(i));let n=[];for(const[a]of Object.entries(null===(e=t.schema.properties.data_shape)||void 0===e?void 0:e.properties)){const e=yield W.resolve(t.schema,{jsonPointer:`#/$defs/data_shape/${a}`}),o=yield e.result;n=Object.assign(Object.assign({},n),{[a]:o})}return n}))}();const{data_shape:e}=a;Object.keys(e).map((t=>{var n,r;const i=null===(r=null===(n=o[t].properties)||void 0===n?void 0:n.format)||void 0===r?void 0:r.default;c().isEmpty(e[t])&&(a.data_shape[t]={format:i})}))}const r={};for(const[e,t]of Object.entries(a))for(const n in l)if(e===l[n]&&void 0!==t){const n={[e]:t};Object.assign(r,n)}const s=(e,t)=>{const n=Object.keys(e).sort(),a=t.slice().sort();return JSON.stringify(n)===JSON.stringify(a)};a.data_shape,t=s(r,l),n(a,t||!1)}));return p().useEffect((()=>{o&&(_(t),n(t,!0))}),[t]),p().createElement(g.Grid,{hasGutter:!0},p().createElement(U,{schema:i,model:t,onChangeModel:e=>s(e,!1),className:"connector-specific pf-c-form pf-m-9-col-on-lg"},Object.keys(i.schema.properties).map((e=>!["processors","error_handler"].includes(e)&&p().createElement(G.AutoField,{key:e,name:e,disabled:(a||o)&&c().find(i.schema.properties[e].oneOf,{format:"password"})})))))};const U=function e(t){class n extends(z.AutoForm.Auto(t)){onChange(e,t){if(""===t)return super.onChange(e,void 0);super.onChange(e,t)}}return n.Auto=e,n}(z.ValidatedQuickForm),Q=({editMode:e,schema:t,configuration:n,changeIsValid:a,onUpdateConfiguration:o})=>{const{t:r}=(0,m.useTranslation)(),i=JSON.parse(JSON.stringify(n));_(i);return p().createElement(p().Fragment,null,p().createElement(g.Title,{headingLevel:"h3",size:g.TitleSizes["2xl"],className:"pf-u-pr-md pf-u-pb-md"},r("connectorSpecific")),e?p().createElement($,{schema:t,configuration:i||{},onChange:(e,t)=>{o("connector",e),a(t)},editCase:!0}):p().createElement(g.Form,null,Object.entries(t.properties).filter((([e,t])=>!["object","array"].includes(t.type)||!("data_shape"!==e||!i[e]))).map((([e,n])=>p().createElement(g.FormGroup,{key:e,label:n.title||c().capitalize(e.replace("_"," ")),fieldId:e,isRequired:t.required.includes(e),labelIcon:p().createElement(g.Popover,{bodyContent:p().createElement("p",null,n.description?n.description:c().capitalize(e.replace("_"," ")))},p().createElement("button",{type:"button","aria-label":"More info for name field",onClick:e=>e.preventDefault(),"aria-describedby":"simple-form-name-01",className:"pf-c-form__group-label-help"},p().createElement(v.HelpIcon,{noVerticalAlign:!0})))},"data_shape"===e?p().createElement(Z,{data:i[e]}):p().createElement(g.Text,{component:g.TextVariants.p},c().isObject(i[e])?JSON.stringify(i[e]):i[e]))))))},Z=({data:e})=>p().createElement(p().Fragment,null,Object.keys(e).map((t=>p().createElement(g.FormGroup,{key:t,label:c().upperFirst(t),fieldId:t},p().createElement(g.Text,{component:g.TextVariants.p},e[t].format))))),Y=({editMode:e,schema:t,configuration:n,changeIsValid:a,onUpdateConfiguration:o})=>{var r;const[i,l]=(0,u.useState)(!1),[s,d]=(0,u.useState)(),[f,E]=(0,u.useState)(),{t:C}=(0,m.useTranslation)(),h=()=>{l(!1)};(0,u.useEffect)((()=>(E(Object.keys(n)[0]),"dead_letter_queue"!==Object.keys(n)[0]||c().isEmpty(n.dead_letter_queue)||d(n.dead_letter_queue[Object.keys(n.dead_letter_queue)[0]]),()=>{})),[n]);const y=R(t),b=new V.JSONSchemaBridge(t,y),{error_handler:S}=null===(r=b.schema)||void 0===r?void 0:r.properties,T=S.oneOf.map((e=>{const t=Object.keys(e.properties);return p().createElement(g.SelectOption,{key:t[0],value:t[0]})}));return p().createElement(p().Fragment,null,p().createElement(g.Title,{headingLevel:"h3",size:g.TitleSizes["2xl"],className:"pf-u-pr-md pf-u-pb-md"},"Error handling"),p().createElement(g.Form,null,p().createElement(g.FormGroup,{label:C("errorHandler"),fieldId:"error-handler_strategy",className:"error-handler_strategy"},e?p().createElement(g.Select,{variant:g.SelectVariant.single,"aria-label":"Select Error handler",onToggle:()=>l((e=>!e)),onSelect:(e,t,n)=>{n?h():(l(!1),d(""),E(t),a("dead_letter_queue"!==t||!!s),o("error",{[t]:{}}))},selections:f,isOpen:i,placeholderText:"Select type"},T):p().createElement(g.Text,{component:g.TextVariants.p},f)),"dead_letter_queue"===f&&p().createElement(g.FormGroup,{label:"Dead Letter Topic Name",isRequired:!0,fieldId:"topic",labelIcon:p().createElement(g.Popover,{bodyContent:p().createElement("p",null,"The name of the Kafka topic used as dead letter queue")},p().createElement("button",{type:"button","aria-label":"More info for name field",onClick:e=>e.preventDefault(),"aria-describedby":"simple-form-name-01",className:"pf-c-form__group-label-help"},p().createElement(v.HelpIcon,{noVerticalAlign:!0})))},e?p().createElement(g.TextInput,{value:s,onChange:e=>{d(e),a(!!e),o("error",{dead_letter_queue:{topic:e}})},id:"topic"}):p().createElement(g.Text,{component:g.TextVariants.p},s))))},X=(e,t)=>((e,t)=>{let n=[];return c().each(e,((e,a)=>{void 0!==t&&t[a]!==e&&t[a]!=={}&&""!==e&&n.push(a)})),n})(e,t).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:e[n]})),{}),ee=({onSave:e,editMode:t,updateEditMode:n,connectorData:a,connectorTypeDetails:r})=>{var l,s;const{t:d}=(0,m.useTranslation)(),v=(0,x.useAlert)(),f=(0,x.useConfig)(),{connectorsApiBasePath:E,getToken:C}=k(),[y,b]=(0,u.useState)(!1),[S,T]=(0,u.useState)(!1),[I,P]=(0,u.useState)(0),[D,B]=(0,u.useState)({}),[O,_]=(0,u.useState)(),[L,q]=(0,u.useState)({}),[F,R]=(0,u.useState)(),[z,G]=(0,u.useState)(!0),V=()=>b(!1),H=(0,u.useCallback)(((e,t)=>{switch(T(!0),e){case"common":B(t);break;case"connector":_(t);break;case"error":q(t)}}),[B,_,q]),K=(0,u.useCallback)((e=>{null==v||v.addAlert({id:"connectors-table-error",variant:g.AlertVariant.danger,title:d("somethingWentWrong"),description:e})}),[v,d]),J=(0,u.useCallback)((()=>{n(!1),null==v||v.addAlert({id:"connector-created",variant:g.AlertVariant.success,title:d("editAlertSuccessTitle")}),e()}),[v,d,n,e]),W=()=>{var e;const{name:t,service_account:n}=a;B({name:t,service_account:n}),_(null==a?void 0:a.connector),q(null===(e=null==a?void 0:a.connector)||void 0===e?void 0:e.error_handler)},$=()=>{W(),n(!1),V()},U=(0,u.useCallback)(((e,t)=>{_(e),G(t)}),[_,G]);let Z;(0,u.useEffect)((()=>{W(),(0,A.__awaiter)(void 0,void 0,void 0,(function*(){try{Z=yield w(r,(null==f?void 0:f.cos.configurators)||{}),R(Z)}catch(e){console.log("No configurator provided.",e)}}))}),[]);return p().createElement(p().Fragment,null,p().createElement(g.PageSection,{variant:g.PageSectionVariants.light},p().createElement(g.Grid,{style:{paddingBottom:"50px"}},p().createElement(g.GridItem,{span:3},p().createElement("div",null,p().createElement(g.Tabs,{activeKey:I,onSelect:(e,t)=>{P(t)},isVertical:!0},p().createElement(g.Tab,{eventKey:0,title:p().createElement(g.TabTitleText,null,d("common"))}),a.connector_type_id.includes("debezium")&&F&&F.steps&&F.steps.map(((e,t)=>p().createElement(g.Tab,{key:e,eventKey:t+1,title:p().createElement(g.TabTitleText,null,e)}))),!a.connector_type_id.includes("debezium")&&p().createElement(p().Fragment,null,p().createElement(g.Tab,{eventKey:1,title:p().createElement(g.TabTitleText,null,d("connectorSpecific"))}),p().createElement(g.Tab,{eventKey:2,title:p().createElement(g.TabTitleText,null,d("errorHandling"))}))))),p().createElement(g.GridItem,{span:9},p().createElement(g.Grid,null,p().createElement(g.GridItem,{span:10},0===I&&p().createElement(N,null,!c().isEmpty(D)&&p().createElement(j,{editMode:t,configuration:D,changeIsValid:G,onUpdateConfiguration:H})),a.connector_type_id.includes("debezium")&&(null==F?void 0:F.Configurator)&&p().createElement(N,null,p().createElement(p().Fragment,null,p().createElement(g.Title,{headingLevel:"h3",size:g.TitleSizes["2xl"],className:"pf-u-pr-md pf-u-pb-md"},null==F?void 0:F.steps[I-1]),p().createElement(p().Suspense,{fallback:h.g},p().createElement(te,{Configurator:null==F?void 0:F.Configurator,isEditMode:t,configuration:O,updateFedConfiguration:U,connector:r,step:I})))),!a.connector_type_id.includes("debezium")&&1===I&&p().createElement(N,null,p().createElement(Q,{editMode:t,schema:null===(l=r)||void 0===l?void 0:l.schema,configuration:O,changeIsValid:G,onUpdateConfiguration:H})),!a.connector_type_id.includes("debezium")&&2===I&&p().createElement(N,null,p().createElement(Y,{editMode:t,schema:null===(s=r)||void 0===s?void 0:s.schema,configuration:L,changeIsValid:G,onUpdateConfiguration:H}))),p().createElement(g.GridItem,{span:2,className:"pf-u-pl-md"},!t&&p().createElement(g.Button,{variant:"primary",onClick:()=>{n(!t)}},d("editProperties"))))))),t&&p().createElement(g.PageSection,{className:"pf-u-p-md pf-u-box-shadow-md-top configuration-page_footer",hasShadowTop:!0,variant:"light"},p().createElement(g.Button,{variant:"primary",className:"pf-u-mr-md pf-u-mb-sm",onClick:()=>{(({accessToken:e,connectorsApiBasePath:t,connectorUpdate:n,connectorId:a,updatedName:r})=>{const l=new i.ConnectorsApi(new i.Configuration({accessToken:e,basePath:t}));return(e,t)=>{const i=o().CancelToken.source();return l.patchConnector(a,Object.assign(Object.assign({},r&&{name:r}),!c().isEmpty(n)&&{connector:Object.assign({},n)}),{cancelToken:i.token,headers:{"Content-type":"application/merge-patch+json"}}).then((()=>{e()})).catch((e=>{o().isCancel(e)||t(e.response.data.reason)})),()=>{i.cancel("Operation canceled by the user.")}}})(Object.assign({accessToken:C,connectorsApiBasePath:E,connectorUpdate:Object.assign({},X(Object.assign(Object.assign({},O instanceof Map?M(O):O),{error_handler:L}),a.connector)),connectorId:a.id},D.name!==a.name&&{updatedName:D.name}))(J,K)},isDisabled:!z},d("Save")),p().createElement(g.Button,{variant:"secondary",onClick:S?()=>b(!0):$},d("cancel"))),p().createElement(g.Modal,{title:d("leaveEditConfirmModalTitle"),variant:"small",isOpen:y,onClose:V,actions:[p().createElement(g.Button,{key:"confirm",variant:"primary",onClick:$},d("leave")),p().createElement(g.Button,{key:"cancel",variant:"link",onClick:V},d("cancel"))]},d("leaveEditConfirmModalDescription")))},te=({Configurator:e,connector:t,configuration:n,updateFedConfiguration:a,isEditMode:o,step:r})=>{let c;return n instanceof Map?c=new Map(n):(c=JSON.parse(JSON.stringify(n)),_(c)),p().createElement(e,{activeStep:r-1,connector:t,isViewMode:!o,configuration:c instanceof Map?c:new Map(Object.entries(c)),onChange:a})},ne=({name:e,id:t,type:n,bootstrapServer:a,kafkaId:o,owner:r,namespaceId:c,createdAt:i,modifiedAt:l,error:s})=>{const{t:d}=(0,m.useTranslation)(),u=(e,t)=>p().createElement(p().Fragment,null,t&&p().createElement(p().Fragment,null,p().createElement(g.TextListItem,{component:g.TextListItemVariants.dt},e),p().createElement(g.TextListItem,{component:g.TextListItemVariants.dd},t)));return p().createElement(g.TextContent,null,p().createElement(g.TextList,{component:g.TextListVariants.dl},u(d("connector"),e),u(d("connectorId"),t),u(d("connectorType"),n),u(d("bootstrapServer"),a),u(d("kafkaInstance"),o),u(d("deploymentNamespace"),c),u(d("owner"),r),u(d("timeCreated"),p().createElement("time",{title:d("{{date}}",{date:i}),dateTime:i.toISOString()},d("{{ date, ago }}",{date:i}))),u(d("timeUpdated"),p().createElement("time",{title:d("{{date}}",{date:l}),dateTime:l.toISOString()},d("{{ date, ago }}",{date:l}))),u(d("failureReason"),s)))},ae=({connectorData:e})=>{var t,n,a;return p().createElement(g.PageSection,{variant:g.PageSectionVariants.light},p().createElement(ne,{name:null==e?void 0:e.name,id:null==e?void 0:e.id,type:null==e?void 0:e.connector_type_id,bootstrapServer:null===(t=null==e?void 0:e.kafka)||void 0===t?void 0:t.url,kafkaId:null===(n=null==e?void 0:e.kafka)||void 0===n?void 0:n.id,namespaceId:null==e?void 0:e.namespace_id,owner:null==e?void 0:e.owner,createdAt:new Date(null==e?void 0:e.created_at),modifiedAt:new Date(null==e?void 0:e.modified_at),error:null===(a=null==e?void 0:e.status)||void 0===a?void 0:a.error}))},oe=e=>e.includes("&")?e.substr(1,e.indexOf("&")-1):e.substr(1),re=({onSave:e})=>{let{id:t}=(0,I.useParams)(),{hash:n}=(0,I.useLocation)();const a=(0,I.useHistory)(),o=(0,x.useAlert)(),{t:r}=(0,m.useTranslation)(),{connectorsApiBasePath:c,getToken:i}=k(),[l,v]=(0,u.useState)(oe(n)),[f,E]=(0,u.useState)(),[C,y]=(0,u.useState)(),[S,T]=(0,u.useState)(),A=(0,u.useCallback)((e=>{y(e)}),[]),P=(0,u.useCallback)((e=>{T(e)}),[]),D=(0,u.useCallback)((e=>{E(e)}),[E]),N=(0,u.useCallback)((e=>{null==o||o.addAlert({id:"connectors-table-error",variant:g.AlertVariant.danger,title:r("somethingWentWrong"),description:e})}),[o,r]);(0,u.useEffect)((()=>{n.includes(b.Configuration)&&E(!0)}),[]),(0,u.useEffect)((()=>{s({accessToken:i,connectorsApiBasePath:c,connectorId:t})(A,N)}),[t]),(0,u.useEffect)((()=>{v(oe(n))}),[n]),(0,u.useEffect)((()=>{(null==C?void 0:C.connector_type_id)&&d({accessToken:i,connectorsApiBasePath:c,connectorTypeId:null==C?void 0:C.connector_type_id})(P)}),[C]);return p().createElement(p().Fragment,null,!C&&p().createElement(h.g,null),C&&p().createElement(p().Fragment,null,p().createElement(ce,{connectorData:C}),p().createElement(g.PageSection,{padding:{default:"noPadding"},style:{zIndex:0},variant:g.PageSectionVariants.light},p().createElement(g.Tabs,{activeKey:l,onSelect:(e,t)=>{v(t),a.push(`#${t}`)},className:"connector_detail-tabs"},p().createElement(g.Tab,{eventKey:b.Overview,title:p().createElement(g.TabTitleText,null,r("overview"))},p().createElement(ae,{connectorData:C})),p().createElement(g.Tab,{eventKey:b.Configuration,title:p().createElement(g.TabTitleText,null,r("configuration"))},S?p().createElement(ee,{onSave:e,editMode:f||!1,updateEditMode:D,connectorData:C,connectorTypeDetails:S}):p().createElement(h.g,null))))))},ce=({connectorData:e})=>{var t;const{t:n}=(0,m.useTranslation)(),a=(0,x.useBasename)();return p().createElement(g.PageSection,{variant:"light",hasShadowBottom:!0},p().createElement(g.Breadcrumb,null,p().createElement(g.BreadcrumbItem,{to:null==a?void 0:a.getBasename()},n("connectorsInstances")),p().createElement(g.BreadcrumbItem,{isActive:!0},null==e?void 0:e.name)),p().createElement(g.Level,{className:"pf-u-pt-md pf-u-pb-md"},p().createElement(g.LevelItem,null,p().createElement(g.Level,null,p().createElement(g.Title,{headingLevel:"h1",className:"pf-u-pr-md"},null==e?void 0:e.name),p().createElement(f,{name:null==e?void 0:e.name,status:null===(t=null==e?void 0:e.status)||void 0===t?void 0:t.state}))),p().createElement(g.LevelItem,null)))},ie=({children:e,connector:t,onClose:n})=>{var a,o;return p().createElement(g.Drawer,{isExpanded:void 0!==t},p().createElement(g.DrawerContent,{panelContent:t?p().createElement(le,{name:t.name,id:t.id,bootstrapServer:t.kafka.url,kafkaId:t.kafka.id,owner:t.owner,namespaceId:t.namespace_id,createdAt:new Date(t.created_at),modifiedAt:new Date(t.modified_at),status:null===(a=t.status)||void 0===a?void 0:a.state,error:null===(o=t.status)||void 0===o?void 0:o.error,onClose:n}):void 0},e))},le=({name:e,id:t,bootstrapServer:n,kafkaId:a,owner:o,namespaceId:r,createdAt:c,modifiedAt:i,status:l,error:s,onClose:d})=>{const{t:v}=(0,m.useTranslation)(),[E,C]=(0,u.useState)(0);return p().createElement(g.DrawerPanelContent,{widths:{default:"width_50"}},p().createElement(g.DrawerHead,null,p().createElement(g.TextContent,null,p().createElement(g.Text,{component:g.TextVariants.small,className:"connector-drawer__header-text"},"Connector name"),p().createElement(g.Flex,null,p().createElement(g.FlexItem,null,p().createElement(g.Title,{headingLevel:"h2",size:g.TitleSizes.xl,className:"connector-drawer__header-title"},e)),p().createElement(g.FlexItem,{spacer:{default:"spacerSm"}},p().createElement(f,{name:e,status:l})))),p().createElement(g.DrawerActions,null,p().createElement(g.DrawerCloseButton,{onClick:d}))),p().createElement(g.DrawerPanelBody,null,p().createElement(g.Tabs,{activeKey:E,onSelect:(e,t)=>{C(t)}},p().createElement(g.Tab,{eventKey:0,title:p().createElement(g.TabTitleText,null,v("details"))},p().createElement("div",{className:"connector-drawer__tab-content"},p().createElement(ne,{name:e,id:t,bootstrapServer:n,kafkaId:a,namespaceId:r,owner:o,createdAt:c,modifiedAt:i,error:s}))))))};var se=n(55706),de=n(86445);const ue=({children:e})=>{const{t}=(0,m.useTranslation)();return p().createElement(de.TableComposable,{"aria-label":"Sortable Table",className:(0,se.css)("connectors-table-view__table")},p().createElement(de.Thead,null,p().createElement(de.Tr,null,p().createElement(de.Th,null,t("name")),p().createElement(de.Th,null,t("connector")),p().createElement(de.Th,null,t("status")))),p().createElement(de.Tbody,null,e))},pe=({connectorId:e,name:t,type:n,status:a,isSelected:o,canStart:r,canStop:c,canDelete:i,onStart:l,onStop:s,onDelete:d,openDetail:u,onSelect:v,onDuplicateConnector:E})=>{const{t:C}=(0,m.useTranslation)(),h=[{title:C("start"),onClick:l,isDisabled:!r},{title:C("stop"),onClick:s,isDisabled:!c},{title:C("delete"),onClick:d,isDisabled:!i},{title:C("edit"),onClick:()=>u("configuration"),isDisabled:!1},{title:C("duplicateConnector"),onClick:()=>E(e),isDisabled:!1},{isSeparator:!0},{title:C("details"),onClick:v}];return p().createElement(de.Tr,{onClick:e=>{var t;"button"!==(null===(t=e.target)||void 0===t?void 0:t.type)&&v()},className:(0,se.css)("pf-c-table-row__item","pf-m-selectable",o&&"pf-m-selected")},p().createElement(de.Td,{dataLabel:C("name")},p().createElement(g.Text,{component:g.TextVariants.a,isVisitedLink:!0,onClick:()=>u("overview")},t)),p().createElement(de.Td,{dataLabel:C("type")},n),p().createElement(de.Td,{dataLabel:C("status")},p().createElement(f,{name:t,status:a})),p().createElement(de.Td,{actions:{items:h},"data-testid":`actions-for-${e}`}))},me=({itemCount:e,page:t,perPage:n,isCompact:a=!1,onChange:o})=>p().createElement(g.Pagination,{itemCount:e,page:t,perPage:n,perPageOptions:[{title:"1",value:1},{title:"5",value:5},{title:"10",value:10}],onSetPage:(e,t)=>o(t,n),onPerPageSelect:(e,n)=>o(t,n),variant:a?"top":"bottom",isCompact:a}),ge=({itemCount:e,page:t,perPage:n,onChange:a})=>{const{t:o}=(0,m.useTranslation)(),r=p().createElement(p().Fragment,null,p().createElement(g.ToolbarGroup,{variant:"icon-button-group"},p().createElement(g.ToolbarItem,null,p().createElement(I.NavLink,{className:"pf-c-button pf-m-primary",to:"/create-connector"},o("createConnectorsInstance")))),p().createElement(g.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},p().createElement(me,{itemCount:e,page:t,perPage:n,onChange:a,isCompact:!0})));return p().createElement(g.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl",className:"pf-u-p-md"},p().createElement(g.ToolbarContent,null,r))},ve=({connectorName:e,onCancel:t,onConfirm:n,showDialog:a})=>{const{t:o}=(0,m.useTranslation)(),[r,c]=(0,u.useState)(""),i=r===e;return p().createElement(g.Modal,{variant:g.ModalVariant.small,title:o("deleteConnectorModalTitle"),titleIconVariant:"warning",isOpen:a,onClose:t,actions:[p().createElement(g.Button,{key:"confirm",variant:"danger",isDisabled:!i,onClick:()=>{c(""),n()}},o("delete")),p().createElement(g.Button,{key:"cancel",variant:"link",onClick:()=>{c(""),t()}},o("cancel"))]},p().createElement(g.Stack,null,p().createElement(g.StackItem,null,p().createElement(m.Trans,{i18nKey:"deleteConnectorModalDescription"},"Connector ",p().createElement("strong",null,{connectorName:e})," will be deleted.")),p().createElement(g.StackItem,null,p().createElement(m.Trans,{i18nKey:"deleteConnectorModalConfirmationPrompt"},"Type ",p().createElement("strong",null,{connectorName:e})," to confirm the deletion.")),p().createElement(g.StackItem,null,p().createElement(g.TextInput,{value:r,type:"text",onChange:c,"aria-label":"name input"}))))},fe=()=>{const{t:e}=(0,m.useTranslation)();return p().createElement(g.EmptyState,{variant:g.EmptyStateVariant.full},p().createElement(g.EmptyStateIcon,{icon:v.ExclamationCircleIcon}),p().createElement(g.Title,{headingLevel:"h1",size:g.TitleSizes.lg},e("somethingWentWrong")),p().createElement(g.EmptyStateBody,null,e("genericErrorBody")))},Ee=({onHelp:e,onCreate:t})=>{const{t:n}=(0,m.useTranslation)();return p().createElement(g.EmptyState,{variant:g.EmptyStateVariant.xl,className:(0,se.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},p().createElement(g.EmptyStateIcon,{icon:v.PlusCircleIcon}),p().createElement(g.Title,{headingLevel:"h1",size:g.TitleSizes["4xl"]},n("noConnectorInstances")),p().createElement(g.EmptyStateBody,null,p().createElement(m.Trans,{i18nKey:"gettingStartedBody"},"For help getting started, access the"," ",p().createElement(g.Button,{variant:g.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:e},"quick start guide."))),p().createElement(g.Button,{variant:"primary",onClick:t},n("createAConnectorsInstance")))},Ce=({onClear:e})=>{const{t}=(0,m.useTranslation)();return p().createElement(g.EmptyState,{variant:g.EmptyStateVariant.large,className:(0,se.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},p().createElement(g.EmptyStateIcon,{icon:v.SearchIcon}),p().createElement(g.Title,{headingLevel:"h2",size:g.TitleSizes.xl},t("noResultsFound")),p().createElement(g.EmptyStateBody,null,p().createElement(m.Trans,{i18nKey:"noFilterResultsFound"},"No results match the filter criteria."," ",p().createElement(g.Button,{variant:g.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:e},t("clearAllFilters"))," ","to show results.")))};var he=n(38801),ye=n(41428),be=n(66310);const Se=(0,be.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",connector:{}},{events:{"connector.start":()=>({}),"connector.stop":()=>({}),"connector.remove":()=>({}),"connector.select":()=>({}),"connector.actionSuccess":e=>e,"connector.actionError":e=>e},actions:{notifySuccess:()=>({}),notifyError:()=>({}),notifySelect:({connector:e})=>({connector:e})}}),Te=Se.assign(((e,t)=>({connector:t.connector})),"connector.actionSuccess"),ke=Se.createMachine({id:"connector",initial:"verify",context:Se.initialContext,states:{verify:{always:[{target:"ready",cond:"isReady"},{target:"stopped",cond:"isStopped"},{target:"deleted",cond:"isDeleted"}]},ready:{on:{"connector.stop":"stoppingConnector","connector.remove":"deletingConnector"}},stopped:{on:{"connector.start":"startingConnector","connector.remove":"deletingConnector"}},deleted:{},startingConnector:{invoke:{id:"startingConnectorCb",src:e=>(({accessToken:e,connectorsApiBasePath:t,connector:n})=>{const a=new i.ConnectorsApi(new i.Configuration({accessToken:e,basePath:t}));return e=>{const t=o().CancelToken.source();return a.patchConnector(n.id,{desired_state:i.ConnectorDesiredState.Ready},{cancelToken:t.token,headers:{"Content-type":"application/merge-patch+json"}}).then((t=>{e({type:"connector.actionSuccess",connector:t.data})})).catch((t=>{o().isCancel(t)||e({type:"connector.actionError",error:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:e.connector})},on:{"connector.actionSuccess":{target:"verify",actions:[Te,"notifySuccess"]},"connector.actionError":{target:"verify",actions:"notifyError"}}},stoppingConnector:{invoke:{id:"stoppingConnectorCb",src:e=>(({accessToken:e,connectorsApiBasePath:t,connector:n})=>{const a=new i.ConnectorsApi(new i.Configuration({accessToken:e,basePath:t}));return e=>{const t=o().CancelToken.source();return a.patchConnector(n.id,{desired_state:i.ConnectorDesiredState.Stopped},{cancelToken:t.token,headers:{"Content-type":"application/merge-patch+json"}}).then((t=>{e({type:"connector.actionSuccess",connector:t.data})})).catch((t=>{o().isCancel(t)||e({type:"connector.actionError",error:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:e.connector})},on:{"connector.actionSuccess":{target:"verify",actions:["updateState","notifySuccess"]},"connector.actionError":{target:"verify",actions:"notifyError"}}},deletingConnector:{invoke:{id:"deletingConnectorCb",src:e=>(({accessToken:e,connectorsApiBasePath:t,connector:n})=>{const a=new i.ConnectorsApi(new i.Configuration({accessToken:e,basePath:t}));return e=>{const t=o().CancelToken.source();return a.deleteConnector(n.id,{cancelToken:t.token}).then((()=>{e({type:"connector.actionSuccess",connector:Object.assign(Object.assign({},n),{status:"deleting",desired_state:"deleted"})})})).catch((t=>{o().isCancel(t)||e({type:"connector.actionError",error:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:e.connector})},on:{"connector.actionSuccess":{target:"deleted",actions:["updateState","notifySuccess"]},"connector.actionError":{target:"verify",actions:"notifyError"}}}},on:{"connector.select":{actions:"notifySelect"}}},{guards:{isReady:e=>"ready"===e.connector.desired_state,isStopped:e=>"stopped"===e.connector.desired_state,isDeleted:e=>"deleted"===e.connector.desired_state},actions:{notifySuccess:(0,ye.sendParent)("actionSuccess"),notifyError:(0,ye.sendParent)("actionFailure"),notifySelect:(0,ye.sendParent)((({connector:e})=>({type:"selectConnector",connector:e})))}});var Ie=n(45764);function xe(e,t,n){const a=(0,be.createModel)({request:{page:1,size:10},response:void 0,pollingEnabled:(null==n?void 0:n.pollingEnabled)||!1,onBeforeSetResponse:null==n?void 0:n.onBeforeSetResponse,dataTransformer:t},{events:Object.assign({},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e}),actions:{notifyReady:()=>({}),notifyLoading:()=>({}),notifySuccess:()=>({}),notifyError:()=>({}),forwardUnknownEventsToParent:()=>({})}}),o=a.assign(((e,t)=>{var n,a;return t.page!==e.request.page?{}:(e.onBeforeSetResponse&&e.onBeforeSetResponse(null===(n=e.response)||void 0===n?void 0:n.items),{response:{items:null===(a=t.items)||void 0===a?void 0:a.map((t=>e.dataTransformer(t))),total:t.total,error:void 0}})}),"api.setResponse"),r=a.assign((e=>{e.actor&&e.actor.stop&&e.actor.stop();return{actor:(0,Ie.spawn)(d(e))}})),c=a.assign(((e,t)=>{var n,a;return t.page!==e.request.page?{}:{response:{items:(null===(n=e.response)||void 0===n?void 0:n.items)||[],total:(null===(a=e.response)||void 0===a?void 0:a.total)||0,error:t.error}}}),"api.setError"),i=a.assign((e=>({request:Object.assign(Object.assign({},e.request),{page:e.request.page+1})})),"api.nextPage"),l=a.assign((e=>({request:Object.assign(Object.assign({},e.request),{page:e.request.page-1})})),"api.prevPage"),s=a.assign(((e,t)=>{const{page:n,size:a,query:o}=t;return{request:{page:n||e.request.page,size:a||e.request.size,query:o}}}),"api.query"),d=t=>n=>e(t.request,(e=>n(a.events["api.setResponse"](e))),(e=>n(a.events["api.setError"](e))));return a.createMachine({id:"paginatedApiMachine",context:a.initialContext,type:"parallel",states:{api:{initial:"idle",states:{idle:{entry:a.actions.notifyReady(),on:{"api.query":{target:"loading",actions:s}}},success:{always:[{target:"queryEmpty",cond:"isQueryEmpty"},{target:"queryResults",cond:"isQuerySuccesful"},{target:"empty",cond:"isTotalZero"},{target:"results"}]},queryEmpty:{tags:"queryEmpty",on:{"api.query":{target:"loading",actions:s},"api.prevPage":{target:"loading",actions:l,cond:"isNotFirstPage"},"api.refresh":{target:"loading"}}},queryResults:{tags:"queryResults",on:{"api.query":{target:"loading",actions:s},"api.nextPage":{target:"loading",actions:i,cond:"isNotLastPage"},"api.prevPage":{target:"loading",actions:l,cond:"isNotFirstPage"},"api.refresh":{target:"loading"}}},empty:{tags:"empty",on:{"api.query":{target:"loading",actions:s},"api.refresh":{target:"loading"}}},results:{tags:"results",on:{"api.query":{target:"loading",actions:s},"api.nextPage":{target:"loading",actions:i,cond:"isNotLastPage"},"api.prevPage":{target:"loading",actions:l,cond:"isNotFirstPage"},"api.refresh":{target:"loading"}}},error:{tags:"error",on:{"api.query":{target:"loading",actions:s},"api.refresh":{target:"loading"},"api.prevPage":{target:"loading",actions:l,cond:"isNotFirstPage"}}},loading:{tags:["loading"],entry:[a.actions.notifyLoading(),r],on:{"api.query":{target:"loading",actions:s},"api.setResponse":{target:"success",actions:[o,a.actions.notifySuccess()]},"api.setError":{target:"error",actions:[c,a.actions.notifyError()]}}}},on:{"*":{actions:"forwardUnknownEventsToParent"}}},polling:{entry:r,on:{"api.setResponse":{actions:o}},after:{INTERVAL:{cond:"isPollingEnabled",target:"polling"}}}}},{delays:{INTERVAL:5e3},actions:{notifyReady:(0,ye.sendParent)({type:"api.ready"}),notifySuccess:(0,ye.sendParent)((e=>Object.assign({type:"api.success"},e.response))),notifyError:(0,ye.sendParent)((e=>{var t;return{type:"api.error",error:null===(t=e.response)||void 0===t?void 0:t.error}})),notifyLoading:(0,ye.sendParent)((e=>Object.assign({type:"api.loading"},e.request))),forwardUnknownEventsToParent:(0,ye.pure)(((e,t)=>!1===Object.keys(a.events).includes(t.type)?(0,ye.sendParent)(((e,t,n)=>n._event.data)):[]))},guards:{isNotFirstPage:e=>void 0!==e.response&&e.request.page>1,isNotLastPage:e=>void 0!==e.response&&e.request.size>0&&e.request.page<Math.ceil(e.response.total/e.request.size),isTotalZero:e=>{var t;return 0===(null===(t=e.response)||void 0===t?void 0:t.total)},isQuerySuccesful:e=>{var t;return void 0!==e.request.query&&void 0!==e.response&&(null===(t=e.response)||void 0===t?void 0:t.total)>0},isQueryEmpty:e=>{var t;return void 0!==e.request.query&&void 0!==e.response&&0===(null===(t=e.response)||void 0===t?void 0:t.total)},isPollingEnabled:e=>e.pollingEnabled}})}const Ae=e=>(0,he.useSelector)(e,(0,u.useCallback)((e=>({request:e.context.request,response:e.context.response,loading:e.hasTag("loading"),queryEmpty:e.hasTag("queryEmpty"),queryResults:e.hasTag("queryResults"),noResults:e.hasTag("empty"),results:e.hasTag("results"),error:e.hasTag("error"),firstRequest:void 0===e.context.response})),[e])),Pe=(0,be.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",selectedConnector:void 0},{events:Object.assign(Object.assign({},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e}),{selectConnector:e=>e,deselectConnector:()=>({})}),actions:{notifyError:()=>({})}}),De=Pe.assign(((e,t)=>({selectedConnector:t.connector})),"selectConnector"),Ne=Pe.assign((e=>({selectedConnector:void 0})),"deselectConnector"),we=Pe.createMachine({id:"connectors",initial:"root",context:Pe.initialContext,states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:y,src:e=>xe((({accessToken:e,connectorsApiBasePath:t})=>{const n=new i.ConnectorsApi(new i.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const r=o().CancelToken.source(),{page:c,size:i}=e;return n.listConnectors(`${c}`,`${i}`,void 0,void 0,{cancelToken:r.token}).then((e=>{t({items:e.data.items||[],total:e.data.total,page:e.data.page,size:e.data.size})})).catch((t=>{o().isCancel(t)||a({error:t.message,page:e.page})})),()=>{r.cancel("Operation canceled by the user.")}}})(e),(t=>(0,Ie.spawn)((e=>ke.withContext(e))({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:t}),`connector-${t.id}`)),{pollingEnabled:!0,onBeforeSetResponse:e=>{e&&e.forEach((e=>{e&&e.stop&&e.stop()}))}})},states:{idle:{on:{"api.ready":"ready"}},ready:{entry:(0,Ie.send)("api.query",{to:y})}},on:{"api.refresh":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.nextPage":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.prevPage":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.query":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.error":{actions:"notifyError"},selectConnector:{actions:De},deselectConnector:{actions:Ne}}},listing:{}}}}},{actions:{notifyError:(e,t)=>{console.log(e,t),"api.error"===t.type&&e.onError&&e.onError(t.error)}}}),Be=(0,u.createContext)(null),Oe=({children:e,accessToken:t,connectorsApiBasePath:n,onError:a})=>{const o=(0,he.useInterpret)(we,{context:{accessToken:t,connectorsApiBasePath:n,onError:a},devTools:!0});return p().createElement(Be.Provider,{value:o},e)},Me=()=>{const e=(0,u.useContext)(Be);if(!e)throw new Error("useConnectorsMachineService() must be used in a child of <ConnectorsMachineProvider>");return e},_e=()=>{const e=Me(),t=Ae(e.state.children.paginatedApi),{selectedConnector:n}=(0,he.useSelector)(e,(0,u.useCallback)((e=>({selectedConnector:e.context.selectedConnector})),[e])),a=(0,u.useCallback)((()=>{e.send({type:"deselectConnector"})}),[e]),o=(0,u.useCallback)((t=>{e.send(Object.assign({type:"api.query"},t))}),[e]);return Object.assign(Object.assign({},t),{selectedConnector:n,deselectConnector:a,query:o})},je=({onCreateConnector:e,onConnectorDetail:t,onDuplicateConnector:n})=>{const{t:a}=(0,m.useTranslation)(),o=(0,x.useAlert)(),{connectorsApiBasePath:r,getToken:c}=k(),i=(0,u.useCallback)((e=>{null==o||o.addAlert({id:"connectors-table-error",variant:x.AlertVariant.danger,title:a("somethingWentWrong"),description:e})}),[o,a]);return p().createElement(Oe,{accessToken:c,connectorsApiBasePath:r,onError:i},p().createElement(Le,{onCreateConnector:e,onConnectorDetail:t,onDuplicateConnector:n}))},Le=({onCreateConnector:e,onConnectorDetail:t,onDuplicateConnector:n})=>(()=>{const e=Me();return(0,he.useSelector)(e,(0,u.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?p().createElement(qe,{onCreateConnector:e,onConnectorDetail:t,onDuplicateConnector:n}):p().createElement(h.g,null),qe=({onCreateConnector:e,onConnectorDetail:t,onDuplicateConnector:n})=>{const{loading:a,error:o,noResults:r,queryEmpty:c,firstRequest:i,request:l,response:s,selectedConnector:d,deselectConnector:u,query:m}=_e();switch(!0){case i:return p().createElement(h.g,null);case c:return p().createElement(Ce,{onClear:()=>m({page:1,size:10})});case a:return p().createElement(p().Fragment,null,p().createElement(g.PageSection,{variant:"light"},p().createElement(Fe,null)),p().createElement(g.PageSection,{padding:{default:"noPadding"},isFilled:!0},p().createElement(g.Card,null,p().createElement(ge,{itemCount:(null==s?void 0:s.total)||0,page:l.page,perPage:l.size,onChange:(e,t)=>m({page:e,size:t})}),p().createElement(h.g,null))));case r:return p().createElement(Ee,{onCreate:e,onHelp:function(){throw new Error("Function not implemented.")}});case o:return p().createElement(fe,null);default:return p().createElement(ie,{connector:d,onClose:u},p().createElement(g.PageSection,{variant:"light"},p().createElement(Fe,null)),p().createElement(g.PageSection,{padding:{default:"noPadding"},isFilled:!0},p().createElement(Re,{onConnectorDetail:t,onDuplicateConnector:n})))}},Fe=()=>{const{t:e}=(0,m.useTranslation)();return p().createElement(g.TextContent,null,p().createElement(g.Title,{headingLevel:"h1"},e("connectorsInstances")))},Re=({onConnectorDetail:e,onDuplicateConnector:t})=>{var n;const{request:a,response:o,selectedConnector:r,query:c}=_e();return p().createElement(g.Card,{className:"pf-u-pb-xl"},p().createElement(ge,{itemCount:(null==o?void 0:o.total)||0,page:a.page,perPage:a.size,onChange:(e,t)=>c({page:e,size:t})}),p().createElement("div",{className:"pf-u-p-md"},p().createElement(ue,null,null===(n=null==o?void 0:o.items)||void 0===n?void 0:n.map((n=>p().createElement(ze,{connectorRef:n,key:n.id,selectedConnector:r,onConnectorDetail:e,onDuplicateConnector:t}))))),p().createElement(me,{itemCount:(null==o?void 0:o.total)||0,page:a.page,perPage:a.size,onChange:(e,t)=>c({page:e,size:t}),isCompact:!1}))},ze=({connectorRef:e,selectedConnector:t,onConnectorDetail:n,onDuplicateConnector:a})=>{var o;const{connector:r,canStart:c,canStop:i,canDelete:l,onStart:s,onStop:d,onDelete:m,onSelect:g}=(e=>{const{connector:t,canStart:n,canStop:a,canDelete:o}=(0,he.useSelector)(e,(0,u.useCallback)((e=>({connector:e.context.connector,canStart:!0===ke.transition(e,"connector.start").changed,canStop:!0===ke.transition(e,"connector.stop").changed,canDelete:!0===ke.transition(e,"connector.remove").changed})),[e]));return{connector:t,canStart:n,canStop:a,canDelete:o,onStart:(0,u.useCallback)((()=>e.send({type:"connector.start"})),[e]),onStop:(0,u.useCallback)((()=>e.send({type:"connector.stop"})),[e]),onDelete:(0,u.useCallback)((()=>e.send({type:"connector.remove"})),[e]),onSelect:(0,u.useCallback)((()=>e.send({type:"connector.select"})),[e])}})(e),[v,f]=(0,u.useState)(!1);return p().createElement(p().Fragment,null,p().createElement(ve,{connectorName:r.name,showDialog:v,onCancel:()=>{f(!1)},onConfirm:()=>{f(!1),m()}}),p().createElement(pe,{connectorId:r.id,name:r.name,type:r.connector_type_id,category:"TODO: MISSING",status:null===(o=r.status)||void 0===o?void 0:o.state,isSelected:(null==t?void 0:t.id)===r.id,canStart:c,canStop:i,canDelete:l,onStart:s,onStop:d,onSelect:g,openDetail:e=>{n(r.id,e)},onDuplicateConnector:a,onDelete:()=>f(!0)}))};var Ge=n(64616);function Ve(e){const t=[];for(const n of e)if(n.steps)for(const e of n.steps)t.push(e);else t.push(n);return t}class He extends u.Component{constructor(e){super(e),this.handleKeyClicks=e=>{e.keyCode===g.KEY_CODES.ESCAPE_KEY&&(this.state.isNavOpen?this.setState({isNavOpen:!this.state.isNavOpen}):this.props.isOpen&&this.props.onClose&&this.props.onClose())},this.getFlattenedSteps=()=>{const{steps:e}=this.props;return Ve(e)},this.getFlattenedStepsIndex=(e,t)=>{for(let n=0;n<e.length;n++)if(e[n].name===t)return n+1;return 0},this.initSteps=e=>{for(let t=0;t<e.length;t++){if(e[t].steps)for(let n=0;n<e[t].steps.length;n++)e[t].steps[n]=Object.assign({canJumpTo:!0},e[t].steps[n]);e[t]=Object.assign({canJumpTo:!0},e[t])}return e},this.getElement=e=>"function"==typeof e?e():e||document.body;const t=He.currentId++;this.titleId=e.titleId||`pf-wizard-title-${t}`,this.descriptionId=e.descriptionId||`pf-wizard-description-${t}`,this.state={isNavOpen:!1}}componentDidMount(){const e="undefined"!=typeof document?document.body:null;e&&e.addEventListener("keydown",this.handleKeyClicks,!1)}componentWillUnmount(){const e="undefined"!=typeof document&&document.body||null;e&&e.removeEventListener("keydown",this.handleKeyClicks,!1)}render(){const e=this.props,{width:t,height:n,title:a,description:o,onClose:r,onSave:c,onBack:i,onNext:l,onGoToStep:s,goToStep:d,goToStepById:u,goToStepByName:m,className:v,steps:f,currentStep:E,nextButtonText:C="Next",backButtonText:h="Back",cancelButtonText:y="Cancel",hideClose:b,closeButtonAriaLabel:S="close",navAriaLabel:T,navAriaLabelledBy:k,mainAriaLabel:I,mainAriaLabelledBy:x,hasNoBodyPadding:P,footer:D,appendTo:N,isOpen:w,titleId:B,descriptionId:O}=e,M=(0,A.__rest)(e,["width","height","title","description","onClose","onSave","onBack","onNext","onGoToStep","goToStep","goToStepById","goToStepByName","className","steps","currentStep","nextButtonText","backButtonText","cancelButtonText","hideClose","closeButtonAriaLabel","navAriaLabel","navAriaLabelledBy","mainAriaLabel","mainAriaLabelledBy","hasNoBodyPadding","footer","appendTo","isOpen","titleId","descriptionId"]),_=this.getFlattenedSteps(),j=_.length<E?_.length:E,L=_[j-1],q=this.initSteps(f),F=L===_[0],R=!L||void 0===L.enableNext||L.enableNext,z={goToStepById:u,goToStepByName:m,onNext:l,onBack:i,onClose:r,activeStep:L},G=Object.assign(Object.assign({},n?{height:n}:{}),t?{width:t}:{}),V=p().createElement(g.WizardContextProvider,{value:z},p().createElement("div",Object.assign({},M,{className:(0,se.css)(Ge.Z.wizard,L&&L.isFinishedStep&&"pf-m-finished",v),style:Object.keys(G).length?G:void 0}),a&&p().createElement(g.WizardHeader,{titleId:this.titleId,descriptionId:this.descriptionId,onClose:r,title:a,description:o,closeButtonAriaLabel:S,hideClose:b}),p().createElement(g.WizardToggle,{mainAriaLabel:I,isInPage:void 0===w,mainAriaLabelledBy:(a||x)&&(x||this.titleId),isNavOpen:this.state.isNavOpen,onNavToggle:e=>this.setState({isNavOpen:e}),nav:e=>{const t={isOpen:e,"aria-label":T,"aria-labelledby":(a||k)&&(k||this.titleId)};return p().createElement(g.WizardNav,Object.assign({},t),q.map(((e,n)=>{if(e.isFinishedStep)return null;let a,o;if(e.steps){let r=!1,c=!1;for(const t of e.steps)L.name===t.name&&(r=!0),t.canJumpTo&&(c=!0);return o=this.getFlattenedStepsIndex(_,e.steps[0].name),p().createElement(g.WizardNavItem,{key:n,content:e.name,isCurrent:r,isDisabled:!c,step:o,onNavItemClick:d},p().createElement(g.WizardNav,Object.assign({},t,{returnList:!0}),e.steps.map(((e,t)=>e.isFinishedStep?null:(o=this.getFlattenedStepsIndex(_,e.name),a=e.canJumpTo,p().createElement(g.WizardNavItem,{key:`child_${t}`,content:e.name,isCurrent:L.name===e.name,isDisabled:!a,step:o,onNavItemClick:d}))))))}return o=this.getFlattenedStepsIndex(_,e.name),a=e.canJumpTo,p().createElement(g.WizardNavItem,Object.assign({},e.stepNavItemProps,{key:n,content:e.name,isCurrent:L.name===e.name,isDisabled:!a,step:o,onNavItemClick:d}))})))},steps:f,activeStep:L,hasNoBodyPadding:P},D||p().createElement("footer",{className:(0,se.css)(Ge.Z.wizardFooter)},p().createElement(g.Button,{variant:g.ButtonVariant.primary,type:"submit",onClick:l,isDisabled:!R},L&&L.nextButtonText||C),!L.hideBackButton&&p().createElement(g.Button,{variant:g.ButtonVariant.secondary,onClick:i,className:(0,se.css)(F&&"pf-m-disabled")},h),!L.hideCancelButton&&p().createElement("div",{className:Ge.Z.wizardFooterCancel},p().createElement(g.Button,{variant:g.ButtonVariant.link,onClick:r},y))))));return void 0!==w?p().createElement(g.Modal,{width:null!==t?t:void 0,isOpen:w,variant:g.ModalVariant.large,"aria-labelledby":this.titleId,"aria-describedby":this.descriptionId,showClose:!1,hasNoBodyWrapper:!0},V):V}}He.displayName="Wizard",He.currentId=0,He.defaultProps={title:void 0,description:"",className:"",nextButtonText:"Next",backButtonText:"Back",cancelButtonText:"Cancel",hideClose:!1,closeButtonAriaLabel:"Close",navAriaLabel:void 0,navAriaLabelledBy:void 0,mainAriaLabel:void 0,mainAriaLabelledBy:void 0,hasNoBodyPadding:!1,onGoToStep:void 0,width:void 0,height:void 0,footer:void 0,appendTo:void 0,isOpen:void 0};const Ke=(0,be.createModel)({name:"",sACreated:!1,userServiceAccount:{clientId:"",clientSecret:""}},{events:{setName:e=>e,setSaCreated:e=>e,setServiceAccount:e=>e,confirm:()=>({})}}),Je=Ke.assign({name:(e,t)=>t.name},"setName"),We=Ke.assign({sACreated:(e,t)=>t.sACreated},"setSaCreated"),$e=Ke.assign(((e,t)=>({userServiceAccount:t.serviceAccount})),"setServiceAccount"),Ue=Ke.createMachine({id:"configureBasic",initial:"verify",states:{verify:{always:[{target:"valid",cond:"isBasicConfigured"},{target:"typing"}]},typing:{entry:(0,Ie.sendParent)("isInvalid"),on:{setName:{target:"verify",actions:Je},setSaCreated:{target:"verify",actions:We},setServiceAccount:{target:"verify",actions:$e}}},valid:{id:"valid",entry:(0,Ie.sendParent)("isValid"),on:{setName:{target:"verify",actions:Je},setSaCreated:{target:"verify",actions:We},setServiceAccount:{target:"verify",actions:$e},confirm:{target:"#done",cond:"isBasicConfigured"}}},done:{id:"done",type:"final",data:{name:e=>e.name,sACreated:e=>e.sACreated,userServiceAccount:e=>e.userServiceAccount,duplicateMode:e=>e.duplicateMode}}}},{guards:{isBasicConfigured:e=>void 0!==e.name&&e.name.length>0&&void 0!==e.userServiceAccount&&e.userServiceAccount.clientId.length>0&&e.userServiceAccount.clientSecret.length>0}}),Qe=(0,be.createModel)({connector:{id:"something",name:"something",version:"0.1",schema:{}},steps:[],activeStep:0,isActiveStepValid:!1,configuration:void 0},{events:{entry:()=>({}),change:({configuration:e,isValid:t})=>({configuration:e,isValid:t}),next:()=>({}),prev:()=>({}),complete:()=>({})},actions:{changedStep:()=>({})}}),Ze=Qe.assign((e=>({activeStep:Math.min(e.activeStep+1,e.steps.length-1),isActiveStepValid:!1})),"next"),Ye=Qe.assign((e=>({activeStep:Math.max(e.activeStep-1,0),isActiveStepValid:!1})),"prev"),Xe=Qe.assign(((e,t)=>({configuration:t.configuration,isActiveStepValid:t.isValid})),"change"),et=Qe.createMachine({id:"configurator",initial:"configuring",context:{connector:{id:"something",name:"something",version:"0.1",schema:{}},steps:["one","two","three"],activeStep:0,isActiveStepValid:!1,configuration:void 0},states:{configuring:{entry:(0,Ie.sendParent)("isInvalid"),always:[{target:"valid",cond:"activeStepValid"}]},valid:{id:"valid",initial:"determineStep",entry:(0,Ie.sendParent)("isValid"),states:{determineStep:{always:[{target:"#valid.lastStep",cond:"isLastStep"},{target:"#valid.hasNextStep"}]},hasNextStep:{on:{next:{target:"#configurator.configuring",actions:[Ze,"changedStep"]}}},lastStep:{on:{next:"#configurator.configured"}}}},configured:{type:"final",data:({configuration:e})=>({configuration:e})}},on:{change:{target:"configuring",actions:Xe},prev:{target:"configuring",actions:[Ye,"changedStep"]}}},{actions:{changedStep:(0,Ie.sendParent)((e=>({type:"changedStep",step:e.activeStep})))},guards:{isLastStep:e=>e.activeStep===e.steps.length-1,activeStepValid:e=>e.isActiveStepValid}}),tt={context:(0,Ie.createSchema)()},nt=(0,be.createModel)({connector:{id:"something",name:"something",version:"0.1"},Configurator:void 0,steps:void 0,error:void 0,duplicateMode:void 0}),at=nt.createMachine({schema:tt,id:"configurator",initial:"loading",context:nt.initialContext,states:{loading:{invoke:{id:"fetchConfigurator",src:"fetchConfigurator",onDone:{target:"success",actions:(0,Ie.assign)(((e,t)=>t.data))},onError:{target:"failure",actions:(0,Ie.assign)({error:(e,t)=>t.data})}}},failure:{entry:(0,ye.escalate)((e=>({message:e.error})))},success:{type:"final",data:({Configurator:e,steps:t})=>({Configurator:e,steps:t})}}}),ot=(0,be.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",response:void 0,selectedConnector:void 0,error:void 0},{events:Object.assign({selectConnector:e=>Object.assign({},e),deselectConnector:()=>({}),confirm:()=>({})},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e})}),rt=ot.assign(((e,t)=>{const{type:n}=t;return{response:(0,A.__rest)(t,["type"])}}),"api.success"),ct=ot.assign({selectedConnector:(e,t)=>{var n,a;return null===(a=null===(n=e.response)||void 0===n?void 0:n.items)||void 0===a?void 0:a.find((e=>e.id===t.selectedConnector))}},"selectConnector"),it=ot.assign({selectedConnector:void 0},"deselectConnector"),lt=ot.createMachine({context:ot.initialContext,id:"connectors",initial:"root",states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:y,src:e=>xe((({accessToken:e,connectorsApiBasePath:t})=>{const n=new i.ConnectorTypesApi(new i.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const r=o().CancelToken.source(),{page:c,size:i,query:l}=e,{name:s,categories:d=[]}=l||{};return n.getConnectorTypes("1","1000",void 0,void 0,{cancelToken:r.token}).then((e=>{const n=s?s.toLowerCase():void 0,a=e.data.items||[];let o=n?null==a?void 0:a.filter((e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(n)})):a;o=d.length>0?null==o?void 0:o.filter((e=>{var t;return((null===(t=e.labels)||void 0===t?void 0:t.filter((e=>d.includes(e))))||[]).length>0})):o;const r=o.length,l=(c-1)*i,u=o.slice(l,l+i);t({items:u,total:r,page:c,size:i})})).catch((t=>{o().isCancel(t)||a({error:t.message,page:e.page})})),()=>{r.cancel("Operation canceled by the user.")}}})(e),(e=>e))},states:{idle:{entry:(0,Ie.send)({type:"api.query",query:{categories:["sink","source"]}},{to:y}),on:{"api.ready":"ready"}},ready:{}},on:{"api.refresh":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.nextPage":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.prevPage":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.query":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.success":{actions:rt}}},selection:{id:"selection",initial:"verify",states:{verify:{always:[{target:"selecting",cond:"noConnectorSelected"},{target:"valid",cond:"connectorSelected"}]},selecting:{entry:(0,Ie.sendParent)("isInvalid"),on:{selectConnector:{target:"valid",actions:ct,cond:(e,t)=>void 0!==t.selectedConnector}}},valid:{entry:(0,Ie.sendParent)("isValid"),on:{selectConnector:{target:"verify",actions:ct},deselectConnector:{target:"verify",actions:it},confirm:{target:"#done",cond:"connectorSelected"}}}}}}},done:{id:"done",type:"final",data:{selectedConnector:e=>e.selectedConnector,duplicateMode:e=>e.duplicateMode,connectorTypeDetails:e=>e.connectorTypeDetails}}}},{guards:{connectorSelected:e=>void 0!==e.selectedConnector,noConnectorSelected:e=>void 0===e.selectedConnector}}),st=(0,be.createModel)({topic:"",userErrorHandler:""},{events:{setTopic:e=>e,setErrorHandler:e=>e,confirm:()=>({})}}),dt=st.assign({topic:(e,t)=>t.topic},"setTopic"),ut=st.assign(((e,t)=>({userErrorHandler:t.errorHandler})),"setErrorHandler"),pt=st.createMachine({id:"configureErrorHandler",initial:"verify",states:{verify:{always:[{target:"valid",cond:"isErrorHandlerConfigured"},{target:"typing"}]},typing:{entry:(0,Ie.sendParent)("isInvalid"),on:{setTopic:{target:"verify",actions:dt},setErrorHandler:{target:"verify",actions:ut}}},valid:{id:"valid",entry:(0,Ie.sendParent)("isValid"),on:{setTopic:{target:"verify",actions:dt},setErrorHandler:{target:"verify",actions:ut},confirm:{target:"#done",cond:"isErrorHandlerConfigured"}}},done:{id:"done",type:"final",data:{topic:e=>e.topic,userErrorHandler:e=>e.userErrorHandler,duplicateMode:e=>e.duplicateMode}}}},{guards:{isErrorHandlerConfigured:e=>void 0!==e.userErrorHandler&&"dead_letter_queue"===e.userErrorHandler?void 0!==e.topic&&e.topic.length>0:void 0!==e.topic&&e.topic.length>0||void 0!==e.userErrorHandler}}),mt=(0,be.createModel)({accessToken:()=>Promise.resolve(""),kafkaManagementBasePath:"",instances:void 0,selectedInstance:void 0,error:void 0},{events:Object.assign({selectInstance:e=>Object.assign({},e),deselectInstance:()=>({}),confirm:()=>({})},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e})}),gt=mt.assign(((e,t)=>{const{type:n}=t;return{response:(0,A.__rest)(t,["type"])}}),"api.success"),vt=mt.assign({selectedInstance:(e,t)=>{var n,a;return null===(a=null===(n=e.response)||void 0===n?void 0:n.items)||void 0===a?void 0:a.find((e=>e.id===t.selectedInstance))}},"selectInstance"),ft=mt.assign({selectedInstance:void 0},"deselectInstance"),Et=mt.createMachine({id:"kafkas",initial:"root",context:mt.initialContext,states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:y,src:e=>xe((({accessToken:e,kafkaManagementBasePath:t})=>{const n=new l.DefaultApi(new i.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const r=o().CancelToken.source(),{page:c,size:i,query:l}=e,{name:s,statuses:d,owner:u,cloudProviders:p,regions:m}=l||{},g=[s&&s.length>0?` name LIKE ${s}`:void 0,u&&u.length>0?` owner LIKE ${u}`:void 0,d&&d.length>0?d.map((e=>`status = ${e}`)).join(" OR "):void 0,p&&p.length>0?p.map((e=>`cloud_provider = ${e}`)).join(" OR "):void 0,m&&m.length>0?m.map((e=>`region = ${e}`)).join(" OR "):void 0].filter(Boolean).map((e=>`(${e})`)).join(" AND ");return n.getKafkas(`${c}`,`${i}`,void 0,g,{cancelToken:r.token}).then((e=>{t({items:e.data.items||[],total:e.data.total,page:e.data.page,size:e.data.size})})).catch((t=>{o().isCancel(t)||a({error:t.message,page:e.page})})),()=>{r.cancel("Operation canceled by the user.")}}})(e),(e=>e))},states:{idle:{entry:(0,Ie.send)("api.query",{to:y}),on:{"api.ready":"ready"}},ready:{}},on:{"api.refresh":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.nextPage":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.prevPage":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.query":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.success":{actions:gt}}},selection:{id:"selection",initial:"verify",states:{verify:{always:[{target:"selecting",cond:"noInstanceSelected"},{target:"valid",cond:"instanceSelected"}]},selecting:{entry:(0,ye.sendParent)("isInvalid"),on:{selectInstance:{target:"valid",actions:vt}}},valid:{entry:(0,ye.sendParent)("isValid"),on:{selectInstance:{target:"verify",actions:vt,cond:(e,t)=>void 0!==t.selectedInstance},deselectInstance:{target:"verify",actions:ft},confirm:{target:"#done",cond:"instanceSelected"}}}}}}},done:{id:"done",type:"final",data:{selectedInstance:e=>e.selectedInstance,duplicateMode:e=>e.duplicateMode}}}},{guards:{instanceSelected:e=>void 0!==e.selectedInstance,noInstanceSelected:e=>void 0===e.selectedInstance}}),Ct=(0,be.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",selectedNamespace:void 0,error:void 0},{events:Object.assign({selectNamespace:e=>Object.assign({},e),deselectNamespace:()=>({}),confirm:()=>({})},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e})}),ht=Ct.assign(((e,t)=>{const{type:n}=t;return{response:(0,A.__rest)(t,["type"])}}),"api.success"),yt=Ct.assign({selectedNamespace:(e,t)=>{var n,a;return null===(a=null===(n=e.response)||void 0===n?void 0:n.items)||void 0===a?void 0:a.find((e=>e.id===t.selectedNamespace))}},"selectNamespace"),bt=Ct.assign({selectedNamespace:void 0},"deselectNamespace"),St=Ct.createMachine({id:"namespaces",initial:"root",context:Ct.initialContext,states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:y,src:e=>xe((({accessToken:e,connectorsApiBasePath:t})=>{const n=new i.ConnectorNamespacesApi(new i.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const r=o().CancelToken.source(),{page:c,size:i}=e;return n.listConnectorNamespaces(`${c}`,`${i}`).then((e=>{t({items:e.data.items||[],total:e.data.total,page:e.data.page,size:e.data.size})})).catch((t=>{o().isCancel(t)||a({error:t.message,page:e.page})})),()=>{r.cancel("Operation canceled by the user.")}}})(e),(e=>e),{pollingEnabled:!0})},states:{idle:{entry:(0,Ie.send)("api.query",{to:y}),on:{"api.ready":"ready"}},ready:{}},on:{"api.refresh":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.nextPage":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.prevPage":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.query":{actions:(0,Ie.send)(((e,t)=>t),{to:y})},"api.success":{actions:ht}}},selection:{id:"selection",initial:"verify",states:{verify:{always:[{target:"selecting",cond:"noNamespaceSelected"},{target:"valid",cond:"namespaceSelected"}]},selecting:{entry:(0,Ie.sendParent)("isInvalid"),on:{selectNamespace:{target:"valid",actions:yt}}},valid:{entry:(0,Ie.sendParent)("isValid"),on:{selectNamespace:{target:"verify",actions:yt,cond:(e,t)=>void 0!==t.selectedNamespace},deselectNamespace:{target:"verify",actions:bt},confirm:{target:"#done",cond:"namespaceSelected"}}}}}}},done:{id:"done",type:"final",data:{selectedNamespace:e=>e.selectedNamespace}}}},{guards:{namespaceSelected:e=>void 0!==e.selectedNamespace,noNamespaceSelected:e=>void 0===e.selectedNamespace}}),Tt=(0,be.createModel)({initialConfiguration:void 0,configString:"",name:""},{events:{save:()=>({}),success:()=>({}),failure:e=>e}}),kt=Tt.assign((e=>({kafka:e.kafka,namespace:e.namespace,connectorType:e.connectorType,name:e.name,userServiceAccount:e.userServiceAccount,topic:e.topic,userErrorHandler:e.userErrorHandler,configString:At(e.initialConfiguration)}))),It=Tt.assign(((e,t)=>({savingError:t.message})),"failure"),xt=Tt.createMachine({id:"review",initial:"verify",context:Tt.initialContext,entry:kt,states:{verify:{always:[{target:"valid",cond:"isAllConfigured"}]},valid:{id:"valid",entry:(0,Ie.sendParent)("isValid"),on:{save:"saving"}},saving:{invoke:{src:e=>(({accessToken:e,connectorsApiBasePath:t,kafka:n,namespace:a,connectorType:r,configuration:c,name:l,userServiceAccount:s,userErrorHandler:d,topic:u})=>{const p=new i.ConnectorsApi(new i.Configuration({accessToken:e,basePath:t}));return e=>{const t=o().CancelToken.source();let m={};m=d?Object.assign(Object.assign({},c),{error_handler:{[d]:u?{topic:u}:{}}}):c;const g={kind:"Connector",name:l,channel:i.Channel.Stable,namespace_id:a.id,desired_state:i.ConnectorDesiredState.Ready,connector_type_id:r.id,kafka:{id:n.id,url:n.bootstrap_server_host||"demo"},service_account:{client_id:s.clientId,client_secret:s.clientSecret},connector:m};return p.createConnector(!0,g,{cancelToken:t.token}).then((()=>{e({type:"success"})})).catch((t=>{o().isCancel(t)||e({type:"failure",message:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafka:e.kafka,namespace:e.namespace,connectorType:e.connectorType,configuration:JSON.parse(e.configString),name:e.name,userServiceAccount:e.userServiceAccount,topic:e.topic,userErrorHandler:e.userErrorHandler})},on:{success:"saved",failure:{target:"valid",actions:It}},tags:["saving"]},saved:{type:"final"}}},{guards:{isAllConfigured:e=>void 0!==e.configString}});function At(e){const t=e instanceof Map?M(e):e;try{return JSON.stringify(t,null,2)}catch(e){return""}}const Pt=(0,be.createModel)({},{events:{isValid:()=>({}),isInvalid:()=>({}),prev:()=>({}),next:()=>({}),changedStep:({step:e})=>({step:e}),jumpToSelectKafka:()=>({}),jumpToSelectNamespace:()=>({}),jumpToSelectConnector:()=>({}),jumpToConfigureConnector:({subStep:e})=>({subStep:e}),jumpToBasicConfiguration:()=>({}),jumpToErrorConfiguration:()=>({}),jumpToReviewConfiguration:()=>({})},actions:{notifySave:()=>({})}}),Dt=Pt.createMachine({id:"creationWizard",initial:"selectConnector",context:Pt.initialContext,states:{selectConnector:{initial:"selecting",invoke:{id:"selectConnectorRef",src:lt,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,selectedConnector:e.duplicateMode?e.connectorTypeDetails:e.selectedConnector,connectorData:e.connectorData,connectorTypeDetails:e.connectorTypeDetails,duplicateMode:e.duplicateMode}),onDone:{target:"selectKafka",actions:(0,Ie.assign)(((e,t)=>({selectedConnector:e.duplicateMode?e.connectorTypeDetails:t.data.selectedConnector,connectorData:e.connectorData,connectorTypeDetails:e.connectorTypeDetails,duplicateMode:e.duplicateMode,connectorConfiguration:!1,activeConfigurationStep:0,isConfigurationValid:!1,configurationSteps:!1})))},onError:".error"},states:{error:{},selecting:{on:{isValid:"valid"}},valid:{on:{isInvalid:"selecting",next:{actions:(0,Ie.send)("confirm",{to:"selectConnectorRef"})}}}}},selectKafka:{initial:"selecting",invoke:{id:"selectKafkaInstanceRef",src:Et,data:e=>{var t;return{accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,selectedInstance:e.duplicateMode?null===(t=e.connectorData)||void 0===t?void 0:t.kafka:e.selectedKafkaInstance,connectorData:e.connectorData,connectorTypeDetails:e.connectorTypeDetails,duplicateMode:e.duplicateMode,request:{page:1,size:10}}},onDone:{target:"selectNamespace",actions:(0,Ie.assign)({selectedKafkaInstance:(e,t)=>t.data.selectedInstance})},onError:".error"},states:{error:{},selecting:{on:{isValid:"valid"}},valid:{on:{isInvalid:"selecting",next:{actions:(0,Ie.send)("confirm",{to:"selectKafkaInstanceRef"})}}}},on:{prev:"selectConnector"}},selectNamespace:{initial:"selecting",invoke:{id:"selectNamespaceRef",src:St,data:e=>{var t;return{accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,selectedNamespace:e.duplicateMode?{id:null===(t=e.connectorData)||void 0===t?void 0:t.namespace_id}:e.selectedNamespace,connectorData:e.connectorData,connectorTypeDetails:e.connectorTypeDetails,duplicateMode:e.duplicateMode}},onDone:{target:"basicConfiguration",actions:(0,Ie.assign)({selectedNamespace:(e,t)=>t.data.selectedNamespace})},onError:".error"},states:{error:{},selecting:{on:{isValid:"valid"}},valid:{on:{isInvalid:"selecting",next:{actions:(0,Ie.send)("confirm",{to:"selectNamespaceRef"})}}}},on:{prev:"selectKafka"}},basicConfiguration:{id:"configureBasic",initial:"submittable",invoke:{id:"basicRef",src:Ue,data:e=>{var t,n;return{accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafkaManagementApiBasePath:e.kafkaManagementApiBasePath,kafka:e.selectedKafkaInstance,namespace:e.selectedNamespace,connectorType:e.selectedConnector,initialConfiguration:e.connectorConfiguration,name:e.duplicateMode?null===(t=e.connectorData)||void 0===t?void 0:t.name:e.name,userServiceAccount:e.duplicateMode?{clientId:null===(n=e.connectorData)||void 0===n?void 0:n.service_account.client_id,clientSecret:""}:e.userServiceAccount,topic:e.topic,userErrorHandler:e.userErrorHandler,duplicateMode:e.duplicateMode,sACreated:e.sACreated}},onDone:{target:"configureConnector",actions:[(0,Ie.assign)(((e,t)=>({name:t.data.name,sACreated:t.data.sACreated,userServiceAccount:t.data.userServiceAccount,duplicateMode:e.duplicateMode})))]},onError:{actions:(e,t)=>console.error(t.data.message)}},states:{submittable:{on:{isInvalid:"invalid",next:{actions:(0,Ie.send)("confirm",{to:"basicRef"})}}},invalid:{on:{isValid:"submittable"}}},on:{prev:"selectNamespace"}},configureConnector:{initial:"loadConfigurator",states:{loadConfigurator:{invoke:{id:"configuratorLoader",src:"makeConfiguratorLoaderMachine",data:e=>({connector:e.duplicateMode?e.connectorTypeDetails:e.selectedConnector,duplicateMode:e.duplicateMode}),onDone:{target:"configure",actions:(0,Ie.assign)(((e,t)=>({Configurator:t.data.Configurator,configurationSteps:t.data.steps,duplicateMode:e.duplicateMode})))},onError:{actions:(e,t)=>console.error(t.data.message)}}},configure:{id:"configure",initial:"submittable",invoke:{id:"configuratorRef",src:et,data:e=>{var t;return{connector:e.duplicateMode?e.connectorTypeDetails:e.selectedConnector,configuration:e.duplicateMode?null===(t=e.connectorData)||void 0===t?void 0:t.connector:e.connectorConfiguration,name:e.name,steps:e.configurationSteps||["single step"],activeStep:e.activeConfigurationStep||0,isActiveStepValid:!1!==e.connectorConfiguration,duplicateMode:e.duplicateMode,connectorData:e.connectorData}},onDone:[{target:"#creationWizard.reviewConfiguration",actions:(0,Ie.assign)(((e,t)=>({connectorConfiguration:t.data.configuration||!0,duplicateMode:e.duplicateMode,connectorData:e.connectorData}))),cond:e=>!!e.configurationSteps},{target:"#creationWizard.errorConfiguration",actions:(0,Ie.assign)(((e,t)=>({connectorConfiguration:t.data.configuration||!0})))}],onError:{actions:(e,t)=>console.error(t.data.message)}},states:{submittable:{on:{isInvalid:"invalid",next:{actions:(0,Ie.send)("next",{to:"configuratorRef"})}}},invalid:{on:{isValid:"submittable"}}},on:{prev:[{actions:(0,Ie.send)("prev",{to:"configuratorRef"}),cond:"areThereSubsteps"},{target:"#creationWizard.basicConfiguration"}],changedStep:{actions:(0,Ie.assign)({activeConfigurationStep:(e,t)=>t.step})}}}}},errorConfiguration:{id:"configureErrorHandler",initial:"submittable",invoke:{id:"errorRef",src:pt,data:e=>{var t,n;return{accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafkaManagementApiBasePath:e.kafkaManagementApiBasePath,kafka:e.selectedKafkaInstance,namespace:e.selectedNamespace,connector:e.selectedConnector,configuration:e.connectorConfiguration,initialConfiguration:e.connectorConfiguration,topic:e.topic,name:e.name,duplicateMode:e.duplicateMode,userErrorHandler:e.duplicateMode?null===(n=null===(t=e.connectorData)||void 0===t?void 0:t.connector)||void 0===n?void 0:n.error_handler:e.userErrorHandler}},onDone:{target:"reviewConfiguration",actions:[(0,Ie.assign)(((e,t)=>({topic:t.data.topic,userErrorHandler:t.data.userErrorHandler,duplicateMode:e.duplicateMode,name:e.name})))]},onError:{actions:(e,t)=>console.error(t.data.message)}},states:{submittable:{on:{isInvalid:"invalid",next:{actions:(0,Ie.send)("confirm",{to:"errorRef"})}}},invalid:{on:{isValid:"submittable"}}},on:{prev:"configureConnector"}},reviewConfiguration:{id:"review",initial:"reviewing",invoke:{id:"reviewRef",src:xt,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafkaManagementApiBasePath:e.kafkaManagementApiBasePath,kafka:e.selectedKafkaInstance,namespace:e.selectedNamespace,connectorType:e.selectedConnector,configuration:e.connectorConfiguration,initialConfiguration:e.connectorConfiguration,name:e.name,userServiceAccount:e.userServiceAccount,topic:e.topic,userErrorHandler:e.userErrorHandler,duplicateMode:e.duplicateMode}),onDone:{target:"#creationWizard.saved",actions:[(0,Ie.assign)(((e,t)=>({connectorConfiguration:t.data,duplicateMode:e.duplicateMode}))),"notifySave"]},onError:{actions:(e,t)=>console.error(t.data.message)}},states:{reviewing:{on:{isValid:"valid"}},valid:{on:{isInvalid:"reviewing",next:{actions:(0,Ie.send)("save",{to:"reviewRef"})}}}},on:{prev:[{target:"#creationWizard.configureConnector",cond:e=>!!e.configurationSteps},{target:"#creationWizard.errorConfiguration"}]}},saved:{id:"saved",type:"final"}},on:{jumpToSelectConnector:{target:"selectConnector"},jumpToSelectKafka:{target:"selectKafka",cond:"isConnectorSelected"},jumpToSelectNamespace:{target:"selectNamespace",cond:"isKafkaInstanceSelected"},jumpToBasicConfiguration:{target:"basicConfiguration",cond:"isNamespaceSelected"},jumpToConfigureConnector:{target:"configureConnector",cond:"isBasicConfigured",actions:(0,Ie.assign)(((e,t)=>({activeConfigurationStep:t.subStep||0})))},jumpToErrorConfiguration:{target:"errorConfiguration",cond:"isConnectorConfigured"},jumpToReviewConfiguration:{target:"reviewConfiguration",cond:"isConnectorConfigured"}}},{guards:{isKafkaInstanceSelected:e=>void 0!==e.selectedKafkaInstance,isNamespaceSelected:e=>void 0!==e.selectedNamespace,isConnectorSelected:(e,t)=>{const n=t.subStep;return n?void 0!==e.selectedNamespace&&(void 0!==e.connectorConfiguration||n<=e.activeConfigurationStep):void 0!==e.selectedNamespace},isConnectorConfigured:e=>e.configurationSteps?void 0!==e.connectorConfiguration&&!1!==e.connectorConfiguration||e.activeConfigurationStep===e.configurationSteps.length-1&&!0===e.isConfigurationValid:void 0!==e.connectorConfiguration&&!1!==e.connectorConfiguration,isBasicConfigured:e=>void 0!==e.name&&e.name.length>0&&void 0!==e.userServiceAccount&&e.userServiceAccount.clientId.length>0&&e.userServiceAccount.clientSecret.length>0,isErrorHandlerConfigured:e=>void 0!==e.userErrorHandler&&"dead_letter_queue"===e.userErrorHandler?void 0!==e.topic&&e.topic.length>0:void 0!==e.topic&&e.topic.length>0||void 0!==e.userErrorHandler,areThereSubsteps:e=>e.activeConfigurationStep>0},actions:{notifySave:e=>{e.onSave&&e.onSave(e.name)}},services:{makeConfiguratorLoaderMachine:()=>at}}),Nt=(0,u.createContext)(null),wt=({children:e,accessToken:t,connectorsApiBasePath:n,fetchConfigurator:a,onSave:o,connectorData:r,connectorTypeDetails:c,connectorId:i,duplicateMode:l})=>{const s=(0,u.useCallback)((()=>at.withConfig({services:{fetchConfigurator:e=>a(e.connector)}})),[a]),d=(0,he.useInterpret)(Dt,{devTools:!0,context:{accessToken:t,connectorsApiBasePath:n,onSave:o,connectorId:i,connectorData:r,connectorTypeDetails:c,duplicateMode:l},services:{makeConfiguratorLoaderMachine:s}});return p().createElement(Nt.Provider,{value:d},e)},Bt=()=>{const e=(0,u.useContext)(Nt);if(!e)throw new Error("useCreationWizardMachineService() must be used in a child of <CreationWizardMachineProvider>");return e},Ot=()=>{const e=Bt();return(0,he.useSelector)(e,(0,u.useCallback)((e=>({connectorTypeRef:e.children.selectConnectorRef,kafkaRef:e.children.selectKafkaInstanceRef,namespaceRef:e.children.selectNamespaceRef,basicRef:e.children.basicRef,errorRef:e.children.errorRef,reviewRef:e.children.reviewRef})),[]))},Mt=()=>{var e;const{namespaceRef:t}=Ot(),n=Ae(null===(e=t.getSnapshot())||void 0===e?void 0:e.children.paginatedApi),{selectedId:a}=(0,he.useSelector)(t,(0,u.useCallback)((e=>{var t;return{selectedId:null===(t=e.context.selectedNamespace)||void 0===t?void 0:t.id}}),[])),o=(0,u.useCallback)((e=>{t.send({type:"selectNamespace",selectedNamespace:e})}),[t]),r=(0,u.useCallback)((e=>{t.send(Object.assign({type:"api.query"},e))}),[t]),c=(0,u.useCallback)((()=>{t.send({type:"api.refresh"})}),[t]);return Object.assign(Object.assign({},n),{selectedId:a,onSelect:o,onRefresh:c,onQuery:r})},_t=()=>{var e;const{connectorTypeRef:t}=Ot(),n=Ae(null===(e=t.getSnapshot())||void 0===e?void 0:e.children.paginatedApi),{selectedId:a,connectorTypeDetails:o,duplicateMode:r}=(0,he.useSelector)(t,(0,u.useCallback)((e=>{var t;return{selectedId:null===(t=e.context.selectedConnector)||void 0===t?void 0:t.id,duplicateMode:e.context.duplicateMode,connectorTypeDetails:e.context.connectorTypeDetails}}),[])),c=(0,u.useCallback)((e=>{t.send({type:"selectConnector",selectedConnector:e})}),[t]),i=(0,u.useCallback)((e=>{t.send(Object.assign({type:"api.query"},e))}),[t]);return Object.assign(Object.assign({},n),{selectedId:a,onSelect:c,onQuery:i,connectorTypeDetails:o,duplicateMode:r})},jt=()=>{var e;const{kafkaRef:t}=Ot(),n=Ae(null===(e=t.getSnapshot())||void 0===e?void 0:e.children.paginatedApi),{selectedId:a,duplicateMode:o}=(0,he.useSelector)(t,(0,u.useCallback)((e=>{var t;return{selectedId:null===(t=e.context.selectedInstance)||void 0===t?void 0:t.id,duplicateMode:e.context.duplicateMode}}),[])),r=(0,u.useCallback)((e=>{t.send({type:"selectInstance",selectedInstance:e})}),[t]),c=(0,u.useCallback)((()=>{t.send({type:"deselectInstance"})}),[t]),i=(0,u.useCallback)((e=>{t.send(Object.assign({type:"api.query"},e))}),[t]);return Object.assign(Object.assign({},n),{selectedId:a,duplicateMode:o,onSelect:r,onDeselect:c,onQuery:i})},Lt=()=>{const{reviewRef:e}=Ot(),{kafka:t,namespace:n,connectorType:a,topic:o,userErrorHandler:r,name:c,userServiceAccount:i,configString:l,isSaving:s,savingError:d,duplicateMode:p}=(0,he.useSelector)(e,(0,u.useCallback)((e=>({kafka:e.context.kafka,namespace:e.context.namespace,connectorType:e.context.connectorType,name:e.context.name,userServiceAccount:e.context.userServiceAccount,topic:e.context.topic,userErrorHandler:e.context.userErrorHandler,configString:e.context.configString,isSaving:e.hasTag("saving"),savingError:e.context.savingError,duplicateMode:e.context.duplicateMode})),[]));return{kafka:t,namespace:n,connectorType:a,topic:o,userErrorHandler:r,name:c,userServiceAccount:i,configString:l,isSaving:s,savingError:d,duplicateMode:p}};var qt=n(2899);const Ft=({isOpen:e,sACreated:t,handleModalToggle:n,serviceAccount:a,onSetServiceAccount:r,onSetSaCreated:c})=>{const[s,d]=(0,u.useState)(!1),[m,f]=(0,u.useState)(""),[E,C]=(0,u.useState)("default"),[h,y]=(0,u.useState)(!1),{kafkaManagementApiBasePath:b,getToken:S}=k(),T=(0,x.useAlert)(),I=(0,u.useCallback)((e=>{c(!0),y(!1);const t=e?{clientId:e.client_id,clientSecret:e.client_secret}:{clientId:"",clientSecret:""};r(t)}),[c,y,r]),P=(0,u.useCallback)((e=>{null==T||T.addAlert({id:"connectors-table-error",variant:g.AlertVariant.danger,title:(0,qt.t)("somethingWentWrong"),description:e}),y(!1)}),[T]);return p().createElement(g.Modal,{variant:g.ModalVariant.medium,title:t?"":(0,qt.t)("createServiceAccount"),isOpen:e,onClose:n,actions:t?[]:[p().createElement(g.Button,{key:"Create",variant:"primary",spinnerAriaValueText:h?(0,qt.t)("loading"):void 0,isLoading:h,isDisabled:"error"===E||h,onClick:()=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){"default"===E&&0===m.length?C("error"):(({accessToken:e,kafkaManagementApiBasePath:t,sortDesc:n})=>{const a=new l.SecurityApi(new i.Configuration({accessToken:e,basePath:t}));return(e,t)=>{const r=o().CancelToken.source();return a.createServiceAccount({name:`connector-${n}`},{cancelToken:r.token}).then((t=>{e(t.data)})).catch((e=>{o().isCancel(e)||t(e.response.data.reason)})),()=>{r.cancel("Operation canceled by the user.")}}})({accessToken:S,kafkaManagementApiBasePath:b,sortDesc:m})(I,P)}))},(0,qt.t)("create")),p().createElement(g.Button,{key:"cancel",variant:"link",onClick:n},(0,qt.t)("cancel"))]},t?p().createElement(g.EmptyState,{variant:g.EmptyStateVariant.large},p().createElement(g.EmptyStateIcon,{icon:v.KeyIcon}),p().createElement(g.Title,{headingLevel:"h4",size:"lg"},(0,qt.t)("credentialsGenerated")),p().createElement(g.TextContent,{className:"pf-u-mt-lg"},p().createElement(g.Text,{component:g.TextVariants.small},(0,qt.t)("connectKafkaWithSA"))),p().createElement(g.InputGroup,{className:"pf-u-mt-lg"},p().createElement(g.InputGroupText,{style:{whiteSpace:"nowrap"},id:"Client-id-value"},(0,qt.t)("clientId")),p().createElement(g.ClipboardCopy,{isReadOnly:!0,className:"pf-u-w-100",hoverTip:(0,qt.t)("copy"),clickTip:(0,qt.t)("copied")},a.clientId)),p().createElement(g.InputGroup,{className:"pf-u-mt-lg"},p().createElement(g.InputGroupText,{style:{whiteSpace:"nowrap"},id:"Client-secret-value"},(0,qt.t)("clientSecret")),p().createElement(g.ClipboardCopy,{className:"pf-u-w-100",isReadOnly:!0,hoverTip:(0,qt.t)("copy"),clickTip:(0,qt.t)("copied")},a.clientSecret)),p().createElement(g.TextContent,{className:"pf-u-mt-lg"},p().createElement(g.Text,{component:g.TextVariants.small},(0,qt.t)("serviceAccountAlertMsg"))),p().createElement(g.Bullseye,{className:"pf-u-mt-lg"},p().createElement(g.Checkbox,{id:"copied",label:(0,qt.t)("copiedClientidSecret"),"aria-label":(0,qt.t)("copiedClientidSecret"),onChange:()=>d(!s),isChecked:s})),p().createElement(g.Button,{variant:"primary",isDisabled:!s,onClick:n},(0,qt.t)("close"))):p().createElement(g.Form,null,p().createElement(g.FormGroup,{label:(0,qt.t)("shortDescription"),labelIcon:p().createElement(g.Popover,{headerContent:p().createElement("div",null,(0,qt.t)("shortDescription")),bodyContent:p().createElement("div",null,(0,qt.t)("shortDescriptionHelpText"))},p().createElement("button",{type:"button","aria-label":(0,qt.t)("shortDescriptionTooltip"),onClick:e=>e.preventDefault(),"aria-describedby":"short-description",className:"pf-c-form__group-label-help"},p().createElement(v.HelpIcon,{noVerticalAlign:!0}))),isRequired:!0,fieldId:"short-description-01",helperText:(0,qt.t)("shortDescriptionExampleText"),helperTextInvalid:m.length>0?(0,qt.t)("shortDescriptionExampleText"):(0,qt.t)("required"),validated:E},p().createElement(g.TextInput,{isRequired:!0,validated:E,type:"text",id:"short-description-01",name:"short-description-01","aria-describedby":"short-description",value:m,onChange:(e,t)=>{C(/^[a-z]([-a-z0-9]*[a-z0-9])?$/.test(e)?"success":"error"),f(e)}}))))},Rt=({title:e,description:t,component:n,children:a})=>p().createElement("div",{className:"pf-l-stack"},p().createElement("div",{className:"pf-l-stack__item pf-u-p-md"},p().createElement(g.Level,null,p().createElement(g.LevelItem,null,p().createElement(g.Title,{headingLevel:"h2"},e)),p().createElement(g.LevelItem,null,n)),"string"==typeof t?p().createElement("p",{className:"wizard-step__description"},t):t),p().createElement("div",{className:"pf-l-stack__item pf-l-stack pf-m-fill pf-u-pl-md pf-u-pr-md  pf-u-pb-md"},a)),zt=()=>{const{t:e}=(0,m.useTranslation)(),{name:t,serviceAccount:n,sACreated:a,onSetSaCreated:o,onSetName:r,onSetServiceAccount:c}=(()=>{const{basicRef:e}=Ot(),{name:t,sACreated:n,serviceAccount:a,duplicateMode:o}=(0,he.useSelector)(e,(0,u.useCallback)((e=>({name:e.context.name,sACreated:e.context.sACreated,serviceAccount:e.context.userServiceAccount,duplicateMode:e.context.duplicateMode})),[])),r=(0,u.useCallback)((t=>{e.send({type:"setName",name:t})}),[e]),c=(0,u.useCallback)((t=>{e.send({type:"setSaCreated",sACreated:t})}),[e]),i=(0,u.useCallback)((t=>{e.send({type:"setServiceAccount",serviceAccount:t})}),[e]);return{serviceAccount:a,name:t,sACreated:n,onSetSaCreated:c,onSetName:r,onSetServiceAccount:i,duplicateMode:o}})(),[i,l]=(0,u.useState)(!1),s=()=>{l(!i)};return(0,u.useEffect)((()=>{null!=n||c({clientId:"",clientSecret:""})}),[]),p().createElement(p().Fragment,null,p().createElement(Rt,{title:e("common"),description:e("basicStepDescription")},p().createElement(g.Grid,{hasGutter:!0},p().createElement(g.Form,{className:"pf-m-9-col-on-lg"},p().createElement(g.FormGroup,{label:e("name"),isRequired:!0,fieldId:"name",helperText:"Please provide a unique name for the connector",className:"pf-u-mb-0"},p().createElement(g.TextInput,{value:t,onChange:r,id:"name"})),p().createElement(g.FormGroup,{label:e("serviceAccount"),fieldId:"service-account",className:"pf-u-mb-0"},p().createElement(g.TextContent,null,p().createElement("span",{className:"step-common_service_account-desc"},e("serviceAccountDescText"))),p().createElement(g.Button,{variant:"secondary",onClick:s,className:"pf-u-mt-md",isDisabled:a},e("createServiceAccount"))),n&&p().createElement(p().Fragment,null,p().createElement(g.FormGroup,{label:e("clientId"),isRequired:!0,fieldId:"clientId",className:"pf-u-mb-0"},p().createElement(g.TextInput,{value:n.clientId,onChange:e=>c(Object.assign(Object.assign({},n),{clientId:e})),id:"clientId"})),p().createElement(g.FormGroup,{label:e("clientSecret"),isRequired:!0,fieldId:"clientSecret",className:"pf-u-mb-0"},p().createElement(g.TextInput,{value:n.clientSecret,type:"password",onChange:e=>c(Object.assign(Object.assign({},n),{clientSecret:e})),id:"clientSecret"})))))),p().createElement(Ft,{isOpen:i,handleModalToggle:s,serviceAccount:n,onSetServiceAccount:c,onSetSaCreated:o,sACreated:a}))},Gt=({actor:e,Configurator:t,duplicateMode:n})=>{let{activeStep:a,configuration:o,connector:r,connectorData:i}=(0,he.useSelector)(e,(0,u.useCallback)((e=>({connector:e.context.connector,activeStep:e.context.activeStep,configuration:e.context.configuration,connectorData:e.context.connectorData})),[e]));if(n){_(o);const e=JSON.parse(JSON.stringify(null==i?void 0:i.connector));let t={};t=o instanceof Map?c().merge({},e,M(o)):c().merge({},e,o),o=new Map(Object.entries(t))}return p().createElement(t,{activeStep:a,configuration:o,connector:r,isViewMode:n&&!1,onChange:(t,n)=>{e.send({type:"change",configuration:t,isValid:n})}})},Vt=({actor:e,duplicateMode:t})=>{const{configuration:n,connector:a}=(0,he.useSelector)(e,(0,u.useCallback)((e=>({connector:e.context.connector,configuration:e.context.configuration})),[e]));return t&&_(n),p().createElement($,{schema:a.schema,configuration:n||{},duplicateMode:t,onChange:(t,n)=>e.send({type:"change",configuration:t,isValid:n})})},Ht=()=>{const{t:e}=(0,m.useTranslation)(),t=Bt(),{isLoading:n,hasErrors:a,Configurator:o,configuratorRef:r,hasCustomConfigurator:c,duplicateMode:i}=(0,he.useSelector)(t,(0,u.useCallback)((e=>({isLoading:e.matches({configureConnector:"loadConfigurator"}),hasErrors:e.matches("failure"),hasCustomConfigurator:!1!==e.context.Configurator&&void 0!==e.context.Configurator,configuration:e.context.connectorConfiguration,Configurator:e.context.Configurator,duplicateMode:e.context.duplicateMode,configuratorRef:e.children.configuratorRef})),[t]));return p().createElement(Rt,{title:e("configurations"),description:e("configurationStepDescription")},(()=>{switch(!0){case n:return p().createElement(g.EmptyState,null,p().createElement(g.EmptyStateIcon,{variant:"container",component:g.Spinner}),p().createElement(g.Title,{size:"lg",headingLevel:"h4"},e("loading")));case a:return p().createElement(g.EmptyState,null,p().createElement(g.EmptyStateIcon,{icon:v.ExclamationCircleIcon}),p().createElement(g.Title,{size:"lg",headingLevel:"h4"},"Error message"));case c:return p().createElement(p().Suspense,{fallback:null},p().createElement(Gt,{actor:r,Configurator:o,duplicateMode:i}));default:return p().createElement(Vt,{actor:r,duplicateMode:i})}})())},Kt=(e,t)=>({key:e,node:t(e)});var Jt=n(3889),Wt=n.n(Jt);const $t=(e,t=200)=>{if(isNaN(t))throw new TypeError("durationInMs for debounce should be a number");if("function"!=typeof e)throw new TypeError("fnToDebounce should be a function");return(0,u.useCallback)(Wt()(e,t),[e,t])};function Ut(){return(()=>{const{connectorTypeRef:e}=Ot();return(0,he.useSelector)(e,(0,u.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?p().createElement(Qt,null):null}function Qt(){const{t:e}=(0,m.useTranslation)(),{response:t,loading:n,error:a,noResults:o,queryEmpty:r,duplicateMode:c,connectorTypeDetails:i,firstRequest:l,selectedId:s,onSelect:d,onQuery:u}=_t();return p().createElement(Rt,{title:e("connector"),description:e("connectorTypeStepDescription")},(()=>{var e;switch(!0){case l:return p().createElement(h.g,null);case r:return p().createElement(p().Fragment,null,p().createElement(Zt,{duplicateMode:c}),p().createElement(Ce,{onClear:()=>u({page:1,size:10})}));case o||a:return p().createElement(fe,null);case n:return p().createElement(p().Fragment,null,p().createElement(Zt,{duplicateMode:c}),p().createElement(h.g,null));default:return p().createElement(p().Fragment,null,p().createElement(Zt,{duplicateMode:c}),p().createElement("div",{className:"pf-l-stack__item pf-m-fill"},c?p().createElement(p().Fragment,null,p().createElement(g.Alert,{variant:"info",className:"pf-u-mb-md",isInline:!0,title:"Kafka instances and namespaces both expire after 48 hours. When duplicating a Connectors instance, select a new Kafka instance and namespace. "}),p().createElement(g.Gallery,{hasGutter:!0},p().createElement(g.Card,{key:i.id,isSelectable:!0,isSelected:s===i.id},p().createElement(g.CardHeader,null,p().createElement(g.CardTitle,null,i.name)),p().createElement(g.CardBody,null,p().createElement(g.DescriptionList,null,p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListDescription,null,i.description)),p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListTerm,null,"Version"),p().createElement(g.DescriptionListDescription,null,i.version)),p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListTerm,null,"ID"),p().createElement(g.DescriptionListDescription,null,i.id))))))):p().createElement(g.Gallery,{hasGutter:!0},null===(e=null==t?void 0:t.items)||void 0===e?void 0:e.map((e=>p().createElement(g.Card,{isHoverable:!0,key:e.id,isSelectable:!0,isSelected:s===e.id,onClick:()=>d(e.id)},p().createElement(g.CardHeader,null,p().createElement(g.CardTitle,null,e.name)),p().createElement(g.CardBody,null,p().createElement(g.DescriptionList,null,p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListDescription,null,e.description)),p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListTerm,null,"Version"),p().createElement(g.DescriptionListDescription,null,e.version)),p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListTerm,null,"ID"),p().createElement(g.DescriptionListDescription,null,e.id))))))))))}})())}const Zt=({duplicateMode:e})=>{const{t}=(0,m.useTranslation)(),{request:n,onQuery:a}=_t(),[o,r]=(0,u.useState)(!1),c=(0,u.useRef)(null),i=$t(a,1e3),{name:l,categories:s=[]}=n.query||{},d=(0,u.useCallback)((()=>a({page:1,size:n.size})),[a,n.size]),f=(0,u.useCallback)((()=>r((e=>!e))),[]),E=(e,t)=>{((e,t,o)=>{a(Object.assign(Object.assign({},n),{query:Object.assign(Object.assign({},n.query||{}),{[e]:t.includes(o)?t.filter((e=>e!==o)):[...t||[],o]})}))})("categories",s,t.key)};(0,u.useEffect)((()=>{c.current&&(c.current.value=l||"")}),[c,l]);const C=[p().createElement(g.SelectOption,{key:"sink",value:"sink"},t("sink")),p().createElement(g.SelectOption,{key:"source",value:"source"},t("source"))],h=p().createElement(p().Fragment,null,p().createElement(g.ToolbarItem,null,p().createElement(g.InputGroup,null,p().createElement(g.TextInput,{isDisabled:e,name:"name",id:"name",type:"search","aria-label":"filter by connector name",onChange:e=>i({size:n.size,page:1,query:Object.assign(Object.assign({},n.query),{name:e})}),ref:c}),p().createElement(g.Button,{variant:"control","aria-label":"search button for search input",isDisabled:e},p().createElement(v.SearchIcon,null)))),p().createElement(g.ToolbarGroup,{variant:"filter-group"},p().createElement(g.ToolbarFilter,{chips:e?[]:s.map((e=>Kt(e,t))),deleteChip:E,deleteChipGroup:()=>{return e="categories",a(Object.assign(Object.assign({},n),{query:Object.assign(Object.assign({},n.query||{}),{[e]:void 0})}));var e},categoryName:"Connector type"},p().createElement(g.Select,{variant:"checkbox","aria-label":"Connector type",onToggle:f,onSelect:(e,n)=>E(0,Kt(n,t)),selections:e?"":s,isOpen:o,placeholderText:"Connector type",isDisabled:e},C)))),y=p().createElement(p().Fragment,null,p().createElement(g.ToolbarToggleGroup,{toggleIcon:p().createElement(v.FilterIcon,null),breakpoint:"xl"},h),!e&&p().createElement(g.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},p().createElement(Yt,{isCompact:!0,onChange:(e,t)=>a({page:e,size:t,query:n.query||{}})})));return p().createElement(g.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl",clearAllFilters:d},p().createElement(g.ToolbarContent,{className:"pf-m-no-padding"},y))},Yt=({isCompact:e=!1,onChange:t})=>{const{request:n,response:a}=_t();return p().createElement(me,{itemCount:(null==a?void 0:a.total)||0,page:n.page,perPage:n.size,onChange:t,isCompact:e})},Xt=()=>{var e;const[t,n]=p().useState(!1),{t:a}=(0,m.useTranslation)(),{connector:o,topic:r,errorHandler:c,onSetTopic:i,onSetErrorHandler:l,duplicateMode:s}=(()=>{const{errorRef:e}=Ot(),{connector:t,topic:n,errorHandler:a,duplicateMode:o}=(0,he.useSelector)(e,(0,u.useCallback)((e=>({topic:e.context.topic,errorHandler:e.context.userErrorHandler,connector:e.context.connector,duplicateMode:e.context.duplicateMode})),[])),r=(0,u.useCallback)((t=>{e.send({type:"setTopic",topic:t})}),[e]),c=(0,u.useCallback)((t=>{e.send({type:"setErrorHandler",errorHandler:t})}),[e]);return{errorHandler:a,topic:n,onSetErrorHandler:c,onSetTopic:r,connector:t,duplicateMode:o}})();if(s&&"object"==typeof c){const e=Object.keys(c);l(e[0]),void 0===c[e[0]]?i(""):i(c[e[0]].topic)}const d=(0,u.useCallback)((()=>n((e=>!e))),[]),v=(0,u.useCallback)(((e,t,a)=>{a?f():(n(!1),i(""),l(t))}),[]),f=(0,u.useCallback)((()=>{n(!1)}),[]),E=R(o.schema),C=new V.JSONSchemaBridge(o.schema,E),{error_handler:h}=null===(e=C.schema)||void 0===e?void 0:e.properties,y=h.oneOf.map((e=>{const t=Object.keys(e.properties);return p().createElement(g.SelectOption,{key:t[0],value:t[0]})}));return p().createElement(Rt,{title:a("errorHandler"),description:a("errorHandlingStepDescription")},p().createElement(g.Grid,{hasGutter:!0},p().createElement(g.Form,{className:"pf-m-9-col-on-lg"},p().createElement(g.FormGroup,{label:a("errorHandler"),fieldId:"error-handler_strategy",className:"error-handler_strategy pf-u-mb-0"},p().createElement(g.Select,{variant:g.SelectVariant.single,"aria-label":"Select Error handler",onToggle:d,onSelect:v,selections:c,isOpen:t,placeholderText:"Select type"},y)),"dead_letter_queue"===c&&p().createElement(g.FormGroup,{label:"Dead Letter Topic Name",isRequired:!0,fieldId:"topic",helperText:"The name of the Kafka topic used as dead letter queue"},p().createElement(g.TextInput,{value:r,onChange:i,id:"topic"})))))},en=({onCreate:e})=>{const{t}=(0,m.useTranslation)();return p().createElement(g.EmptyState,{variant:g.EmptyStateVariant.xl,className:(0,se.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},p().createElement(g.EmptyStateIcon,{icon:v.PlusCircleIcon}),p().createElement(g.Title,{headingLevel:"h1",size:g.TitleSizes["4xl"]},t("noKafkaInstanceAvailable")),p().createElement(g.EmptyStateBody,null,t("noKafkaInstanceAvailableBody")),p().createElement(g.Button,{variant:"primary",onClick:e},t("createKafkaInstance")))},tn=()=>(()=>{const{kafkaRef:e}=Ot();return(0,he.useSelector)(e,(0,u.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?p().createElement(nn,null):null,nn=()=>{const{t:e}=(0,m.useTranslation)(),{response:t,loading:n,error:a,selectedId:o,onDeselect:r,duplicateMode:c,noResults:i,queryEmpty:l,firstRequest:s,onSelect:d,onQuery:v}=jt();return(0,u.useEffect)((()=>{var e;c&&t&&((null===(e=null==t?void 0:t.items)||void 0===e?void 0:e.find((e=>e.id===o)))?d(o):r())}),[c,t,r]),p().createElement(Rt,{title:e("kafkaInstance"),description:e("kafkaStepDescription")},(()=>{var e;switch(!0){case s:return p().createElement(h.g,null);case l:return p().createElement(p().Fragment,null,p().createElement(an,null),p().createElement(Ce,{onClear:()=>v({page:1,size:10})}));case i||a:return p().createElement(en,{onCreate:function(){throw new Error("Function not implemented.")}});case n:return p().createElement(p().Fragment,null,p().createElement(an,null),p().createElement(h.g,null));default:return p().createElement(p().Fragment,null,p().createElement(an,null),p().createElement("div",{className:"pf-l-stack__item pf-m-fill"},p().createElement(g.Gallery,{hasGutter:!0},null===(e=null==t?void 0:t.items)||void 0===e?void 0:e.map((e=>p().createElement(g.Card,{isHoverable:!0,key:e.id,isSelectable:!0,isSelected:o===e.id,onClick:()=>d(e.id)},p().createElement(g.CardHeader,null,p().createElement(g.CardTitle,null,e.name)),p().createElement(g.CardBody,null,p().createElement(g.DescriptionList,null,p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListTerm,null,"Region"),p().createElement(g.DescriptionListDescription,null,e.region)),p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListTerm,null,"Owner"),p().createElement(g.DescriptionListDescription,null,e.owner)),p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListTerm,null,"Created"),p().createElement(g.DescriptionListDescription,null,e.created_at))))))))))}})())},an=()=>{const{t:e}=(0,m.useTranslation)(),{request:t,onQuery:n}=jt(),[a,o]=(0,u.useState)(!1),[r,c]=(0,u.useState)(!1),[i,l]=(0,u.useState)(!1),[s,d]=(0,u.useState)(!1),[f,E]=(0,u.useState)("Name"),C=(0,u.useCallback)((()=>o((e=>!e))),[]),h=(0,u.useCallback)((()=>c((e=>!e))),[]),y=(0,u.useCallback)((()=>l((e=>!e))),[]),b=(0,u.useCallback)((()=>d((e=>!e))),[]),S=$t(n,1e3),{name:T,owner:k,cloudProviders:I=[],regions:x=[],statuses:A=[]}=t.query||{},P=(0,u.useCallback)((()=>n({page:1,size:t.size})),[n,t.size]),D=(0,u.useRef)(null),N=(0,u.useRef)(null),w=(e,a,o)=>n(Object.assign(Object.assign({},t),{query:Object.assign(Object.assign({},t.query||{}),{[e]:a.includes(o)?a.filter((e=>e!==o)):[...a||[],o]})})),B=(e,t)=>{w("statuses",A,t.key)},O=(e,t)=>{w("cloudProviders",I,t.key)},M=(e,t)=>{w("regions",x,t.key)},_=e=>n(Object.assign(Object.assign({},t),{query:Object.assign(Object.assign({},t.query||{}),{[e]:void 0})})),j=(0,u.useCallback)((e=>{const t=(null==e?void 0:e.target).innerText;E(t),d((e=>!e))}),[]);(0,u.useEffect)((()=>{D.current&&(D.current.value=T||""),N.current&&(N.current.value=k||"")}),[D,T,k]);const L=on.map((({value:e,label:t})=>p().createElement(g.DropdownItem,{key:e},t))),q=cn.filter((e=>"preparing"!==e.value)).map((({value:e,label:t})=>p().createElement(g.SelectOption,{key:e,value:e},t))),F=rn.map((({value:e,label:t})=>p().createElement(g.SelectOption,{key:e,value:e},t))),R=ln.map((({value:e,label:t})=>p().createElement(g.SelectOption,{key:e,value:e},t))),z=p().createElement(g.ToolbarItem,null,p().createElement(g.Dropdown,{onSelect:e=>j(e),position:g.DropdownPosition.left,toggle:p().createElement(g.DropdownToggle,{onToggle:b,style:{width:"100%"}},p().createElement(v.FilterIcon,{size:"sm"})," ",f),isOpen:s,dropdownItems:L,style:{width:"100%"}})),G=p().createElement(p().Fragment,null,p().createElement(g.ToolbarGroup,{variant:"filter-group"},z,p().createElement(g.ToolbarFilter,{chips:A.map((t=>Kt(t,e))),deleteChip:B,deleteChipGroup:()=>_("statuses"),categoryName:e("status"),showToolbarItem:f===e("status")},p().createElement(g.Select,{variant:"checkbox","aria-label":e("status"),onToggle:C,onSelect:(t,n)=>B(0,Kt(n,e)),selections:A,isOpen:a,placeholderText:e("filterByStatus")},q)),p().createElement(g.ToolbarFilter,{chips:I.map((t=>Kt(t,e))),deleteChip:O,deleteChipGroup:()=>_("cloudProviders"),categoryName:e("cloudProvider"),showToolbarItem:f===e("cloudProvider")},p().createElement(g.Select,{variant:"checkbox","aria-label":e("cloudProvider"),onToggle:h,onSelect:(t,n)=>O(0,Kt(n,e)),selections:I,isOpen:r,placeholderText:e("filterByCloudProvider")},F)),p().createElement(g.ToolbarFilter,{chips:x.map((t=>Kt(t,e))),deleteChip:M,deleteChipGroup:()=>_("regions"),categoryName:e("region"),showToolbarItem:f===e("region")},p().createElement(g.Select,{variant:"checkbox","aria-label":e("region"),onToggle:y,onSelect:(t,n)=>M(0,Kt(n,e)),selections:x,isOpen:i,placeholderText:e("filterByRegion")},R)),p().createElement(g.ToolbarFilter,{chips:T?[T]:[],deleteChip:()=>_("name"),categoryName:e("name")},f===e("name")&&p().createElement(g.ToolbarItem,null,p().createElement(g.InputGroup,null,p().createElement(g.TextInput,{name:e("name"),id:e("name"),type:"search",placeholder:e("nameSearchPlaceholder"),"aria-label":e("nameSearchPlaceholder"),onChange:e=>S({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{name:e})}),ref:D}),p().createElement(g.Button,{variant:"control","aria-label":"search button for name input",onClick:()=>{var e;return n({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{name:(null===(e=D.current)||void 0===e?void 0:e.value)||""})})}},p().createElement(v.SearchIcon,null))))),p().createElement(g.ToolbarFilter,{chips:k?[k]:[],deleteChip:()=>_("owner"),categoryName:e("owner")},f===e("owner")&&p().createElement(g.ToolbarItem,null,p().createElement(g.InputGroup,null,p().createElement(g.TextInput,{name:e("owner"),id:e("owner"),type:"search",placeholder:e("ownerSearchPlaceholder"),"aria-label":e("ownerSearchPlaceholder"),onChange:e=>S({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{owner:e})}),ref:N}),p().createElement(g.Button,{variant:"control","aria-label":"search button for owner input",onClick:()=>{var e;return n({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{owner:(null===(e=N.current)||void 0===e?void 0:e.value)||""})})}},p().createElement(v.SearchIcon,null))))))),V=p().createElement(p().Fragment,null,p().createElement(g.ToolbarToggleGroup,{toggleIcon:p().createElement(v.FilterIcon,null),breakpoint:"xl"},G),p().createElement(g.ToolbarGroup,{variant:"icon-button-group"},p().createElement(g.ToolbarItem,null,p().createElement(g.Button,{variant:"primary"},e("createKafkaInstance")))),p().createElement(g.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},p().createElement(sn,{isCompact:!0})));return p().createElement(g.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl",clearAllFilters:P},p().createElement(g.ToolbarContent,null,V))},on=[{value:"name",label:"Name"},{value:"status",label:"Status"},{value:"cloudprovider",label:"Cloud Provider"},{value:"region",label:"Region"},{value:"owner",label:"Owner"}],rn=[{value:"aws",label:"Amazon Web Services"}],cn=[{value:"ready",label:"Ready"},{value:"failed",label:"Failed"},{value:"accepted",label:"Creation pending"},{value:"provisioning",label:"Creation in progress"},{value:"preparing",label:"Creation in progress"},{value:"deprovision",label:"Deletion in progress"}],ln=[{value:"us-east-1",label:"US East, N. Virginia"}],sn=({isCompact:e=!1})=>{const{request:t,response:n,onQuery:a}=jt();return p().createElement(me,{itemCount:(null==n?void 0:n.total)||0,page:t.page,perPage:t.size,onChange:(e,t)=>a({page:e,size:t}),isCompact:e})},dn=({onModalToggle:e})=>{const{t}=(0,m.useTranslation)();return p().createElement(g.Bullseye,null,p().createElement(g.EmptyState,{variant:g.EmptyStateVariant.large},p().createElement(g.EmptyStateIcon,{icon:v.PlusCircleIcon}),p().createElement(g.Title,{headingLevel:"h4",size:"lg"},t("noNamespaceAvailable")),p().createElement(g.EmptyStateBody,null,t("namespaceEmptyMsg")),p().createElement(g.Button,{variant:"primary",onClick:e},t("registerEvalNamespace")),p().createElement(g.EmptyStateSecondaryActions,null,p().createElement(g.Button,{variant:"link",icon:p().createElement(v.ExternalLinkSquareAltIcon,null)},t("osdInstallationGuide")))))},un=()=>{const{t:e}=(0,m.useTranslation)();return p().createElement(g.Alert,{variant:g.AlertVariant.info,isInline:!0,title:e("namespaceExpireAlert")})},pn=n(47407),mn=({isModalOpen:e,onModalToggle:t,refreshResponse:n})=>{const{t:a}=(0,m.useTranslation)(),[r,c]=(0,u.useState)(""),[l,s]=(0,u.useState)(!1),{connectorsApiBasePath:d,getToken:v}=k(),f=(0,x.useAlert)();(0,u.useEffect)((()=>{c(`eval-namespace-${pn.generate()}`)}),[]);const E=(0,u.useCallback)((e=>{n(),s(!1),t(),null==f||f.addAlert({id:"eval-namespace-register-success",variant:g.AlertVariant.success,title:a(`${null==e?void 0:e.name} registered successfully.`)})}),[]),C=(0,u.useCallback)((e=>{s(!1),null==f||f.addAlert({id:"eval-namespace-register-error",variant:g.AlertVariant.danger,title:a("somethingWentWrong"),description:e})}),[f,a]);return p().createElement(g.Modal,{variant:g.ModalVariant.medium,title:a("registrationEvalNamespace"),isOpen:e,onClose:t,actions:[p().createElement(g.Button,{key:"confirm",variant:"primary",isLoading:l,spinnerAriaValueText:l?a("Loading"):void 0,isDisabled:l,onClick:()=>{s(!0),(({accessToken:e,connectorsApiBasePath:t,evalName:n})=>{const a=new i.ConnectorNamespacesApi(new i.Configuration({accessToken:e,basePath:t}));return(e,t)=>{const r=o().CancelToken.source();return a.createEvaluationNamespace({name:n,annotations:[{key:"connector_mgmt.api.openshift.com/profile",value:"default-profile"}]},{cancelToken:r.token}).then((t=>{e(t.data)})).catch((e=>{o().isCancel(e)||t(e.response.data.reason)})),()=>{r.cancel("Operation canceled by the user.")}}})({accessToken:v,connectorsApiBasePath:d,evalName:r})(E,C)}},a("register")),p().createElement(g.Button,{key:"cancel",variant:"link",isDisabled:l,onClick:t},a("cancel"))]},p().createElement(un,null),p().createElement(g.Text,{component:g.TextVariants.h3,className:"pf-c-title pf-m-lg pf-u-pt-lg"},a("namespaceInformation")),p().createElement(g.Form,{className:"pf-u-mt-lg pf-u-mb-lg"},p().createElement(g.FormGroup,{label:a("name"),isRequired:!0,fieldId:"name"},p().createElement(g.Text,{component:g.TextVariants.p},r)),p().createElement(g.FormGroup,{label:a("duration"),isRequired:!0,fieldId:"name"},p().createElement(g.Text,{component:g.TextVariants.p},"48 hours"))),p().createElement(g.Alert,{variant:"info",isInline:!0,isPlain:!0,title:a("namespaceModelAlert")}))},gn=e=>{let t=e.getTime()-(new Date).getTime();t/=1e3;let n=Math.floor(t/3600);return t-=3600*n,` ${n} hours ${Math.floor(t/60)} minute.`};function vn(){return(()=>{const{namespaceRef:e}=Ot();return(0,he.useSelector)(e,(0,u.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?p().createElement(En,null):null}const fn=e=>{let t=e.getTime()-(new Date).getTime();t/=1e3;let n=Math.floor(t/3600);return n>=24?"info":n>=3?"warning":"danger"},En=()=>{const{t:e}=(0,m.useTranslation)(),[t,n]=(0,u.useState)(!1),[a,o]=(0,u.useState)(),{response:r,selectedId:i,loading:l,error:s,noResults:d,queryEmpty:v,firstRequest:E,onSelect:C,onRefresh:y,onQuery:b}=Mt(),S=(0,u.useCallback)((()=>{n((e=>!e))}),[]);return(0,u.useEffect)((()=>{var e;const t=null===(e=null==r?void 0:r.items)||void 0===e?void 0:e.find((e=>"user"===e.tenant.kind&&c().has(e,"expiration")));o(t||void 0)}),[r]),p().createElement(Rt,{title:e("namespace"),description:e("namespaceStepDescription")},(()=>{var t;switch(!0){case E:return p().createElement(h.g,null);case v:return p().createElement(p().Fragment,null,p().createElement(Cn,{onModalToggle:S,isEvalPresent:!!a}),p().createElement(Ce,{onClear:()=>b({page:1,size:10})}));case d||s:return p().createElement(p().Fragment,null,p().createElement(Cn,{onModalToggle:S,isEvalPresent:!!a}),p().createElement(dn,{onModalToggle:S}));case l:return p().createElement(p().Fragment,null,p().createElement(Cn,{onModalToggle:S,isEvalPresent:!!a}),p().createElement(h.g,null));default:return p().createElement(p().Fragment,null,p().createElement(Cn,{onModalToggle:S,isEvalPresent:!!a}),p().createElement("div",{className:"pf-l-stack__item pf-m-fill"},!!a&&(null==a?void 0:a.id)===i&&p().createElement(g.Alert,{variant:fn(new Date(a.expiration)),className:"pf-u-mb-md",isInline:!0,title:p().createElement("span",null,e("evalNamespaceExpire"),gn(new Date(a.expiration)))}),p().createElement(g.Gallery,{hasGutter:!0},null===(t=null==r?void 0:r.items)||void 0===t?void 0:t.map((t=>p().createElement(g.Card,{isHoverable:"ready"===t.status.state,key:t.id,isSelectable:"ready"===t.status.state,isSelected:i===t.id,onClick:()=>{var e;"ready"===(e=t).status.state&&C(e.id)},className:"deleting"===t.status.state?"pf-u-background-color-disabled-color-200":""},p().createElement(g.CardHeader,null,p().createElement(g.Stack,null,p().createElement(g.StackItem,null," ",p().createElement(g.CardTitle,null,t.name)),p().createElement(g.StackItem,null,"disconnected"===t.status.state&&p().createElement("div",{className:"pf-u-pt-md status"},p().createElement(f,{name:"",status:t.status.state})),"deleting"===t.status.state&&p().createElement("div",{className:"pf-u-pt-md"},p().createElement(g.Alert,{variant:"danger",isInline:!0,isPlain:!0,title:e("namespaceDeleting")}))))),p().createElement(g.CardBody,null,p().createElement(g.DescriptionList,null,p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListTerm,null,e("owner")),p().createElement(g.DescriptionListDescription,null,t.owner)),p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListTerm,null,e("clusterId")),p().createElement(g.DescriptionListDescription,null,t.cluster_id)),p().createElement(g.DescriptionListGroup,null,p().createElement(g.DescriptionListTerm,null,e("created")),p().createElement(g.DescriptionListDescription,null,p().createElement("time",{title:e("{{date}}",{date:new Date(t.created_at)}),dateTime:new Date(t.created_at).toISOString()},e("{{ date, ago }}",{date:new Date(t.created_at)}))))))))))))}})(),p().createElement(mn,{isModalOpen:t,onModalToggle:S,refreshResponse:()=>{y()}}))},Cn=({onModalToggle:e,isEvalPresent:t})=>{const{request:n,onQuery:a}=Mt(),o=(0,u.useRef)(null),r=$t(a,1e3),c=p().createElement(p().Fragment,null,p().createElement(g.ToolbarItem,null,p().createElement(g.InputGroup,null,p().createElement(g.TextInput,{name:"textInput2",id:"textInput2",type:"search","aria-label":"search input example",onChange:e=>r({size:n.size,page:1,name:e}),ref:o}),p().createElement(g.Button,{variant:"control","aria-label":"search button for search input"},p().createElement(v.SearchIcon,null))))),i=p().createElement(p().Fragment,null,p().createElement(g.ToolbarToggleGroup,{toggleIcon:p().createElement(v.FilterIcon,null),breakpoint:"xl"},c),p().createElement(g.ToolbarGroup,{variant:"icon-button-group"},p().createElement(g.ToolbarItem,null,p().createElement(g.Button,{variant:"secondary",isDisabled:t,onClick:e},(0,qt.t)("registerEvalNamespace")))),p().createElement(g.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},p().createElement(hn,{isCompact:!0})));return p().createElement(g.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl"},p().createElement(g.ToolbarContent,null,i))},hn=({isCompact:e=!1})=>{const{request:t,response:n,onQuery:a}=Mt();return p().createElement(me,{itemCount:(null==n?void 0:n.total)||0,page:t.page,perPage:t.size,onChange:(e,t)=>a({page:e,size:t}),isCompact:e})},yn=()=>{const[e,t]=p().useState(!1),[n,a]=p().useState(!1),o=p().useRef(),r=p().useRef();const{configString:c}=Lt();const i=(e,t)=>t?e:function(e){const t=["secretKey","accessKey"];return JSON.stringify(e,((e,n)=>-1===t.indexOf(e)?n:"*".repeat(n.length)),2)}(JSON.parse(e)),l=(e,n)=>{((e,t)=>{const n=e.currentTarget.parentElement,a=document.createElement("textarea");a.value=t.toString(),n.appendChild(a),a.select(),document.execCommand("copy"),n.removeChild(a)})(e,n),t(!0)},s=p().createElement(p().Fragment,null,p().createElement(g.CodeBlockAction,null,p().createElement(g.Button,{variant:"plain",ref:r,"aria-label":"show hidden fields icon",onClick:()=>a(!n)},n?p().createElement(v.EyeSlashIcon,null):p().createElement(v.EyeIcon,null)),p().createElement(g.Tooltip,{content:p().createElement("div",null,n?"Hide service account":"Show service account"),reference:r})),p().createElement(g.CodeBlockAction,null,p().createElement(g.ClipboardCopyButton,{id:"copy-button",textId:"code-content","aria-label":"Copy to clipboard",onClick:e=>l(e,i(c,n)),exitDelay:600,maxWidth:"110px",variant:"plain"},e?"Successfully copied to clipboard!":"Copy to clipboard")),p().createElement(g.CodeBlockAction,null,p().createElement(g.Button,{variant:"plain",ref:o,"aria-label":"Download icon",onClick:e=>{return t=e,a=i(c,n),(0,A.__awaiter)(void 0,void 0,void 0,(function*(){const e=t.currentTarget.parentElement,n=new Blob([a],{type:"application/json"}),o=yield URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download="connectorConfig.json",e.appendChild(r),r.click(),e.removeChild(r)}));var t,a}},p().createElement(v.FileDownloadIcon,null)),p().createElement(g.Tooltip,{content:p().createElement("div",null,"Download JSON"),reference:o})));return p().createElement(g.CodeBlock,{actions:s},p().createElement(g.CodeBlockCode,{id:"code-content"},i(c,n)))};function bn(){var e;const{t}=(0,m.useTranslation)(),[n,a]=(0,u.useState)(!1),[o,r]=(0,u.useState)({clientId:!0,clientSecret:!0,accessKey:!0,secretKey:!0}),i=e=>{let t=Object.assign({},o);switch(e.currentTarget.id){case"clientId":t.clientId=!o.clientId,r(t);break;case"clientSecret":t.clientSecret=!o.clientSecret,r(t);break;case"accessKey":t.accessKey=!o.accessKey,r(t);break;case"secretKey":t.secretKey=!o.secretKey,r(t)}},{kafka:l,namespace:s,connectorType:d,name:f,topic:E,userErrorHandler:C,userServiceAccount:h,configString:y,savingError:b}=Lt(),S=(0,u.useCallback)((()=>a((e=>!e))),[]),T=JSON.parse(y),k=JSON.parse(y).connector,I=JSON.parse(y).kafka,x=c().mapKeys(T,((e,t)=>t.replace(/\./g,"_")));try{delete x.error_handler}catch(e){}const A=e=>"*".repeat(e.length);return p().createElement(Rt,{title:t("review"),description:t(n?"reviewJSONStepDescription":"reviewStepDescription"),component:p().createElement(g.Switch,{id:"toggle-json-view",label:t("viewJSONFormat"),labelOff:t("viewJSONFormat"),isChecked:n,onChange:S})},p().createElement(g.Form,null,b&&p().createElement(g.FormAlert,null,p().createElement(g.Alert,{variant:"danger",title:b,"aria-live":"polite",isInline:!0})),n?p().createElement(yn,null):p().createElement(p().Fragment,null,p().createElement(g.Grid,null,p().createElement(g.GridItem,{span:4},p().createElement("strong",null,t("connectorCategory"))),p().createElement(g.GridItem,{span:8},d.description)),p().createElement(g.Grid,null,p().createElement(g.GridItem,{span:4},p().createElement("strong",null,t("kafkaInstance"))),p().createElement(g.GridItem,{span:8},l.name)),p().createElement(g.Grid,null,p().createElement(g.GridItem,{span:4},p().createElement("strong",null,t("namespace"))),p().createElement(g.GridItem,{span:8},s.name)),p().createElement(g.Title,{headingLevel:"h3",size:g.TitleSizes["2xl"]},t("basic")),p().createElement(g.Grid,null,p().createElement(g.GridItem,{span:4},p().createElement("strong",null,t("connectorName"))),p().createElement(g.GridItem,{span:8},f)),p().createElement(g.Grid,null,p().createElement(g.GridItem,{span:4},p().createElement("strong",null,t("type"))),p().createElement(g.GridItem,{span:8},null===(e=d.labels)||void 0===e?void 0:e.map((e=>e)))),(null==h?void 0:h.clientId)&&p().createElement(g.Grid,null,p().createElement(g.GridItem,{span:4},p().createElement("strong",null,t("clientId"))),p().createElement(g.GridItem,{span:8},p().createElement(g.Flex,null,p().createElement(g.FlexItem,null,o.clientId?A(null==h?void 0:h.clientId):null==h?void 0:h.clientId),p().createElement(g.FlexItem,{onClick:i,id:"clientId"},o.clientId?p().createElement(v.EyeIcon,null):p().createElement(v.EyeSlashIcon,null))))),(null==h?void 0:h.clientSecret)&&p().createElement(g.Grid,null,p().createElement(g.GridItem,{span:4},p().createElement("strong",null,t("clientSecret"))),p().createElement(g.GridItem,{span:8},p().createElement(g.Flex,null,p().createElement(g.FlexItem,null,o.clientSecret?A(null==h?void 0:h.clientSecret):null==h?void 0:h.clientSecret),p().createElement(g.FlexItem,{onClick:i,id:"clientSecret"},o.clientSecret?p().createElement(v.EyeIcon,null):p().createElement(v.EyeSlashIcon,null))))),p().createElement(g.Title,{headingLevel:"h3",size:g.TitleSizes["2xl"]},t("connectorSpecific")),k&&Object.keys(k).map((e=>p().createElement(g.Grid,{key:e},p().createElement(g.GridItem,{span:4},p().createElement("strong",null,c().startCase(e))),p().createElement(g.GridItem,{span:8},c().startCase(e)===t("accessKey")||c().startCase(e)===t("secretKey")?p().createElement(g.Flex,null,p().createElement(g.FlexItem,null,o[e]?A(k[e]):k[e]),p().createElement(g.FlexItem,{onClick:i,id:e},o[e]?p().createElement(v.EyeIcon,null):p().createElement(v.EyeSlashIcon,null))):k[e])))),I&&Object.keys(I).map((e=>p().createElement(g.Grid,{key:e},p().createElement(g.GridItem,{span:4},p().createElement("strong",null,c().startCase(e))),p().createElement(g.GridItem,{span:8},I[e])))),void 0===k&&Object.keys(x).map((e=>p().createElement(g.Grid,{key:e},p().createElement(g.GridItem,{span:4},p().createElement("strong",null,c().startCase(e))),p().createElement(g.GridItem,{span:8},c().startCase(e)===t("databasePassword")||c().startCase(e)===t("password")?A(x[e]):"object"==typeof x[e]?"data_shape"===e?p().createElement(Sn,{data:x[e]}):JSON.stringify(x[e]):x[e])))),C&&p().createElement(p().Fragment,null,p().createElement(g.Title,{headingLevel:"h3",size:g.TitleSizes["2xl"]},t("errorHandling")),p().createElement(g.Grid,null,p().createElement(g.GridItem,{span:4},p().createElement("strong",null,t("errorHandling"))),p().createElement(g.GridItem,{span:8},C)),E&&p().createElement(g.Grid,null,p().createElement(g.GridItem,{span:4},p().createElement("strong",null,t("topic"))),p().createElement(g.GridItem,{span:8},E))))))}const Sn=({data:e})=>p().createElement(p().Fragment,null,Object.keys(e).map((t=>p().createElement(g.Grid,{key:t},p().createElement(g.GridItem,{span:2},p().createElement("strong",null,c().startCase(t),":")),p().createElement(g.GridItem,{span:10},"string"==typeof e[t]?e[t]:e[t].format)))));const Tn=({onClose:e})=>{const{t}=(0,m.useTranslation)(),n=Bt(),[a,o]=(0,he.useActor)(n);let{hasCustomConfigurator:r,activeStep:c,configureSteps:i}=(0,he.useSelector)(n,(0,u.useCallback)((e=>({isLoading:e.matches({configureConnector:"loadConfigurator"}),hasErrors:e.matches("failure"),hasCustomConfigurator:!1!==e.context.Configurator&&void 0!==e.context.Configurator,activeStep:e.context.activeConfigurationStep,configuration:e.context.connectorConfiguration,configureSteps:e.context.configurationSteps,Configurator:e.context.Configurator,configuratorRef:e.children.configuratorRef})),[n]));const l=function(){const{t:e}=(0,m.useTranslation)(),t=Bt(),{isActive:n,canJumpTo:a,enableNext:o}=(0,he.useSelector)(t,(0,u.useCallback)((e=>({isActive:e.matches("selectKafka"),canJumpTo:Dt.transition(e,"jumpToSelectKafka").changed||e.matches("selectKafka"),enableNext:Dt.transition(e,"next").changed})),[t]));return{name:e("kafkaInstance"),isActive:n,component:p().createElement(N,null,p().createElement(tn,null)),canJumpTo:a,enableNext:o}}(),s=function(){const{t:e}=(0,m.useTranslation)(),t=Bt(),{isActive:n,canJumpTo:a,enableNext:o}=(0,he.useSelector)(t,(0,u.useCallback)((e=>({isActive:e.matches("basicConfiguration"),canJumpTo:Dt.transition(e,"jumpToBasicConfiguration").changed||e.matches("basicConfiguration"),enableNext:Dt.transition(e,"next").changed,activeStep:e.context.activeConfigurationStep})),[t]));return{name:e("common"),isActive:n,component:p().createElement(N,null,p().createElement(zt,null)),canJumpTo:a,enableNext:o}}(),d=function(){const{t:e}=(0,m.useTranslation)(),t=Bt(),{isActive:n,canJumpTo:a,enableNext:o}=(0,he.useSelector)(t,(0,u.useCallback)((e=>({isActive:e.matches("configureConnector"),canJumpTo:Dt.transition(e,"jumpToConfigureConnector").changed||e.matches("configureConnector"),enableNext:Dt.transition(e,"next").changed})),[t]));return{name:e("connectorSpecific"),isActive:n,component:p().createElement(N,null,p().createElement(Ht,null)),canJumpTo:a,enableNext:o}}(),g=function(){const{t:e}=(0,m.useTranslation)(),t=Bt(),{isActive:n,canJumpTo:a,enableNext:o}=(0,he.useSelector)(t,(0,u.useCallback)((e=>({isActive:e.matches("errorConfiguration"),canJumpTo:Dt.transition(e,"jumpToErrorConfiguration").changed||e.matches("errorConfiguration"),enableNext:Dt.transition(e,"next").changed,activeStep:e.context.activeConfigurationStep})),[t]));return{name:e("errorHandling"),isActive:n,component:p().createElement(N,null,p().createElement(Xt,null)),canJumpTo:a,enableNext:o}}();if("saved"===a.value)return null;const v=e=>Dt.transition(a,{type:"jumpToConfigureConnector",subStep:e}).changed,f=[{name:t("connector"),isActive:a.matches("selectConnector"),component:p().createElement(N,null,p().createElement(Ut,null)),canJumpTo:Dt.transition(a,"jumpToSelectConnector").changed||a.matches("selectConnector"),enableNext:Dt.transition(a,"next").changed},l,{name:t("namespace"),isActive:a.matches("selectNamespace"),component:p().createElement(N,null,p().createElement(vn,null)),canJumpTo:Dt.transition(a,"jumpToSelectNamespace").changed||a.matches("selectNamespace"),enableNext:Dt.transition(a,"next").changed},{name:t("configurations"),isActive:a.matches("basicConfiguration"),canJumpTo:Dt.transition(a,"jumpToBasicConfiguration").changed||a.matches("basicConfiguration"),steps:(()=>{let e=[s];return r&&void 0!==i&&i&&i.map(((t,n)=>{e.push({name:t,isActive:a.matches("configureConnector")&&c===n,component:p().createElement(N,null,p().createElement(Ht,null)),canJumpTo:v(n+1),enableNext:Dt.transition(a,"next").changed})})),(!r&&void 0===i||!1===i)&&(e.push(d),e.push(g)),e})()},{name:t("review"),isActive:a.matches("reviewConfiguration"),component:p().createElement(N,null,p().createElement(bn,null)),canJumpTo:Dt.transition(a,"jumpToReviewConfiguration").changed||a.matches("reviewConfiguration"),enableNext:Dt.transition(a,"next").changed,nextButtonText:t("createConnector")}],E=Ve(f),C=E.reduceRight(((e,t,n)=>t.isActive&&n>e?n:e),-1)+1;return p().createElement(He,{className:"cos",steps:f,currentStep:C,onNext:()=>o("next"),onBack:()=>o("prev"),onClose:e,onSave:()=>!1,goToStep:e=>{switch(e){case 1:o("jumpToSelectConnector");break;case 2:o("jumpToSelectKafka");break;case 3:o("jumpToSelectNamespace");break;case 4:o("jumpToBasicConfiguration");break;case 5:o("jumpToConfigureConnector");break;case 6:o("jumpToErrorConfiguration");break;case E.length:o("jumpToReviewConfiguration");break;default:e<E.length&&o({type:"jumpToConfigureConnector",subStep:e-6})}},goToStepById:(...e)=>console.log("goToStepById",e),goToStepByName:(...e)=>console.log("goToStepByName",e),hasNoBodyPadding:!0})},kn=({onSave:e,onClose:t})=>{const{t:n}=(0,m.useTranslation)(),a=(0,x.useConfig)(),o=(0,x.useBasename)(),{connectorsApiBasePath:r,getToken:c}=k(),[i,l]=(0,u.useState)(!1),s=()=>l(!1);return p().createElement(p().Fragment,null,p().createElement(g.PageSection,{variant:"light",hasShadowBottom:!0},p().createElement(g.Breadcrumb,null,p().createElement(g.BreadcrumbItem,{to:null==o?void 0:o.getBasename()},n("connectorsInstances")),p().createElement(g.BreadcrumbItem,{isActive:!0},n("createAConnectorsInstance"))),p().createElement(g.Level,{className:"pf-u-pt-md pf-u-pb-md"},p().createElement(g.Title,{headingLevel:"h1"},n("createAConnectorsInstance")))),p().createElement(g.PageSection,{padding:{default:"noPadding"},style:{zIndex:0},type:"wizard"},p().createElement(wt,{accessToken:c,connectorsApiBasePath:r,fetchConfigurator:e=>w(e,(null==a?void 0:a.cos.configurators)||{}),onSave:e},p().createElement(Tn,{onClose:()=>l(!0)}),p().createElement(g.Modal,{title:n("Leave page?"),variant:"small",isOpen:i,onClose:s,actions:[p().createElement(g.Button,{key:"confirm",variant:"primary",onClick:t},"Confirm"),p().createElement(g.Button,{key:"cancel",variant:"link",onClick:s},"Cancel")]},n("leaveCreateConnectorConfirmModalDescription")))))},In=({onSave:e,onClose:t})=>{const{t:n}=(0,m.useTranslation)(),a=(0,x.useAlert)(),o=(0,x.useConfig)(),r=(0,x.useBasename)(),{connectorsApiBasePath:c,getToken:i}=k(),[l,v]=(0,u.useState)(!1),f=()=>v(!1),[E,C]=(0,u.useState)(),{hash:y}=(0,I.useLocation)(),b=y.split("&")[0].substring(1),[S,T]=(0,u.useState)(),A=(0,u.useCallback)((e=>{C(e)}),[]),[P,D]=(0,u.useState)(),N=(0,u.useCallback)((e=>{null==a||a.addAlert({id:"connectors-table-error",variant:x.AlertVariant.danger,title:n("somethingWentWrong"),description:e})}),[a,n]),B=(0,u.useCallback)((e=>{D(e)}),[]);return(0,u.useEffect)((()=>{void 0!==b&&T(!0)}),[b]),(0,u.useEffect)((()=>{s({accessToken:i,connectorsApiBasePath:c,connectorId:b})(A,N)}),[b]),(0,u.useEffect)((()=>{(null==E?void 0:E.connector_type_id)&&d({accessToken:i,connectorsApiBasePath:c,connectorTypeId:null==E?void 0:E.connector_type_id})(B)}),[E]),p().createElement(p().Fragment,null,p().createElement(g.PageSection,{variant:"light",hasShadowBottom:!0},p().createElement(g.Breadcrumb,null,p().createElement(g.BreadcrumbItem,{to:null==r?void 0:r.getBasename()},n("connectorsInstances")),p().createElement(g.BreadcrumbItem,{isActive:!0},n("duplicateConnector"))),p().createElement(g.Level,{className:"pf-u-pt-md pf-u-pb-md"},p().createElement(g.Title,{headingLevel:"h1"},n("duplicateConnector")))),p().createElement(g.PageSection,{padding:{default:"noPadding"},style:{zIndex:0},type:"wizard"},E&&P?p().createElement(wt,{accessToken:i,connectorsApiBasePath:c,fetchConfigurator:e=>w(e,(null==o?void 0:o.cos.configurators)||{}),connectorId:b,connectorData:E,connectorTypeDetails:P,duplicateMode:S,onSave:e},p().createElement(Tn,{onClose:()=>v(!0)}),p().createElement(g.Modal,{title:n("Leave page?"),variant:"small",isOpen:l,onClose:f,actions:[p().createElement(g.Button,{key:"confirm",variant:"primary",onClick:t},"Confirm"),p().createElement(g.Button,{key:"cancel",variant:"link",onClick:f},"Cancel")]},n("leaveDuplicateConnectorConfirmModalDescription"))):p().createElement(h.g,null)))},xn=({getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n})=>{const{t:a}=(0,m.useTranslation)(),o=(0,x.useAlert)(),r=(0,I.useHistory)(),c=(0,u.useCallback)((()=>r.push("/")),[r]),i=(0,u.useCallback)((()=>r.push("/create-connector")),[r]),l=(0,u.useCallback)(((e,t)=>r.push({pathname:`/${e}`,hash:`#${t}`})),[r]),s=(0,u.useCallback)((e=>r.push({pathname:"/duplicate-connector",hash:`#${e}`})),[r]),d=(0,u.useCallback)((e=>{null==o||o.addAlert({id:"connector-created",variant:x.AlertVariant.success,title:a("creationSuccessAlertTitle"),description:a("creationSuccessAlertDescription",{name:e})}),c()}),[o,c,a]);return p().createElement(T,{getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n},p().createElement(I.Switch,null,p().createElement(I.Route,{path:"/",exact:!0},p().createElement(je,{onCreateConnector:i,onConnectorDetail:l,onDuplicateConnector:s})),p().createElement(I.Route,{path:"/create-connector"},p().createElement(kn,{onSave:d,onClose:c})),p().createElement(I.Route,{path:"/duplicate-connector"},p().createElement(In,{onSave:d,onClose:c})),p().createElement(I.Route,{path:"/:id/"},p().createElement(re,{onSave:c}))))}},91031:(e,t,n)=>{n.d(t,{g:()=>c});var a=n(75418),o=n.n(a),r=n(21012);const c=()=>o().createElement(r.EmptyState,null,o().createElement(r.EmptyStateIcon,{variant:"container",component:r.Spinner}),o().createElement(r.Title,{size:"lg",headingLevel:"h4"},"Loading"))},78800:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(59093),o=n(4958),r=n(2899),c=n.n(r),i=n(16486),l=n.n(i),s=n(73337),d=n.n(s),u=n(31521);const p={en:o.Z};c().use(d()).use(l()).use(u.initReactI18next).init({backend:{loadPath:`${n.p}locales/{{lng}}/{{ns}}.json`},fallbackLng:"en",load:"all",debug:!0,ns:["public"],defaultNS:"public",nsSeparator:":",keySeparator:".",interpolation:{defaultVariables:void 0,escapeValue:!1,format:(e,t,n)=>{if((0,a.isDate)(e)&&t){const r=n?p[n]:o.Z;return"short"===t?(0,a.format)(e,"P",{locale:r}):"long"===t?(0,a.format)(e,"PPPP",{locale:r}):"relative"===t?(0,a.formatRelative)(e,new Date,{locale:r}):"ago"===t?(0,a.formatDistance)(e,new Date,{locale:r,addSuffix:!0}):(0,a.format)(e,t,{locale:r})}return e}}});const m=c()}}]);
//# sourceMappingURL=1621.71c1a5c1.js.map
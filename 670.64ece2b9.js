"use strict";(self.webpackChunkcos_ui=self.webpackChunkcos_ui||[]).push([[670],{79846:(e,t,n)=>{n.d(t,{e:()=>Kt});var a=n(75418),o=n.n(a),r=n(31521),c=n(21012),i=n(91999);const s=({name:e,status:t})=>{const n=function(e){var t;const{t:n}=(0,r.useTranslation)(),a=[{value:u.Ready,label:n("Running")},{value:u.Failed,label:n("Failed")},{value:u.Assigning,label:n("Creation pending")},{value:u.Assigned,label:n("Creation in progress")},{value:u.Updating,label:n("Creation in progress")},{value:u.Provisioning,label:n("Creation in progress")},{value:u.Deleting,label:n("Deleting")},{value:u.Deleted,label:n("Deleted")}];return(null===(t=a.find((t=>t.value===e)))||void 0===t?void 0:t.label)||e}(t);return o().createElement(c.Flex,null,o().createElement(c.FlexItem,{spacer:{default:"spacerSm"}},o().createElement(l,{name:e,status:t})),o().createElement(c.FlexItem,null,n))},l=({name:e,status:t})=>{switch(null==t?void 0:t.toLowerCase()){case"ready":return o().createElement(i.CheckCircleIcon,{className:"cos--connectors__table--icon--completed"});case"failed":return o().createElement(i.ExclamationCircleIcon,{className:"cos--connectors__table--icon--failed"});case"accepted":return o().createElement(i.PendingIcon,null);case"provisioning":case"preparing":return o().createElement(c.Spinner,{size:"md","aria-label":e,"aria-valuetext":"Creation in progress"});case"deprovision":case"deleted":return null}return o().createElement(i.PendingIcon,null)};var u;!function(e){e.Ready="ready",e.Failed="failed",e.Assigning="assigning",e.Assigned="assigned",e.Updating="updating",e.Provisioning="provisioning",e.Deleting="deleting",e.Deleted="deleted"}(u||(u={}));const d=({children:e,connector:t,onClose:n})=>{var a;return o().createElement(c.Drawer,{isExpanded:void 0!==t},o().createElement(c.DrawerContent,{panelContent:t?o().createElement(p,{name:t.name,bootstrapServer:t.kafka.url,kafkaId:t.kafka.id,owner:t.owner,cluster:t.deployment_location.cluster_id,createdAt:new Date(t.created_at),modifiedAt:new Date(t.modified_at),status:null===(a=t.status)||void 0===a?void 0:a.state,onClose:n}):void 0},e))},p=({name:e,bootstrapServer:t,kafkaId:n,owner:i,cluster:l,createdAt:u,modifiedAt:d,status:p,onClose:m})=>{const{t:g}=(0,r.useTranslation)(),[v,f]=(0,a.useState)(0),C=(e,t)=>o().createElement(o().Fragment,null,t&&o().createElement(o().Fragment,null,o().createElement(c.TextListItem,{component:c.TextListItemVariants.dt},e),o().createElement(c.TextListItem,{component:c.TextListItemVariants.dd},t)));return o().createElement(c.DrawerPanelContent,{widths:{default:"width_50"}},o().createElement(c.DrawerHead,null,o().createElement(c.TextContent,null,o().createElement(c.Text,{component:c.TextVariants.small,className:"connector-drawer__header-text"},"Connector name"),o().createElement(c.Flex,null,o().createElement(c.FlexItem,null,o().createElement(c.Title,{headingLevel:"h2",size:c.TitleSizes.xl,className:"connector-drawer__header-title"},e)),o().createElement(c.FlexItem,{spacer:{default:"spacerSm"}},o().createElement(s,{name:e,status:p})))),o().createElement(c.DrawerActions,null,o().createElement(c.DrawerCloseButton,{onClick:m}))),o().createElement(c.DrawerPanelBody,null,o().createElement(c.Tabs,{activeKey:v,onSelect:(e,t)=>{f(t)}},o().createElement(c.Tab,{eventKey:0,title:o().createElement(c.TabTitleText,null,g("Details"))},o().createElement("div",{className:"connector-drawer__tab-content"},o().createElement(c.TextContent,null,o().createElement(c.TextList,{component:c.TextListVariants.dl},C("Bootstrap server",t),C("Connector",e),C("Kafka_instance",n),C("Targeted OSD Cluster",l),C("Owner",i),C("Time created",o().createElement("time",{title:g("{{date}}",{date:u}),dateTime:u.toISOString()},g("{{ date, ago }}",{date:u}))),C("Time updated",o().createElement("time",{title:g("{{date}}",{date:d}),dateTime:d.toISOString()},g("{{ date, ago }}",{date:d}))))))))))};var m=n(55706),g=n(86445);const v=({children:e})=>{const{t}=(0,r.useTranslation)();return o().createElement(g.TableComposable,{"aria-label":"Sortable Table",className:(0,m.css)("connectors-table-view__table")},o().createElement(g.Thead,null,o().createElement(g.Tr,null,o().createElement(g.Th,null,t("Name")),o().createElement(g.Th,null,t("Connector")),o().createElement(g.Th,null,t("Status")))),o().createElement(g.Tbody,null,e))},f=({connectorId:e,name:t,type:n,status:a,isSelected:c,canStart:i,canStop:l,canDelete:u,onStart:d,onStop:p,onDelete:v,onSelect:f})=>{const{t:C}=(0,r.useTranslation)(),E=[{title:"Start",onClick:d,isDisabled:!i},{title:"Stop",onClick:p,isDisabled:!l},{title:"Delete",onClick:v,isDisabled:!u},{isSeparator:!0},{title:"Details",onClick:f}];return o().createElement(g.Tr,{onClick:e=>{var t;"button"!==(null===(t=e.target)||void 0===t?void 0:t.type)&&f()},className:(0,m.css)("pf-c-table-row__item","pf-m-selectable",c&&"pf-m-selected")},o().createElement(g.Td,{dataLabel:C("Name")},t),o().createElement(g.Td,{dataLabel:C("Type")},n),o().createElement(g.Td,{dataLabel:C("Status")},o().createElement(s,{name:t,status:a})),o().createElement(g.Td,{actions:{items:E},"data-testid":`actions-for-${e}`}))},C=({itemCount:e,page:t,perPage:n,isCompact:a=!1,onChange:r})=>o().createElement(c.Pagination,{itemCount:e,page:t,perPage:n,perPageOptions:[{title:"1",value:1},{title:"5",value:5},{title:"10",value:10}],onSetPage:(e,t)=>r(t,n),onPerPageSelect:(e,n)=>r(t,n),variant:a?"top":"bottom",isCompact:a});var E=n(98068),h=n(3889),y=n.n(h);const S=(e,t=200)=>{if(isNaN(t))throw new TypeError("durationInMs for debounce should be a number");if("function"!=typeof e)throw new TypeError("fnToDebounce should be a function");return(0,a.useCallback)(y()(e,t),[e,t])},b=({itemCount:e,page:t,perPage:n,onChange:s})=>{const{t:l}=(0,r.useTranslation)(),u=(0,a.useRef)(null),d=S(s,1e3),p=o().createElement(o().Fragment,null,o().createElement(c.ToolbarItem,null,o().createElement(c.InputGroup,null,o().createElement(c.TextInput,{name:"name",id:"name",type:"search","aria-label":"filter by connector name",onChange:e=>d({size:n,page:1,name:e}),ref:u}),o().createElement(c.Button,{variant:"control","aria-label":"search button for search input"},o().createElement(i.SearchIcon,null))))),m=o().createElement(o().Fragment,null,o().createElement(c.ToolbarToggleGroup,{toggleIcon:o().createElement(i.FilterIcon,null),breakpoint:"xl"},p),o().createElement(c.ToolbarGroup,{variant:"icon-button-group"},o().createElement(c.ToolbarItem,null,o().createElement(E.NavLink,{className:"pf-c-button pf-m-primary",to:"/create-connector"},l("createConnectorInstance")))),o().createElement(c.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},o().createElement(C,{itemCount:e,page:t,perPage:n,onChange:s,isCompact:!0})));return o().createElement(c.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl"},o().createElement(c.ToolbarContent,null,m))},k=({connectorName:e,onCancel:t,onConfirm:n,showDialog:i})=>{const{t:s}=(0,r.useTranslation)(),[l,u]=(0,a.useState)(""),d=l===e;return o().createElement(c.Modal,{variant:c.ModalVariant.small,title:s("Delete connector"),titleIconVariant:"warning",isOpen:i,onClose:t,actions:[o().createElement(c.Button,{key:"confirm",variant:"danger",isDisabled:!d,onClick:()=>{u(""),n()}},s("Delete")),o().createElement(c.Button,{key:"cancel",variant:"link",onClick:()=>{u(""),t()}},s("Cancel"))]},o().createElement(c.Stack,null,o().createElement(c.StackItem,null,o().createElement(r.Trans,null,"Connector ",o().createElement("strong",null,{connectorName:e})," will be deleted.")),o().createElement(c.StackItem,null,o().createElement(r.Trans,null,"Type ",o().createElement("strong",null,{connectorName:e})," to confirm the deletion.")),o().createElement(c.StackItem,null,o().createElement(c.TextInput,{value:l,type:"text",onChange:u,"aria-label":"name input"}))))},T=()=>{const{t:e}=(0,r.useTranslation)();return o().createElement(c.EmptyState,{variant:c.EmptyStateVariant.full},o().createElement(c.EmptyStateIcon,{icon:i.ExclamationCircleIcon}),o().createElement(c.Title,{headingLevel:"h1",size:c.TitleSizes.lg},e("Something went wrong")),o().createElement(c.EmptyStateBody,null,e("There was a problem processing the request. Please try again.")))};var I=n(34558);const x=({onHelp:e,onCreate:t})=>{const{t:n}=(0,r.useTranslation)();return o().createElement(c.EmptyState,{variant:c.EmptyStateVariant.xl,className:(0,m.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},o().createElement(c.EmptyStateIcon,{icon:I.ZP}),o().createElement(c.Title,{headingLevel:"h1",size:c.TitleSizes["4xl"]},n("Welcome to Managed Connectors")),o().createElement(c.EmptyStateBody,null,o().createElement(r.Trans,null,"For help getting started, access the"," ",o().createElement(c.Button,{variant:c.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:e},"quick start guide."))),o().createElement(c.Button,{variant:"primary",onClick:t},n("Create Connector")))},P=({onClear:e})=>{const{t}=(0,r.useTranslation)();return o().createElement(c.EmptyState,{variant:c.EmptyStateVariant.large,className:(0,m.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},o().createElement(c.EmptyStateIcon,{icon:i.SearchIcon}),o().createElement(c.Title,{headingLevel:"h2",size:c.TitleSizes.xl},t("No results found")),o().createElement(c.EmptyStateBody,null,o().createElement(r.Trans,null,"No results match the filter criteria."," ",o().createElement(c.Button,{variant:c.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:e},t("Clear all filters"))," ","to show results.")))};var w=n(91031),A=n(70655),B=n(35898),O=n.n(B),N=n(58550),D=n(10343);const j=({accessToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n,kafka:a,cluster:o,connectorType:r,configuration:c,name:i,userServiceAccount:s})=>{const l=new N.ConnectorsApi(new N.Configuration({accessToken:e,basePath:t})),u=new D.SecurityApi(new N.Configuration({accessToken:e,basePath:n}));return e=>{const t=O().CancelToken.source();return(e=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){var t;if(s)return Promise.resolve(s);const n=yield u.createServiceAccount({name:`connector-${null===(t=r.id)||void 0===t?void 0:t.replaceAll(/[_\.]/g,"-")}-${Date.now()}`},{cancelToken:e.token});return{clientId:n.data.client_id,clientSecret:n.data.client_secret}})))(t).then((({clientId:n,clientSecret:s})=>{const u={kind:"Connector",name:i,channel:N.Channel.Stable,deployment_location:{kind:"addon",cluster_id:o.id},desired_state:N.ConnectorDesiredState.Ready,connector_type_id:r.id,kafka:{id:a.id,url:a.bootstrap_server_host||"demo"},service_account:{client_id:n,client_secret:s},connector:c};l.createConnector(true,u,{cancelToken:t.token}).then((()=>{e({type:"success"})})).catch((t=>{O().isCancel(t)||e({type:"failure",message:t.response.data.reason})}))})),()=>{t.cancel("Operation canceled by the user.")}}};var q=n(38801),R=n(41428),F=n(66310);const L=(0,F.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",connector:{}},{events:{"connector.start":()=>({}),"connector.stop":()=>({}),"connector.remove":()=>({}),"connector.select":()=>({}),"connector.actionSuccess":e=>e,"connector.actionError":e=>e},actions:{notifySuccess:()=>({}),notifyError:()=>({}),notifySelect:({connector:e})=>({connector:e})}}),z=L.assign(((e,t)=>({connector:t.connector})),"connector.actionSuccess"),_=L.createMachine({id:"connector",initial:"verify",context:L.initialContext,states:{verify:{always:[{target:"ready",cond:"isReady"},{target:"stopped",cond:"isStopped"},{target:"deleted",cond:"isDeleted"}]},ready:{on:{"connector.stop":"stoppingConnector","connector.remove":"deletingConnector"}},stopped:{on:{"connector.start":"startingConnector","connector.remove":"deletingConnector"}},deleted:{},startingConnector:{invoke:{id:"startingConnectorCb",src:e=>(({accessToken:e,connectorsApiBasePath:t,connector:n})=>{const a=new N.ConnectorsApi(new N.Configuration({accessToken:e,basePath:t}));return e=>{const t=O().CancelToken.source();return a.patchConnector(n.id,{desired_state:N.ConnectorDesiredState.Ready},{cancelToken:t.token,headers:{"Content-type":"application/merge-patch+json"}}).then((t=>{e({type:"connector.actionSuccess",connector:t.data})})).catch((t=>{O().isCancel(t)||e({type:"connector.actionError",error:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:e.connector})},on:{"connector.actionSuccess":{target:"verify",actions:[z,"notifySuccess"]},"connector.actionError":{target:"verify",actions:"notifyError"}}},stoppingConnector:{invoke:{id:"stoppingConnectorCb",src:e=>(({accessToken:e,connectorsApiBasePath:t,connector:n})=>{const a=new N.ConnectorsApi(new N.Configuration({accessToken:e,basePath:t}));return e=>{const t=O().CancelToken.source();return a.patchConnector(n.id,{desired_state:N.ConnectorDesiredState.Stopped},{cancelToken:t.token,headers:{"Content-type":"application/merge-patch+json"}}).then((t=>{e({type:"connector.actionSuccess",connector:t.data})})).catch((t=>{O().isCancel(t)||e({type:"connector.actionError",error:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:e.connector})},on:{"connector.actionSuccess":{target:"verify",actions:["updateState","notifySuccess"]},"connector.actionError":{target:"verify",actions:"notifyError"}}},deletingConnector:{invoke:{id:"deletingConnectorCb",src:e=>(({accessToken:e,connectorsApiBasePath:t,connector:n})=>{const a=new N.ConnectorsApi(new N.Configuration({accessToken:e,basePath:t}));return e=>{const t=O().CancelToken.source();return a.deleteConnector(n.id,{cancelToken:t.token}).then((()=>{e({type:"connector.actionSuccess",connector:Object.assign(Object.assign({},n),{status:"deleting",desired_state:"deleted"})})})).catch((t=>{O().isCancel(t)||e({type:"connector.actionError",error:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:e.connector})},on:{"connector.actionSuccess":{target:"deleted",actions:["updateState","notifySuccess"]},"connector.actionError":{target:"verify",actions:"notifyError"}}}},on:{"connector.select":{actions:"notifySelect"}}},{guards:{isReady:e=>"ready"===e.connector.desired_state,isStopped:e=>"stopped"===e.connector.desired_state,isDeleted:e=>"deleted"===e.connector.desired_state},actions:{notifySuccess:(0,R.sendParent)("actionSuccess"),notifyError:(0,R.sendParent)("actionFailure"),notifySelect:(0,R.sendParent)((({connector:e})=>({type:"selectConnector",connector:e})))}}),G=(0,a.createContext)(null),V=({getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n,children:a})=>o().createElement(G.Provider,{value:{getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n}},a),M=()=>{const e=(0,a.useContext)(G);if(!e)throw new Error("useAppContext must be used inside an AppContextProvider");return Object.assign({},e)};var K=n(46332);const J="paginatedApi";var $=n(45764);function W(e,t,n){const a=(0,F.createModel)({request:{page:1,size:10},response:void 0,pollingEnabled:(null==n?void 0:n.pollingEnabled)||!1,onBeforeSetResponse:null==n?void 0:n.onBeforeSetResponse,dataTransformer:t},{events:Object.assign({},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e}),actions:{notifyReady:()=>({}),notifyLoading:()=>({}),notifySuccess:()=>({}),notifyError:()=>({}),forwardUnknownEventsToParent:()=>({})}}),o=a.assign(((e,t)=>{var n,a;return t.page!==e.request.page?{}:(e.onBeforeSetResponse&&e.onBeforeSetResponse(null===(n=e.response)||void 0===n?void 0:n.items),{response:{items:null===(a=t.items)||void 0===a?void 0:a.map((t=>e.dataTransformer(t))),total:t.total,error:void 0}})}),"api.setResponse"),r=a.assign((e=>{e.actor&&e.actor.stop&&e.actor.stop();return{actor:(0,$.spawn)(u(e))}})),c=a.assign(((e,t)=>{var n,a;return t.page!==e.request.page?{}:{response:{items:(null===(n=e.response)||void 0===n?void 0:n.items)||[],total:(null===(a=e.response)||void 0===a?void 0:a.total)||0,error:t.error}}}),"api.setError"),i=a.assign((e=>({request:Object.assign(Object.assign({},e.request),{page:e.request.page+1})})),"api.nextPage"),s=a.assign((e=>({request:Object.assign(Object.assign({},e.request),{page:e.request.page-1})})),"api.prevPage"),l=a.assign(((e,t)=>{const{page:n,size:a,query:o}=t;return{request:{page:n||e.request.page,size:a||e.request.size,query:o}}}),"api.query"),u=t=>n=>e(t.request,(e=>n(a.events["api.setResponse"](e))),(e=>n(a.events["api.setError"](e))));return a.createMachine({id:"paginatedApiMachine",context:a.initialContext,type:"parallel",states:{api:{initial:"idle",states:{idle:{entry:a.actions.notifyReady(),on:{"api.query":{target:"loading",actions:l}}},success:{always:[{target:"queryEmpty",cond:"isQueryEmpty"},{target:"queryResults",cond:"isQuerySuccesful"},{target:"empty",cond:"isTotalZero"},{target:"results"}]},queryEmpty:{tags:"queryEmpty",on:{"api.query":{target:"loading",actions:l},"api.prevPage":{target:"loading",actions:s,cond:"isNotFirstPage"},"api.refresh":{target:"loading"}}},queryResults:{tags:"queryResults",on:{"api.query":{target:"loading",actions:l},"api.nextPage":{target:"loading",actions:i,cond:"isNotLastPage"},"api.prevPage":{target:"loading",actions:s,cond:"isNotFirstPage"},"api.refresh":{target:"loading"}}},empty:{tags:"empty",on:{"api.query":{target:"loading",actions:l},"api.refresh":{target:"loading"}}},results:{tags:"results",on:{"api.query":{target:"loading",actions:l},"api.nextPage":{target:"loading",actions:i,cond:"isNotLastPage"},"api.prevPage":{target:"loading",actions:s,cond:"isNotFirstPage"},"api.refresh":{target:"loading"}}},error:{tags:"error",on:{"api.query":{target:"loading",actions:l},"api.refresh":{target:"loading"},"api.prevPage":{target:"loading",actions:s,cond:"isNotFirstPage"}}},loading:{tags:["loading"],entry:[a.actions.notifyLoading(),r],on:{"api.query":{target:"loading",actions:l},"api.setResponse":{target:"success",actions:[o,a.actions.notifySuccess()]},"api.setError":{target:"error",actions:[c,a.actions.notifyError()]}}}},on:{"*":{actions:"forwardUnknownEventsToParent"}}},polling:{entry:r,on:{"api.setResponse":{actions:o}},after:{INTERVAL:{cond:"isPollingEnabled",target:"polling"}}}}},{delays:{INTERVAL:5e3},actions:{notifyReady:(0,R.sendParent)({type:"api.ready"}),notifySuccess:(0,R.sendParent)((e=>Object.assign({type:"api.success"},e.response))),notifyError:(0,R.sendParent)((e=>{var t;return{type:"api.error",error:null===(t=e.response)||void 0===t?void 0:t.error}})),notifyLoading:(0,R.sendParent)((e=>Object.assign({type:"api.loading"},e.request))),forwardUnknownEventsToParent:(0,R.pure)(((e,t)=>!1===Object.keys(a.events).includes(t.type)?(0,R.sendParent)(((e,t,n)=>n._event.data)):[]))},guards:{isNotFirstPage:e=>void 0!==e.response&&e.request.page>1,isNotLastPage:e=>void 0!==e.response&&e.request.size>0&&e.request.page<Math.ceil(e.response.total/e.request.size),isTotalZero:e=>{var t;return 0===(null===(t=e.response)||void 0===t?void 0:t.total)},isQuerySuccesful:e=>{var t;return void 0!==e.request.query&&void 0!==e.response&&(null===(t=e.response)||void 0===t?void 0:t.total)>0},isQueryEmpty:e=>{var t;return void 0!==e.request.query&&void 0!==e.response&&0===(null===(t=e.response)||void 0===t?void 0:t.total)},isPollingEnabled:e=>e.pollingEnabled}})}const Q=e=>(0,q.useSelector)(e,(0,a.useCallback)((e=>({request:e.context.request,response:e.context.response,loading:e.hasTag("loading"),queryEmpty:e.hasTag("queryEmpty"),queryResults:e.hasTag("queryResults"),noResults:e.hasTag("empty"),results:e.hasTag("results"),error:e.hasTag("error"),firstRequest:void 0===e.context.response})),[e])),H=(0,F.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",selectedConnector:void 0},{events:Object.assign(Object.assign({},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e}),{selectConnector:e=>e,deselectConnector:()=>({})}),actions:{notifyError:()=>({})}}),U=H.assign(((e,t)=>({selectedConnector:t.connector})),"selectConnector"),Z=H.assign((e=>({selectedConnector:void 0})),"deselectConnector"),Y=H.createMachine({id:"connectors",initial:"root",context:H.initialContext,states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:J,src:e=>W((({accessToken:e,connectorsApiBasePath:t})=>{const n=new N.ConnectorsApi(new N.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const o=O().CancelToken.source(),{page:r,size:c}=e;return n.listConnectors(`${r}`,`${c}`,{cancelToken:o.token}).then((e=>{t({items:e.data.items||[],total:e.data.total,page:e.data.page,size:e.data.size})})).catch((t=>{O().isCancel(t)||a({error:t.message,page:e.page})})),()=>{o.cancel("Operation canceled by the user.")}}})(e),(t=>(0,$.spawn)((e=>_.withContext(e))({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:t}),`connector-${t.id}`)),{pollingEnabled:!0,onBeforeSetResponse:e=>{e&&e.forEach((e=>{e&&e.stop&&e.stop()}))}})},states:{idle:{on:{"api.ready":"ready"}},ready:{entry:(0,$.send)("api.query",{to:J})}},on:{"api.refresh":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.nextPage":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.prevPage":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.query":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.error":{actions:"notifyError"},selectConnector:{actions:U},deselectConnector:{actions:Z}}},listing:{}}}}},{actions:{notifyError:(e,t)=>{console.log(e,t),"api.error"===t.type&&e.onError&&e.onError(t.error)}}}),X=(0,a.createContext)(null),ee=({children:e,accessToken:t,connectorsApiBasePath:n,onError:a})=>{const r=(0,q.useInterpret)(Y,{context:{accessToken:t,connectorsApiBasePath:n,onError:a},devTools:!0});return o().createElement(X.Provider,{value:r},e)},te=()=>{const e=(0,a.useContext)(X);if(!e)throw new Error("useConnectorsMachineService() must be used in a child of <ConnectorsMachineProvider>");return e},ne=()=>{const e=te(),t=Q(e.state.children.paginatedApi),{selectedConnector:n}=(0,q.useSelector)(e,(0,a.useCallback)((e=>({selectedConnector:e.context.selectedConnector})),[e])),o=(0,a.useCallback)((()=>{e.send({type:"deselectConnector"})}),[e]),r=(0,a.useCallback)((t=>{e.send(Object.assign({type:"api.query"},t))}),[e]);return Object.assign(Object.assign({},t),{selectedConnector:n,deselectConnector:o,query:r})},ae=({onCreateConnector:e})=>{const{t}=(0,r.useTranslation)(),n=(0,K.useAlert)(),{connectorsApiBasePath:c,getToken:i}=M(),s=(0,a.useCallback)((e=>{null==n||n.addAlert({id:"connectors-table-error",variant:K.AlertVariant.danger,title:t("common.something_went_wrong"),description:e})}),[n,t]);return o().createElement(ee,{accessToken:i,connectorsApiBasePath:c,onError:s},o().createElement(oe,{onCreateConnector:e}))},oe=({onCreateConnector:e})=>(()=>{const e=te();return(0,q.useSelector)(e,(0,a.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?o().createElement(re,{onCreateConnector:e}):o().createElement(w.g,null),re=({onCreateConnector:e})=>{const{loading:t,error:n,noResults:a,queryEmpty:r,firstRequest:i,request:s,response:l,selectedConnector:u,deselectConnector:p,query:m}=ne();switch(!0){case i:return o().createElement(w.g,null);case r:return o().createElement(P,{onClear:()=>m({page:1,size:10})});case t:return o().createElement(o().Fragment,null,o().createElement(c.PageSection,{variant:"light"},o().createElement(ce,null)),o().createElement(c.PageSection,{padding:{default:"noPadding"},isFilled:!0},o().createElement(c.Card,null,o().createElement(b,{itemCount:(null==l?void 0:l.total)||0,page:s.page,perPage:s.size,onChange:(e,t)=>m({page:e,size:t})}),o().createElement(w.g,null))));case a:return o().createElement(x,{onCreate:e,onHelp:function(){throw new Error("Function not implemented.")}});case n:return o().createElement(T,null);default:return o().createElement(d,{connector:u,onClose:p},o().createElement(c.PageSection,{variant:"light"},o().createElement(ce,null)),o().createElement(c.PageSection,{padding:{default:"noPadding"},isFilled:!0},o().createElement(ie,null)))}},ce=()=>{const{t:e}=(0,r.useTranslation)();return o().createElement(c.TextContent,null,o().createElement(c.Title,{headingLevel:"h1"},e("Connectors")))},ie=()=>{var e;const{request:t,response:n,selectedConnector:a,query:r}=ne();return o().createElement(c.Card,{className:"pf-u-pb-xl"},o().createElement(b,{itemCount:(null==n?void 0:n.total)||0,page:t.page,perPage:t.size,onChange:(e,t)=>r({page:e,size:t})}),o().createElement("div",{className:"pf-u-p-md"},o().createElement(v,null,null===(e=null==n?void 0:n.items)||void 0===e?void 0:e.map((e=>o().createElement(se,{connectorRef:e,key:e.id,selectedConnector:a}))))),o().createElement(C,{itemCount:(null==n?void 0:n.total)||0,page:t.page,perPage:t.size,onChange:(e,t)=>r({page:e,size:t}),isCompact:!1}))},se=({connectorRef:e,selectedConnector:t})=>{var n;const{connector:r,canStart:c,canStop:i,canDelete:s,onStart:l,onStop:u,onDelete:d,onSelect:p}=(e=>{const{connector:t,canStart:n,canStop:o,canDelete:r}=(0,q.useSelector)(e,(0,a.useCallback)((e=>({connector:e.context.connector,canStart:!0===_.transition(e,"connector.start").changed,canStop:!0===_.transition(e,"connector.stop").changed,canDelete:!0===_.transition(e,"connector.remove").changed})),[e]));return{connector:t,canStart:n,canStop:o,canDelete:r,onStart:(0,a.useCallback)((()=>e.send({type:"connector.start"})),[e]),onStop:(0,a.useCallback)((()=>e.send({type:"connector.stop"})),[e]),onDelete:(0,a.useCallback)((()=>e.send({type:"connector.remove"})),[e]),onSelect:(0,a.useCallback)((()=>e.send({type:"connector.select"})),[e])}})(e),[m,g]=(0,a.useState)(!1);return o().createElement(o().Fragment,null,o().createElement(k,{connectorName:r.name,showDialog:m,onCancel:()=>{g(!1)},onConfirm:()=>{g(!1),d()}}),o().createElement(f,{connectorId:r.id,name:r.name,type:r.connector_type_id,category:"TODO: MISSING",status:null===(n=r.status)||void 0===n?void 0:n.state,isSelected:(null==t?void 0:t.id)===r.id,canStart:c,canStop:i,canDelete:s,onStart:l,onStop:u,onSelect:p,onDelete:()=>g(!0)}))};var le=n(98823);const ue=({error:e})=>o().createElement("div",{role:"alert"},o().createElement("p",null,"Something went wrong:"),o().createElement("pre",null,e.message)),de=({children:e})=>o().createElement(le.ErrorBoundary,{FallbackComponent:ue,resetKeys:[Date.now()]},e);var pe=n(64616);function me(e){const t=[];for(const n of e)if(n.steps)for(const e of n.steps)t.push(e);else t.push(n);return t}class ge extends a.Component{constructor(e){super(e),this.handleKeyClicks=e=>{e.keyCode===c.KEY_CODES.ESCAPE_KEY&&(this.state.isNavOpen?this.setState({isNavOpen:!this.state.isNavOpen}):this.props.isOpen&&this.props.onClose&&this.props.onClose())},this.getFlattenedSteps=()=>{const{steps:e}=this.props;return me(e)},this.getFlattenedStepsIndex=(e,t)=>{for(let n=0;n<e.length;n++)if(e[n].name===t)return n+1;return 0},this.initSteps=e=>{for(let t=0;t<e.length;t++){if(e[t].steps)for(let n=0;n<e[t].steps.length;n++)e[t].steps[n]=Object.assign({canJumpTo:!0},e[t].steps[n]);e[t]=Object.assign({canJumpTo:!0},e[t])}return e},this.getElement=e=>"function"==typeof e?e():e||document.body;const t=ge.currentId++;this.titleId=e.titleId||`pf-wizard-title-${t}`,this.descriptionId=e.descriptionId||`pf-wizard-description-${t}`,this.state={isNavOpen:!1}}componentDidMount(){const e="undefined"!=typeof document?document.body:null;e&&e.addEventListener("keydown",this.handleKeyClicks,!1)}componentWillUnmount(){const e="undefined"!=typeof document&&document.body||null;e&&e.removeEventListener("keydown",this.handleKeyClicks,!1)}render(){const e=this.props,{width:t,height:n,title:a,description:r,onClose:i,onSave:s,onBack:l,onNext:u,onGoToStep:d,goToStep:p,goToStepById:g,goToStepByName:v,className:f,steps:C,currentStep:E,nextButtonText:h="Next",backButtonText:y="Back",cancelButtonText:S="Cancel",hideClose:b,closeButtonAriaLabel:k="Close",navAriaLabel:T,navAriaLabelledBy:I,mainAriaLabel:x,mainAriaLabelledBy:P,hasNoBodyPadding:w,footer:B,appendTo:O,isOpen:N,titleId:D,descriptionId:j}=e,q=(0,A.__rest)(e,["width","height","title","description","onClose","onSave","onBack","onNext","onGoToStep","goToStep","goToStepById","goToStepByName","className","steps","currentStep","nextButtonText","backButtonText","cancelButtonText","hideClose","closeButtonAriaLabel","navAriaLabel","navAriaLabelledBy","mainAriaLabel","mainAriaLabelledBy","hasNoBodyPadding","footer","appendTo","isOpen","titleId","descriptionId"]),R=this.getFlattenedSteps(),F=R.length<E?R.length:E,L=R[F-1],z=this.initSteps(C),_=L===R[0],G=!L||void 0===L.enableNext||L.enableNext,V={goToStepById:g,goToStepByName:v,onNext:u,onBack:l,onClose:i,activeStep:L},M=Object.assign(Object.assign({},n?{height:n}:{}),t?{width:t}:{}),K=o().createElement(c.WizardContextProvider,{value:V},o().createElement("div",Object.assign({},q,{className:(0,m.css)(pe.Z.wizard,L&&L.isFinishedStep&&"pf-m-finished",f),style:Object.keys(M).length?M:void 0}),a&&o().createElement(c.WizardHeader,{titleId:this.titleId,descriptionId:this.descriptionId,onClose:i,title:a,description:r,closeButtonAriaLabel:k,hideClose:b}),o().createElement(c.WizardToggle,{mainAriaLabel:x,isInPage:void 0===N,mainAriaLabelledBy:(a||P)&&(P||this.titleId),isNavOpen:this.state.isNavOpen,onNavToggle:e=>this.setState({isNavOpen:e}),nav:e=>{const t={isOpen:e,"aria-label":T,"aria-labelledby":(a||I)&&(I||this.titleId)};return o().createElement(c.WizardNav,Object.assign({},t),z.map(((e,n)=>{if(e.isFinishedStep)return null;let a,r;if(e.steps){let i=!1,s=!1;for(const t of e.steps)L.name===t.name&&(i=!0),t.canJumpTo&&(s=!0);return r=this.getFlattenedStepsIndex(R,e.steps[0].name),o().createElement(c.WizardNavItem,{key:n,content:e.name,isCurrent:i,isDisabled:!s,step:r,onNavItemClick:p},o().createElement(c.WizardNav,Object.assign({},t,{returnList:!0}),e.steps.map(((e,t)=>e.isFinishedStep?null:(r=this.getFlattenedStepsIndex(R,e.name),a=e.canJumpTo,o().createElement(c.WizardNavItem,{key:`child_${t}`,content:e.name,isCurrent:L.name===e.name,isDisabled:!a,step:r,onNavItemClick:p}))))))}return r=this.getFlattenedStepsIndex(R,e.name),a=e.canJumpTo,o().createElement(c.WizardNavItem,Object.assign({},e.stepNavItemProps,{key:n,content:e.name,isCurrent:L.name===e.name,isDisabled:!a,step:r,onNavItemClick:p}))})))},steps:C,activeStep:L,hasNoBodyPadding:w},B||o().createElement("footer",{className:(0,m.css)(pe.Z.wizardFooter)},o().createElement(c.Button,{variant:c.ButtonVariant.primary,type:"submit",onClick:u,isDisabled:!G},L&&L.nextButtonText||h),!L.hideBackButton&&o().createElement(c.Button,{variant:c.ButtonVariant.secondary,onClick:l,className:(0,m.css)(_&&"pf-m-disabled")},y),!L.hideCancelButton&&o().createElement("div",{className:pe.Z.wizardFooterCancel},o().createElement(c.Button,{variant:c.ButtonVariant.link,onClick:i},S))))));return void 0!==N?o().createElement(c.Modal,{width:null!==t?t:void 0,isOpen:N,variant:c.ModalVariant.large,"aria-labelledby":this.titleId,"aria-describedby":this.descriptionId,showClose:!1,hasNoBodyWrapper:!0},K):K}}ge.displayName="Wizard",ge.currentId=0,ge.defaultProps={title:void 0,description:"",className:"",nextButtonText:"Next",backButtonText:"Back",cancelButtonText:"Cancel",hideClose:!1,closeButtonAriaLabel:"Close",navAriaLabel:void 0,navAriaLabelledBy:void 0,mainAriaLabel:void 0,mainAriaLabelledBy:void 0,hasNoBodyPadding:!1,onGoToStep:void 0,width:void 0,height:void 0,footer:void 0,appendTo:void 0,isOpen:void 0};const ve=(0,F.createModel)({name:""},{events:{setName:e=>e,setServiceAccount:e=>e,confirm:()=>({})}}),fe=ve.assign({name:(e,t)=>t.name},"setName"),Ce=ve.assign(((e,t)=>({userServiceAccount:t.serviceAccount})),"setServiceAccount"),Ee=ve.createMachine({id:"configureBasic",initial:"verify",states:{verify:{always:[{target:"valid",cond:"isBasicConfigured"},{target:"typing"}]},typing:{entry:(0,$.sendParent)("isInvalid"),on:{setName:{target:"verify",actions:fe},setServiceAccount:{target:"verify",actions:Ce}}},valid:{id:"valid",entry:(0,$.sendParent)("isValid"),on:{setName:{target:"verify",actions:fe},setServiceAccount:{target:"verify",actions:Ce},confirm:{target:"#done",cond:"isBasicConfigured"}}},done:{id:"done",type:"final",data:{name:e=>e.name,userServiceAccount:e=>e.userServiceAccount}}}},{guards:{isBasicConfigured:e=>void 0===e.userServiceAccount?void 0!==e.name&&e.name.length>0:void 0!==e.name&&e.name.length>0&&e.userServiceAccount.clientId.length>0&&e.userServiceAccount.clientSecret.length>0}}),he=(0,F.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",clusters:void 0,selectedCluster:void 0,error:void 0},{events:Object.assign({selectCluster:e=>Object.assign({},e),deselectCluster:()=>({}),confirm:()=>({})},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e})}),ye=he.assign(((e,t)=>{const{type:n}=t;return{response:(0,A.__rest)(t,["type"])}}),"api.success"),Se=he.assign({selectedCluster:(e,t)=>{var n,a;return null===(a=null===(n=e.response)||void 0===n?void 0:n.items)||void 0===a?void 0:a.find((e=>e.id===t.selectedCluster))}},"selectCluster"),be=he.assign({selectedCluster:void 0},"deselectCluster"),ke=he.createMachine({id:"clusters",initial:"root",context:he.initialContext,states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:J,src:e=>W((({accessToken:e,connectorsApiBasePath:t})=>{const n=new N.ConnectorClustersApi(new N.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const o=O().CancelToken.source(),{page:r,size:c}=e;return n.listConnectorClusters(`${r}`,`${c}`,{cancelToken:o.token}).then((e=>{t({items:e.data.items||[],total:e.data.total,page:e.data.page,size:e.data.size})})).catch((t=>{O().isCancel(t)||a({error:t.message,page:e.page})})),()=>{o.cancel("Operation canceled by the user.")}}})(e),(e=>e))},states:{idle:{entry:(0,$.send)("api.query",{to:J}),on:{"api.ready":"ready"}},ready:{}},on:{"api.refresh":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.nextPage":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.prevPage":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.query":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.success":{actions:ye}}},selection:{id:"selection",initial:"verify",states:{verify:{always:[{target:"selecting",cond:"noClusterSelected"},{target:"valid",cond:"clusterSelected"}]},selecting:{entry:(0,$.sendParent)("isInvalid"),on:{selectCluster:{target:"valid",actions:Se}}},valid:{entry:(0,$.sendParent)("isValid"),on:{selectCluster:{target:"verify",actions:Se,cond:(e,t)=>void 0!==t.selectedCluster},deselectCluster:{target:"verify",actions:be},confirm:{target:"#done",cond:"clusterSelected"}}}}}}},done:{id:"done",type:"final",data:{selectedCluster:e=>e.selectedCluster}}}},{guards:{clusterSelected:e=>void 0!==e.selectedCluster,noClusterSelected:e=>void 0===e.selectedCluster}}),Te=(0,F.createModel)({connector:{id:"something",name:"something",version:"0.1",schema:{}},steps:[],activeStep:0,isActiveStepValid:!1,configuration:void 0},{events:{entry:()=>({}),change:({configuration:e,isValid:t})=>({configuration:e,isValid:t}),next:()=>({}),prev:()=>({}),complete:()=>({})},actions:{changedStep:()=>({})}}),Ie=Te.assign((e=>({activeStep:Math.min(e.activeStep+1,e.steps.length-1),isActiveStepValid:!1})),"next"),xe=Te.assign((e=>({activeStep:Math.max(e.activeStep-1,0),isActiveStepValid:!1})),"prev"),Pe=Te.assign(((e,t)=>({configuration:t.configuration,isActiveStepValid:t.isValid})),"change"),we=Te.createMachine({id:"configurator",initial:"configuring",context:{connector:{id:"something",name:"something",version:"0.1",schema:{}},steps:["one","two","three"],activeStep:0,isActiveStepValid:!1,configuration:void 0},states:{configuring:{entry:(0,$.sendParent)("isInvalid"),always:[{target:"valid",cond:"activeStepValid"}]},valid:{id:"valid",initial:"determineStep",entry:(0,$.sendParent)("isValid"),states:{determineStep:{always:[{target:"#valid.lastStep",cond:"isLastStep"},{target:"#valid.hasNextStep"}]},hasNextStep:{on:{next:{target:"#configurator.configuring",actions:[Ie,"changedStep"]}}},lastStep:{on:{next:"#configurator.configured"}}}},configured:{type:"final",data:({configuration:e})=>({configuration:e})}},on:{change:{target:"configuring",actions:Pe},prev:{target:"configuring",actions:[xe,"changedStep"]}}},{actions:{changedStep:(0,$.sendParent)((e=>({type:"changedStep",step:e.activeStep})))},guards:{isLastStep:e=>e.activeStep===e.steps.length-1,activeStepValid:e=>e.isActiveStepValid}}),Ae={context:(0,$.createSchema)()},Be=(0,F.createModel)({connector:{id:"something",name:"something",version:"0.1"},Configurator:void 0,steps:void 0,error:void 0}),Oe=Be.createMachine({schema:Ae,id:"configurator",initial:"loading",context:Be.initialContext,states:{loading:{invoke:{id:"fetchConfigurator",src:"fetchConfigurator",onDone:{target:"success",actions:(0,$.assign)(((e,t)=>t.data))},onError:{target:"failure",actions:(0,$.assign)({error:(e,t)=>t.data})}}},failure:{entry:(0,R.escalate)((e=>({message:e.error})))},success:{type:"final",data:({Configurator:e,steps:t})=>({Configurator:e,steps:t})}}}),Ne=(0,F.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",response:void 0,selectedConnector:void 0,error:void 0},{events:Object.assign({selectConnector:e=>Object.assign({},e),deselectConnector:()=>({}),confirm:()=>({})},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e})}),De=Ne.assign(((e,t)=>{const{type:n}=t;return{response:(0,A.__rest)(t,["type"])}}),"api.success"),je=Ne.assign({selectedConnector:(e,t)=>{var n,a;return null===(a=null===(n=e.response)||void 0===n?void 0:n.items)||void 0===a?void 0:a.find((e=>e.id===t.selectedConnector))}},"selectConnector"),qe=Ne.assign({selectedConnector:void 0},"deselectConnector"),Re=Ne.createMachine({context:Ne.initialContext,id:"connectors",initial:"root",states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:J,src:e=>W((({accessToken:e,connectorsApiBasePath:t})=>{const n=new N.ConnectorTypesApi(new N.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const o=O().CancelToken.source(),{page:r,size:c,query:i}=e,{name:s,categories:l=[]}=i||{};return n.getConnectorTypes("1","1000",void 0,void 0,{cancelToken:o.token}).then((e=>{const n=s?s.toLowerCase():void 0,a=e.data.items||[];let o=n?null==a?void 0:a.filter((e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(n)})):a;o=l.length>0?null==o?void 0:o.filter((e=>{var t;return((null===(t=e.labels)||void 0===t?void 0:t.filter((e=>l.includes(e))))||[]).length>0})):o;const i=o.length,u=(r-1)*c,d=o.slice(u,u+c);t({items:d,total:i,page:r,size:c})})).catch((t=>{O().isCancel(t)||a({error:t.message,page:e.page})})),()=>{o.cancel("Operation canceled by the user.")}}})(e),(e=>e))},states:{idle:{entry:(0,$.send)({type:"api.query",query:{categories:["sink","source"]}},{to:J}),on:{"api.ready":"ready"}},ready:{}},on:{"api.refresh":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.nextPage":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.prevPage":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.query":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.success":{actions:De}}},selection:{id:"selection",initial:"verify",states:{verify:{always:[{target:"selecting",cond:"noConnectorSelected"},{target:"valid",cond:"connectorSelected"}]},selecting:{entry:(0,$.sendParent)("isInvalid"),on:{selectConnector:{target:"valid",actions:je,cond:(e,t)=>void 0!==t.selectedConnector}}},valid:{entry:(0,$.sendParent)("isValid"),on:{selectConnector:{target:"verify",actions:je},deselectConnector:{target:"verify",actions:qe},confirm:{target:"#done",cond:"connectorSelected"}}}}}}},done:{id:"done",type:"final",data:{selectedConnector:e=>e.selectedConnector}}}},{guards:{connectorSelected:e=>void 0!==e.selectedConnector,noConnectorSelected:e=>void 0===e.selectedConnector}}),Fe=(0,F.createModel)({accessToken:()=>Promise.resolve(""),kafkaManagementBasePath:"",instances:void 0,selectedInstance:void 0,error:void 0},{events:Object.assign({selectInstance:e=>Object.assign({},e),deselectInstance:()=>({}),confirm:()=>({})},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e})}),Le=Fe.assign(((e,t)=>{const{type:n}=t;return{response:(0,A.__rest)(t,["type"])}}),"api.success"),ze=Fe.assign({selectedInstance:(e,t)=>{var n,a;return null===(a=null===(n=e.response)||void 0===n?void 0:n.items)||void 0===a?void 0:a.find((e=>e.id===t.selectedInstance))}},"selectInstance"),_e=Fe.assign({selectedInstance:void 0},"deselectInstance"),Ge=Fe.createMachine({id:"kafkas",initial:"root",context:Fe.initialContext,states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:J,src:e=>W((({accessToken:e,kafkaManagementBasePath:t})=>{const n=new D.DefaultApi(new N.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const o=O().CancelToken.source(),{page:r,size:c,query:i}=e,{name:s,statuses:l,owner:u,cloudProviders:d,regions:p}=i||{},m=[s&&s.length>0?` name LIKE ${s}`:void 0,u&&u.length>0?` owner LIKE ${u}`:void 0,l&&l.length>0?l.map((e=>`status = ${e}`)).join(" OR "):void 0,d&&d.length>0?d.map((e=>`cloud_provider = ${e}`)).join(" OR "):void 0,p&&p.length>0?p.map((e=>`region = ${e}`)).join(" OR "):void 0].filter(Boolean).map((e=>`(${e})`)).join(" AND ");return n.getKafkas(`${r}`,`${c}`,void 0,m,{cancelToken:o.token}).then((e=>{t({items:e.data.items||[],total:e.data.total,page:e.data.page,size:e.data.size})})).catch((t=>{O().isCancel(t)||a({error:t.message,page:e.page})})),()=>{o.cancel("Operation canceled by the user.")}}})(e),(e=>e))},states:{idle:{entry:(0,$.send)("api.query",{to:J}),on:{"api.ready":"ready"}},ready:{}},on:{"api.refresh":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.nextPage":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.prevPage":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.query":{actions:(0,$.send)(((e,t)=>t),{to:J})},"api.success":{actions:Le}}},selection:{id:"selection",initial:"verify",states:{verify:{always:[{target:"selecting",cond:"noInstanceSelected"},{target:"valid",cond:"instanceSelected"}]},selecting:{entry:(0,R.sendParent)("isInvalid"),on:{selectInstance:{target:"valid",actions:ze}}},valid:{entry:(0,R.sendParent)("isValid"),on:{selectInstance:{target:"verify",actions:ze,cond:(e,t)=>void 0!==t.selectedInstance},deselectInstance:{target:"verify",actions:_e},confirm:{target:"#done",cond:"instanceSelected"}}}}}}},done:{id:"done",type:"final",data:{selectedInstance:e=>e.selectedInstance}}}},{guards:{instanceSelected:e=>void 0!==e.selectedInstance,noInstanceSelected:e=>void 0===e.selectedInstance}}),Ve=(0,F.createModel)({initialConfiguration:void 0,configString:"",name:""},{events:{save:()=>({}),success:()=>({}),failure:e=>e}}),Me=Ve.assign((e=>({kafka:e.kafka,cluster:e.cluster,connectorType:e.connectorType,name:e.name,userServiceAccount:e.userServiceAccount,configString:$e(e.initialConfiguration)}))),Ke=Ve.assign(((e,t)=>({savingError:t.message})),"failure"),Je=Ve.createMachine({id:"review",initial:"verify",context:Ve.initialContext,entry:Me,states:{verify:{always:[{target:"valid",cond:"isAllConfigured"}]},valid:{id:"valid",entry:(0,$.sendParent)("isValid"),on:{save:"saving"}},saving:{invoke:{src:e=>j({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafkaManagementApiBasePath:e.kafkaManagementApiBasePath,kafka:e.kafka,cluster:e.cluster,connectorType:e.connectorType,configuration:JSON.parse(e.configString),name:e.name,userServiceAccount:e.userServiceAccount})},on:{success:"saved",failure:{target:"valid",actions:Ke}},tags:["saving"]},saved:{type:"final"}}},{guards:{isAllConfigured:e=>void 0!==e.configString}});function $e(e){const t=e instanceof Map?function(e){const t={};return e.forEach(((e,n)=>{t[n]=e})),t}(e):e;try{return JSON.stringify(t,null,2)}catch(e){return""}}const We=(0,F.createModel)({},{events:{isValid:()=>({}),isInvalid:()=>({}),prev:()=>({}),next:()=>({}),changedStep:({step:e})=>({step:e}),jumpToSelectKafka:()=>({}),jumpToSelectCluster:()=>({}),jumpToSelectConnector:()=>({}),jumpToConfigureConnector:({subStep:e})=>({subStep:e}),jumpToBasicConfiguration:()=>({}),jumpToReviewConfiguration:()=>({})},actions:{notifySave:()=>({})}}),Qe=We.createMachine({id:"creationWizard",initial:"selectConnector",context:We.initialContext,states:{selectConnector:{initial:"selecting",invoke:{id:"selectConnectorRef",src:Re,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,selectedConnector:e.selectedConnector}),onDone:{target:"selectKafka",actions:(0,$.assign)(((e,t)=>({selectedConnector:t.data.selectedConnector,connectorConfiguration:!1,activeConfigurationStep:0,isConfigurationValid:!1,configurationSteps:!1})))},onError:".error"},states:{error:{},selecting:{on:{isValid:"valid"}},valid:{on:{isInvalid:"selecting",next:{actions:(0,$.send)("confirm",{to:"selectConnectorRef"})}}}}},selectKafka:{initial:"selecting",invoke:{id:"selectKafkaInstanceRef",src:Ge,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,selectedInstance:e.selectedKafkaInstance,request:{page:1,size:10}}),onDone:{target:"selectCluster",actions:(0,$.assign)({selectedKafkaInstance:(e,t)=>t.data.selectedInstance})},onError:".error"},states:{error:{},selecting:{on:{isValid:"valid"}},valid:{on:{isInvalid:"selecting",next:{actions:(0,$.send)("confirm",{to:"selectKafkaInstanceRef"})}}}},on:{prev:"selectConnector"}},selectCluster:{initial:"selecting",invoke:{id:"selectClusterRef",src:ke,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,selectedCluster:e.selectedCluster}),onDone:{target:"basicConfiguration",actions:(0,$.assign)({selectedCluster:(e,t)=>t.data.selectedCluster})},onError:".error"},states:{error:{},selecting:{on:{isValid:"valid"}},valid:{on:{isInvalid:"selecting",next:{actions:(0,$.send)("confirm",{to:"selectClusterRef"})}}}},on:{prev:"selectKafka"}},configureConnector:{initial:"loadConfigurator",states:{loadConfigurator:{invoke:{id:"configuratorLoader",src:"makeConfiguratorLoaderMachine",data:e=>({connector:e.selectedConnector}),onDone:{target:"configure",actions:(0,$.assign)(((e,t)=>({Configurator:t.data.Configurator,configurationSteps:t.data.steps})))},onError:{actions:(e,t)=>console.error(t.data.message)}}},configure:{id:"configure",initial:"submittable",invoke:{id:"configuratorRef",src:we,data:e=>({connector:e.selectedConnector,configuration:e.connectorConfiguration,steps:e.configurationSteps||["single step"],activeStep:e.activeConfigurationStep||0,isActiveStepValid:!1!==e.connectorConfiguration}),onDone:{target:"#creationWizard.reviewConfiguration",actions:(0,$.assign)(((e,t)=>({connectorConfiguration:t.data.configuration||!0})))},onError:{actions:(e,t)=>console.error(t.data.message)}},states:{submittable:{on:{isInvalid:"invalid",next:{actions:(0,$.send)("next",{to:"configuratorRef"})}}},invalid:{on:{isValid:"submittable"}}},on:{prev:[{actions:(0,$.send)("prev",{to:"configuratorRef"}),cond:"areThereSubsteps"},{target:"#creationWizard.basicConfiguration"}],changedStep:{actions:(0,$.assign)({activeConfigurationStep:(e,t)=>t.step})}}}}},basicConfiguration:{id:"configureBasic",initial:"submittable",invoke:{id:"basicRef",src:Ee,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafkaManagementApiBasePath:e.kafkaManagementApiBasePath,kafka:e.selectedKafkaInstance,cluster:e.selectedCluster,connectorType:e.selectedConnector,initialConfiguration:e.connectorConfiguration,name:e.name,userServiceAccount:e.userServiceAccount}),onDone:{target:"configureConnector",actions:[(0,$.assign)(((e,t)=>({name:t.data.name,userServiceAccount:t.data.userServiceAccount})))]},onError:{actions:(e,t)=>console.error(t.data.message)}},states:{submittable:{on:{isInvalid:"invalid",next:{actions:(0,$.send)("confirm",{to:"basicRef"})}}},invalid:{on:{isValid:"submittable"}}},on:{prev:"selectCluster"}},reviewConfiguration:{id:"review",initial:"reviewing",invoke:{id:"reviewRef",src:Je,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafkaManagementApiBasePath:e.kafkaManagementApiBasePath,kafka:e.selectedKafkaInstance,cluster:e.selectedCluster,connectorType:e.selectedConnector,initialConfiguration:e.connectorConfiguration,name:e.name,userServiceAccount:e.userServiceAccount}),onDone:{target:"#creationWizard.saved",actions:[(0,$.assign)(((e,t)=>({connectorConfiguration:t.data}))),"notifySave"]},onError:{actions:(e,t)=>console.error(t.data.message)}},states:{reviewing:{on:{isValid:"valid"}},valid:{on:{isInvalid:"reviewing",next:{actions:(0,$.send)("save",{to:"reviewRef"})}}}},on:{prev:"configureConnector"}},saved:{id:"saved",type:"final"}},on:{jumpToSelectConnector:{target:"selectConnector"},jumpToSelectKafka:{target:"selectKafka",cond:"isConnectorSelected"},jumpToSelectCluster:{target:"selectCluster",cond:"isKafkaInstanceSelected"},jumpToBasicConfiguration:{target:"basicConfiguration",cond:"isClusterSelected"},jumpToConfigureConnector:{target:"configureConnector",cond:"isBasicConfigured",actions:(0,$.assign)(((e,t)=>({activeConfigurationStep:t.subStep||0})))},jumpToReviewConfiguration:{target:"reviewConfiguration",cond:"isConnectorConfigured"}}},{guards:{isKafkaInstanceSelected:e=>void 0!==e.selectedKafkaInstance,isClusterSelected:e=>void 0!==e.selectedCluster,isConnectorSelected:(e,t)=>{const n=t.subStep;return n?void 0!==e.selectedConnector&&(void 0!==e.connectorConfiguration||n<=e.activeConfigurationStep):void 0!==e.selectedConnector},isConnectorConfigured:e=>e.configurationSteps?void 0!==e.connectorConfiguration&&!1!==e.connectorConfiguration||e.activeConfigurationStep===e.configurationSteps.length-1&&!0===e.isConfigurationValid:void 0!==e.connectorConfiguration&&!1!==e.connectorConfiguration,isBasicConfigured:e=>{var t,n;return void 0===e.userServiceAccount?void 0!==e.name&&e.name.length>0:void 0!==e.name&&e.name.length>0&&(null===(t=e.userServiceAccount.clientId)||void 0===t?void 0:t.length)>0&&(null===(n=e.userServiceAccount.clientSecret)||void 0===n?void 0:n.length)>0},areThereSubsteps:e=>e.activeConfigurationStep>0},actions:{notifySave:e=>{e.onSave&&e.onSave()}},services:{makeConfiguratorLoaderMachine:()=>Oe}}),He=(0,a.createContext)(null),Ue=({children:e,accessToken:t,connectorsApiBasePath:n,fetchConfigurator:r,onSave:c})=>{const i=(0,a.useCallback)((()=>Oe.withConfig({services:{fetchConfigurator:e=>r(e.connector)}})),[r]),s=(0,q.useInterpret)(Qe,{devTools:!0,context:{accessToken:t,connectorsApiBasePath:n,onSave:c},services:{makeConfiguratorLoaderMachine:i}});return o().createElement(He.Provider,{value:s},e)},Ze=()=>{const e=(0,a.useContext)(He);if(!e)throw new Error("useCreationWizardMachineService() must be used in a child of <CreationWizardMachineProvider>");return e},Ye=()=>{const e=Ze();return(0,q.useSelector)(e,(0,a.useCallback)((e=>({connectorTypeRef:e.children.selectConnectorRef,kafkaRef:e.children.selectKafkaInstanceRef,clusterRef:e.children.selectClusterRef,basicRef:e.children.basicRef,reviewRef:e.children.reviewRef})),[]))},Xe=()=>{var e;const{clusterRef:t}=Ye(),n=Q(null===(e=t.getSnapshot())||void 0===e?void 0:e.children.paginatedApi),{selectedId:o}=(0,q.useSelector)(t,(0,a.useCallback)((e=>{var t;return{selectedId:null===(t=e.context.selectedCluster)||void 0===t?void 0:t.id}}),[])),r=(0,a.useCallback)((e=>{t.send({type:"selectCluster",selectedCluster:e})}),[t]),c=(0,a.useCallback)((e=>{t.send(Object.assign({type:"api.query"},e))}),[t]);return Object.assign(Object.assign({},n),{selectedId:o,onSelect:r,onQuery:c})},et=()=>{var e;const{connectorTypeRef:t}=Ye(),n=Q(null===(e=t.getSnapshot())||void 0===e?void 0:e.children.paginatedApi),{selectedId:o}=(0,q.useSelector)(t,(0,a.useCallback)((e=>{var t;return{selectedId:null===(t=e.context.selectedConnector)||void 0===t?void 0:t.id}}),[])),r=(0,a.useCallback)((e=>{t.send({type:"selectConnector",selectedConnector:e})}),[t]),c=(0,a.useCallback)((e=>{t.send(Object.assign({type:"api.query"},e))}),[t]);return Object.assign(Object.assign({},n),{selectedId:o,onSelect:r,onQuery:c})},tt=()=>{var e;const{kafkaRef:t}=Ye(),n=Q(null===(e=t.getSnapshot())||void 0===e?void 0:e.children.paginatedApi),{selectedId:o}=(0,q.useSelector)(t,(0,a.useCallback)((e=>{var t;return{selectedId:null===(t=e.context.selectedInstance)||void 0===t?void 0:t.id}}),[])),r=(0,a.useCallback)((e=>{t.send({type:"selectInstance",selectedInstance:e})}),[t]),c=(0,a.useCallback)((e=>{t.send(Object.assign({type:"api.query"},e))}),[t]);return Object.assign(Object.assign({},n),{selectedId:o,onSelect:r,onQuery:c})},nt=()=>{const{reviewRef:e}=Ye(),{kafka:t,cluster:n,connectorType:o,name:r,userServiceAccount:c,configString:i,isSaving:s,savingError:l}=(0,q.useSelector)(e,(0,a.useCallback)((e=>({kafka:e.context.kafka,cluster:e.context.cluster,connectorType:e.context.connectorType,name:e.context.name,userServiceAccount:e.context.userServiceAccount,configString:e.context.configString,isSaving:e.hasTag("saving"),savingError:e.context.savingError})),[]));return{kafka:t,cluster:n,connectorType:o,name:r,userServiceAccount:c,configString:i,isSaving:s,savingError:l}},at=({title:e,description:t,component:n,children:a})=>o().createElement("div",{className:"pf-l-stack"},o().createElement("div",{className:"pf-u-p-md pf-l-stack__item"},o().createElement(c.Level,null,o().createElement(c.LevelItem,null,o().createElement(c.Title,{headingLevel:"h2"},e)),o().createElement(c.LevelItem,null,n)),"string"==typeof t?o().createElement("p",{className:"wizard-step__description"},t):t),o().createElement("div",{className:"pf-l-stack__item pf-l-stack pf-m-fill"},a));function ot(){const{t:e}=(0,r.useTranslation)(),{name:t,serviceAccount:n,onSetName:i,onSetServiceAccount:s}=(()=>{const{basicRef:e}=Ye(),{name:t,serviceAccount:n}=(0,q.useSelector)(e,(0,a.useCallback)((e=>({name:e.context.name,serviceAccount:e.context.userServiceAccount})),[])),o=(0,a.useCallback)((t=>{e.send({type:"setName",name:t})}),[e]),r=(0,a.useCallback)((t=>{e.send({type:"setServiceAccount",serviceAccount:t})}),[e]);return{serviceAccount:n,name:t,onSetName:o,onSetServiceAccount:r}})();return o().createElement(at,{title:e("Common"),description:e("basicStepDescription")},o().createElement(c.Card,null,o().createElement(c.CardBody,null,o().createElement(c.Form,null,o().createElement(c.FormGroup,{label:"Name",isRequired:!0,fieldId:"name",helperText:"Please provide a unique name for the connector"},o().createElement(c.TextInput,{value:t,onChange:i,id:"name"})),o().createElement(c.FormGroup,{label:"Service account",isRequired:!0,fieldId:"service-account"},o().createElement(c.Radio,{isChecked:void 0===n,name:"service-account",onChange:()=>s(void 0),label:"Automatically create a service account for this connector.",id:"service-account-automatic",value:"automatic"}),o().createElement(c.Radio,{isChecked:void 0!==n,name:"service-account",onChange:()=>s({clientId:"",clientSecret:""}),label:"Provide the credentials manually.",id:"service-account-user",value:"user"}),void 0!==n&&o().createElement(o().Fragment,null,o().createElement(c.FormGroup,{label:"Client ID",isRequired:!0,fieldId:"clientId"},o().createElement(c.TextInput,{value:n.clientId,onChange:e=>s(Object.assign(Object.assign({},n),{clientId:e})),id:"clientId"})),o().createElement(c.FormGroup,{label:"Client Secret",isRequired:!0,fieldId:"clientSecret"},o().createElement(c.TextInput,{value:n.clientSecret,onChange:e=>s(Object.assign(Object.assign({},n),{clientSecret:e})),id:"clientSecret"}))))))))}const rt=({onHelp:e})=>{const{t}=(0,r.useTranslation)();return o().createElement(c.EmptyState,{variant:c.EmptyStateVariant.xl,className:(0,m.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},o().createElement(c.EmptyStateIcon,{icon:i.ClusterIcon}),o().createElement(c.Title,{headingLevel:"h1",size:c.TitleSizes["4xl"]},t("No OSD Cluster available")),o().createElement(c.EmptyStateBody,null,o().createElement(r.Trans,null,"Development preview instances are available for creation. For help getting started, access the"," ",o().createElement(c.Button,{variant:c.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:e},"quick start guide."))))};function ct(){return(()=>{const{clusterRef:e}=Ye();return(0,q.useSelector)(e,(0,a.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?o().createElement(it,null):null}const it=()=>{const{t:e}=(0,r.useTranslation)(),{response:t,selectedId:n,loading:a,error:i,noResults:s,queryEmpty:l,firstRequest:u,onSelect:d,onQuery:p}=Xe();return o().createElement(at,{title:e("OSD cluster"),description:e("clusterStepDescription")},(()=>{var e;switch(!0){case u:return o().createElement(w.g,null);case l:return o().createElement(o().Fragment,null,o().createElement(st,null),o().createElement(P,{onClear:()=>p({page:1,size:10})}));case s||i:return o().createElement(rt,{onHelp:function(){throw new Error("Function not implemented.")}});case a:return o().createElement(o().Fragment,null,o().createElement(st,null),o().createElement(w.g,null));default:return o().createElement(o().Fragment,null,o().createElement(st,null),o().createElement("div",{className:"pf-l-stack__item pf-m-fill pf-u-p-md"},o().createElement(c.Gallery,{hasGutter:!0},null===(e=null==t?void 0:t.items)||void 0===e?void 0:e.map((e=>o().createElement(c.Card,{isHoverable:!0,key:e.id,isSelectable:!0,isSelected:n===e.id,onClick:()=>d(e.id)},o().createElement(c.CardHeader,null,o().createElement(c.CardTitle,null,e.name)),o().createElement(c.CardBody,null,o().createElement(c.DescriptionList,null,o().createElement(c.DescriptionListGroup,null,o().createElement(c.DescriptionListTerm,null,"Owner"),o().createElement(c.DescriptionListDescription,null,e.owner)),o().createElement(c.DescriptionListGroup,null,o().createElement(c.DescriptionListTerm,null,"Created"),o().createElement(c.DescriptionListDescription,null,e.created_at))))))))))}})())},st=()=>{const{request:e,onQuery:t}=Xe(),n=(0,a.useRef)(null),r=S(t,1e3),s=o().createElement(o().Fragment,null,o().createElement(c.ToolbarItem,null,o().createElement(c.InputGroup,null,o().createElement(c.TextInput,{name:"textInput2",id:"textInput2",type:"search","aria-label":"search input example",onChange:t=>r({size:e.size,page:1,name:t}),ref:n}),o().createElement(c.Button,{variant:"control","aria-label":"search button for search input"},o().createElement(i.SearchIcon,null))))),l=o().createElement(o().Fragment,null,o().createElement(c.ToolbarToggleGroup,{toggleIcon:o().createElement(i.FilterIcon,null),breakpoint:"xl"},s),o().createElement(c.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},o().createElement(lt,{isCompact:!0})));return o().createElement(c.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl"},o().createElement(c.ToolbarContent,null,l))},lt=({isCompact:e=!1})=>{const{request:t,response:n,onQuery:a}=Xe();return o().createElement(C,{itemCount:(null==n?void 0:n.total)||0,page:t.page,perPage:t.size,onChange:(e,t)=>a({page:e,size:t}),isCompact:e})};var ut=n(71322),dt=n.n(ut),pt=n(95957),mt=n(38218),gt=n(38524);const vt=new(dt())({allErrors:!0,useDefaults:!1,strict:"log",strictSchema:!1});const ft=({schema:e,configuration:t,onChange:n})=>{e.type=e.type||"object";try{delete e.properties.steps}catch(e){}const a=function(e){const t=vt.compile(e);return e=>{var n;return t(e),(null===(n=t.errors)||void 0===n?void 0:n.length)?{details:t.errors}:null}}(e),r=new mt.JSONSchemaBridge(e,a);return o().createElement(Ct,{schema:r,model:t,onChangeModel:e=>n(e,!1),onSubmit:e=>n(e,!0)},o().createElement(gt.AutoFields,null),o().createElement(c.Card,{isPlain:!0},o().createElement(c.CardBody,null,o().createElement(gt.SubmitField,{value:"Verify configuration"}))))};const Ct=function e(t){class n extends(pt.AutoForm.Auto(t)){onChange(e,t){if(""===t)return super.onChange(e,void 0);super.onChange(e,t)}}return n.Auto=e,n}(pt.ValidatedQuickForm),Et=({actor:e,Configurator:t})=>{const{activeStep:n,configuration:r,connector:c}=(0,q.useSelector)(e,(0,a.useCallback)((e=>({connector:e.context.connector,activeStep:e.context.activeStep,configuration:e.context.configuration})),[e]));return o().createElement(t,{activeStep:n,configuration:r,connector:c,onChange:(t,n)=>e.send({type:"change",configuration:t,isValid:n})})},ht=({actor:e})=>{const{configuration:t,connector:n}=(0,q.useSelector)(e,(0,a.useCallback)((e=>({connector:e.context.connector,configuration:e.context.configuration})),[e]));return o().createElement(ft,{schema:n.schema,configuration:t||{},onChange:(t,n)=>e.send({type:"change",configuration:t,isValid:n})})},yt=()=>{const{t:e}=(0,r.useTranslation)(),t=Ze(),{isLoading:n,hasErrors:s,Configurator:l,configuratorRef:u,hasCustomConfigurator:d}=(0,q.useSelector)(t,(0,a.useCallback)((e=>({isLoading:e.matches({configureConnector:"loadConfigurator"}),hasErrors:e.matches("failure"),hasCustomConfigurator:!1!==e.context.Configurator&&void 0!==e.context.Configurator,configuration:e.context.connectorConfiguration,Configurator:e.context.Configurator,configuratorRef:e.children.configuratorRef})),[t]));return o().createElement(at,{title:e("Configurations"),description:e("configurationStepDescription")},(()=>{switch(!0){case n:return o().createElement(c.EmptyState,null,o().createElement(c.EmptyStateIcon,{variant:"container",component:c.Spinner}),o().createElement(c.Title,{size:"lg",headingLevel:"h4"},e("loading")));case s:return o().createElement(c.EmptyState,null,o().createElement(c.EmptyStateIcon,{icon:i.ExclamationCircleIcon}),o().createElement(c.Title,{size:"lg",headingLevel:"h4"},"Error message"));case d:return o().createElement(o().Suspense,{fallback:null},o().createElement(Et,{actor:u,Configurator:l}));default:return o().createElement(ht,{actor:u})}})())},St=(e,t)=>({key:e,node:t(e)});function bt(){return(()=>{const{connectorTypeRef:e}=Ye();return(0,q.useSelector)(e,(0,a.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?o().createElement(kt,null):null}function kt(){const{t:e}=(0,r.useTranslation)(),{response:t,loading:n,error:a,noResults:i,queryEmpty:s,firstRequest:l,selectedId:u,onSelect:d,onQuery:p}=et();return o().createElement(at,{title:e("Connector"),description:e("connectorTypeStepDescription")},(()=>{var e;switch(!0){case l:return o().createElement(w.g,null);case s:return o().createElement(o().Fragment,null,o().createElement(Tt,null),o().createElement(P,{onClear:()=>p({page:1,size:10})}));case i||a:return o().createElement(T,null);case n:return o().createElement(o().Fragment,null,o().createElement(Tt,null),o().createElement(w.g,null));default:return o().createElement(o().Fragment,null,o().createElement(Tt,null),o().createElement("div",{className:"pf-l-stack__item pf-m-fill pf-u-p-md"},o().createElement(c.Gallery,{hasGutter:!0},null===(e=null==t?void 0:t.items)||void 0===e?void 0:e.map((e=>o().createElement(c.Card,{isHoverable:!0,key:e.id,isSelectable:!0,isSelected:u===e.id,onClick:()=>d(e.id)},o().createElement(c.CardHeader,null,o().createElement(c.CardTitle,null,e.name)),o().createElement(c.CardBody,null,o().createElement(c.DescriptionList,null,o().createElement(c.DescriptionListGroup,null,o().createElement(c.DescriptionListDescription,null,e.description)),o().createElement(c.DescriptionListGroup,null,o().createElement(c.DescriptionListTerm,null,"Version"),o().createElement(c.DescriptionListDescription,null,e.version)),o().createElement(c.DescriptionListGroup,null,o().createElement(c.DescriptionListTerm,null,"ID"),o().createElement(c.DescriptionListDescription,null,e.id))))))))))}})())}const Tt=()=>{const{t:e}=(0,r.useTranslation)(),{request:t,onQuery:n}=et(),[s,l]=(0,a.useState)(!1),u=(0,a.useRef)(null),d=S(n,1e3),{name:p,categories:m=[]}=t.query||{},g=(0,a.useCallback)((()=>n({page:1,size:t.size})),[n,t.size]),v=(0,a.useCallback)((()=>l((e=>!e))),[]),f=(e,a)=>{((e,a,o)=>{n(Object.assign(Object.assign({},t),{query:Object.assign(Object.assign({},t.query||{}),{[e]:a.includes(o)?a.filter((e=>e!==o)):[...a||[],o]})}))})("categories",m,a.key)};(0,a.useEffect)((()=>{u.current&&(u.current.value=p||"")}),[u,p]);const C=[o().createElement(c.SelectOption,{key:"sink",value:"sink"},e("sink")),o().createElement(c.SelectOption,{key:"source",value:"source"},e("source"))],E=o().createElement(o().Fragment,null,o().createElement(c.ToolbarItem,null,o().createElement(c.InputGroup,null,o().createElement(c.TextInput,{name:"name",id:"name",type:"search","aria-label":"filter by connector name",onChange:e=>d({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{name:e})}),ref:u}),o().createElement(c.Button,{variant:"control","aria-label":"search button for search input"},o().createElement(i.SearchIcon,null)))),o().createElement(c.ToolbarGroup,{variant:"filter-group"},o().createElement(c.ToolbarFilter,{chips:m.map((t=>St(t,e))),deleteChip:f,deleteChipGroup:()=>{return e="categories",n(Object.assign(Object.assign({},t),{query:Object.assign(Object.assign({},t.query||{}),{[e]:void 0})}));var e},categoryName:"Connector type"},o().createElement(c.Select,{variant:"checkbox","aria-label":"Connector type",onToggle:v,onSelect:(t,n)=>f(0,St(n,e)),selections:m,isOpen:s,placeholderText:"Connector type"},C)))),h=o().createElement(o().Fragment,null,o().createElement(c.ToolbarToggleGroup,{toggleIcon:o().createElement(i.FilterIcon,null),breakpoint:"xl"},E),o().createElement(c.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},o().createElement(It,{isCompact:!0})));return o().createElement(c.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl",clearAllFilters:g},o().createElement(c.ToolbarContent,null,h))},It=({isCompact:e=!1})=>{const{request:t,response:n,onQuery:a}=et();return o().createElement(C,{itemCount:(null==n?void 0:n.total)||0,page:t.page,perPage:t.size,onChange:(e,t)=>a({page:e,size:t}),isCompact:e})},xt=({onHelp:e})=>{const{t}=(0,r.useTranslation)();return o().createElement(c.EmptyState,{variant:c.EmptyStateVariant.xl,className:(0,m.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},o().createElement(c.EmptyStateIcon,{icon:i.SpaceShuttleIcon}),o().createElement(c.Title,{headingLevel:"h1",size:c.TitleSizes["4xl"]},t("No Kafka instance available")),o().createElement(c.EmptyStateBody,null,o().createElement(r.Trans,null,"Development preview instances are available for creation. For help getting started, access the"," ",o().createElement(c.Button,{variant:c.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:e},"quick start guide."))))},Pt=()=>(()=>{const{kafkaRef:e}=Ye();return(0,q.useSelector)(e,(0,a.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?o().createElement(wt,null):null,wt=()=>{const{t:e}=(0,r.useTranslation)(),{response:t,loading:n,error:a,selectedId:i,noResults:s,queryEmpty:l,firstRequest:u,onSelect:d,onQuery:p}=tt();return o().createElement(at,{title:e("Kafka instance"),description:e("kafkaStepDescription")},(()=>{var e;switch(!0){case u:return o().createElement(w.g,null);case l:return o().createElement(o().Fragment,null,o().createElement(At,null),o().createElement(P,{onClear:()=>p({page:1,size:10})}));case s||a:return o().createElement(xt,{onHelp:function(){throw new Error("Function not implemented.")}});case n:return o().createElement(o().Fragment,null,o().createElement(At,null),o().createElement(w.g,null));default:return o().createElement(o().Fragment,null,o().createElement(At,null),o().createElement("div",{className:"pf-l-stack__item pf-m-fill pf-u-p-md"},o().createElement(c.Gallery,{hasGutter:!0},null===(e=null==t?void 0:t.items)||void 0===e?void 0:e.map((e=>o().createElement(c.Card,{isHoverable:!0,key:e.id,isSelectable:!0,isSelected:i===e.id,onClick:()=>d(e.id)},o().createElement(c.CardHeader,null,o().createElement(c.CardTitle,null,e.name)),o().createElement(c.CardBody,null,o().createElement(c.DescriptionList,null,o().createElement(c.DescriptionListGroup,null,o().createElement(c.DescriptionListTerm,null,"Region"),o().createElement(c.DescriptionListDescription,null,e.region)),o().createElement(c.DescriptionListGroup,null,o().createElement(c.DescriptionListTerm,null,"Owner"),o().createElement(c.DescriptionListDescription,null,e.owner)),o().createElement(c.DescriptionListGroup,null,o().createElement(c.DescriptionListTerm,null,"Created"),o().createElement(c.DescriptionListDescription,null,e.created_at))))))))))}})())},At=()=>{const{t:e}=(0,r.useTranslation)(),{request:t,onQuery:n}=tt(),[s,l]=(0,a.useState)(!1),[u,d]=(0,a.useState)(!1),[p,m]=(0,a.useState)(!1),[g,v]=(0,a.useState)(!1),[f,C]=(0,a.useState)("Name"),E=(0,a.useCallback)((()=>l((e=>!e))),[]),h=(0,a.useCallback)((()=>d((e=>!e))),[]),y=(0,a.useCallback)((()=>m((e=>!e))),[]),b=(0,a.useCallback)((()=>v((e=>!e))),[]),k=S(n,1e3),{name:T,owner:I,cloudProviders:x=[],regions:P=[],statuses:w=[]}=t.query||{},A=(0,a.useCallback)((()=>n({page:1,size:t.size})),[n,t.size]),B=(0,a.useRef)(null),O=(0,a.useRef)(null),N=(e,a,o)=>n(Object.assign(Object.assign({},t),{query:Object.assign(Object.assign({},t.query||{}),{[e]:a.includes(o)?a.filter((e=>e!==o)):[...a||[],o]})})),D=(e,t)=>{N("statuses",w,t.key)},j=(e,t)=>{N("cloudProviders",x,t.key)},q=(e,t)=>{N("regions",P,t.key)},R=e=>n(Object.assign(Object.assign({},t),{query:Object.assign(Object.assign({},t.query||{}),{[e]:void 0})})),F=(0,a.useCallback)((e=>{const t=(null==e?void 0:e.target).innerText;C(t),v((e=>!e))}),[]);(0,a.useEffect)((()=>{B.current&&(B.current.value=T||""),O.current&&(O.current.value=I||"")}),[B,T,I]);const L=Bt.map((({value:e,label:t})=>o().createElement(c.DropdownItem,{key:e},t))),z=Nt.filter((e=>"preparing"!==e.value)).map((({value:e,label:t})=>o().createElement(c.SelectOption,{key:e,value:e},t))),_=Ot.map((({value:e,label:t})=>o().createElement(c.SelectOption,{key:e,value:e},t))),G=Dt.map((({value:e,label:t})=>o().createElement(c.SelectOption,{key:e,value:e},t))),V=o().createElement(c.ToolbarItem,null,o().createElement(c.Dropdown,{onSelect:e=>F(e),position:c.DropdownPosition.left,toggle:o().createElement(c.DropdownToggle,{onToggle:b,style:{width:"100%"}},o().createElement(i.FilterIcon,{size:"sm"})," ",f),isOpen:g,dropdownItems:L,style:{width:"100%"}})),M=o().createElement(o().Fragment,null,o().createElement(c.ToolbarGroup,{variant:"filter-group"},V,o().createElement(c.ToolbarFilter,{chips:w.map((t=>St(t,e))),deleteChip:D,deleteChipGroup:()=>R("statuses"),categoryName:e("status"),showToolbarItem:f===e("status")},o().createElement(c.Select,{variant:"checkbox","aria-label":e("status"),onToggle:E,onSelect:(t,n)=>D(0,St(n,e)),selections:w,isOpen:s,placeholderText:e("Filter by status")},z)),o().createElement(c.ToolbarFilter,{chips:x.map((t=>St(t,e))),deleteChip:j,deleteChipGroup:()=>R("cloudProviders"),categoryName:e("CloudProvider"),showToolbarItem:f===e("CloudProvider")},o().createElement(c.Select,{variant:"checkbox","aria-label":e("CloudProvider"),onToggle:h,onSelect:(t,n)=>j(0,St(n,e)),selections:x,isOpen:u,placeholderText:e("Filter by cloud provider")},_)),o().createElement(c.ToolbarFilter,{chips:P.map((t=>St(t,e))),deleteChip:q,deleteChipGroup:()=>R("regions"),categoryName:e("region"),showToolbarItem:f===e("region")},o().createElement(c.Select,{variant:"checkbox","aria-label":e("region"),onToggle:y,onSelect:(t,n)=>q(0,St(n,e)),selections:P,isOpen:p,placeholderText:e("Filter by region")},G)),o().createElement(c.ToolbarFilter,{chips:T?[T]:[],deleteChip:()=>R("name"),categoryName:e("name")},f===e("name")&&o().createElement(c.ToolbarItem,null,o().createElement(c.InputGroup,null,o().createElement(c.TextInput,{name:e("name"),id:e("name"),type:"search",placeholder:e("nameSearchPlaceholder"),"aria-label":e("nameSearchPlaceholder"),onChange:e=>k({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{name:e})}),ref:B}),o().createElement(c.Button,{variant:"control","aria-label":"search button for name input",onClick:()=>{var e;return n({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{name:(null===(e=B.current)||void 0===e?void 0:e.value)||""})})}},o().createElement(i.SearchIcon,null))))),o().createElement(c.ToolbarFilter,{chips:I?[I]:[],deleteChip:()=>R("owner"),categoryName:e("owner")},f===e("owner")&&o().createElement(c.ToolbarItem,null,o().createElement(c.InputGroup,null,o().createElement(c.TextInput,{name:e("owner"),id:e("owner"),type:"search",placeholder:e("ownerSearchPlaceholder"),"aria-label":e("ownerSearchPlaceholder"),onChange:e=>k({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{owner:e})}),ref:O}),o().createElement(c.Button,{variant:"control","aria-label":"search button for owner input",onClick:()=>{var e;return n({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{owner:(null===(e=O.current)||void 0===e?void 0:e.value)||""})})}},o().createElement(i.SearchIcon,null))))))),K=o().createElement(o().Fragment,null,o().createElement(c.ToolbarToggleGroup,{toggleIcon:o().createElement(i.FilterIcon,null),breakpoint:"xl"},M),o().createElement(c.ToolbarGroup,{variant:"icon-button-group"},o().createElement(c.ToolbarItem,null,o().createElement(c.Button,{variant:"primary"},e("Create Kafka instance")))),o().createElement(c.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},o().createElement(jt,{isCompact:!0})));return o().createElement(c.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl",clearAllFilters:A},o().createElement(c.ToolbarContent,null,K))},Bt=[{value:"name",label:"Name"},{value:"status",label:"Status"},{value:"cloudprovider",label:"Cloud Provider"},{value:"region",label:"Region"},{value:"owner",label:"Owner"}],Ot=[{value:"aws",label:"Amazon Web Services"}],Nt=[{value:"ready",label:"Ready"},{value:"failed",label:"Failed"},{value:"accepted",label:"Creation pending"},{value:"provisioning",label:"Creation in progress"},{value:"preparing",label:"Creation in progress"},{value:"deprovision",label:"Deletion in progress"}],Dt=[{value:"us-east-1",label:"US East, N. Virginia"}],jt=({isCompact:e=!1})=>{const{request:t,response:n,onQuery:a}=tt();return o().createElement(C,{itemCount:(null==n?void 0:n.total)||0,page:t.page,perPage:t.size,onChange:(e,t)=>a({page:e,size:t}),isCompact:e})},qt=()=>{const[e,t]=o().useState(!1),[n,a]=o().useState(!1),r=o().useRef(),s=o().useRef();const{configString:l}=nt();const u=(e,t)=>t?e:function(e){const t=["secretKey","accessKey"];return JSON.stringify(e,((e,n)=>-1===t.indexOf(e)?n:"*".repeat(n.length)),2)}(JSON.parse(e)),d=(e,n)=>{((e,t)=>{const n=e.currentTarget.parentElement,a=document.createElement("textarea");a.value=t.toString(),n.appendChild(a),a.select(),document.execCommand("copy"),n.removeChild(a)})(e,n),t(!0)},p=o().createElement(o().Fragment,null,o().createElement(c.CodeBlockAction,null,o().createElement(c.Button,{variant:"plain",ref:s,"aria-label":"show hidden fields icon",onClick:()=>a(!n)},n?o().createElement(i.EyeSlashIcon,null):o().createElement(i.EyeIcon,null)),o().createElement(c.Tooltip,{content:o().createElement("div",null,n?"Hide service account":"Show service account"),reference:s})),o().createElement(c.CodeBlockAction,null,o().createElement(c.ClipboardCopyButton,{id:"copy-button",textId:"code-content","aria-label":"Copy to clipboard",onClick:e=>d(e,u(l,n)),exitDelay:600,maxWidth:"110px",variant:"plain"},e?"Successfully copied to clipboard!":"Copy to clipboard")),o().createElement(c.CodeBlockAction,null,o().createElement(c.Button,{variant:"plain",ref:r,"aria-label":"Download icon",onClick:e=>{return t=e,a=u(l,n),(0,A.__awaiter)(void 0,void 0,void 0,(function*(){const e=t.currentTarget.parentElement,n=new Blob([a],{type:"application/json"}),o=yield URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download="connectorConfig.json",e.appendChild(r),r.click(),e.removeChild(r)}));var t,a}},o().createElement(i.FileDownloadIcon,null)),o().createElement(c.Tooltip,{content:o().createElement("div",null,"Download JSON"),reference:r})));return o().createElement(c.CodeBlock,{actions:p},o().createElement(c.CodeBlockCode,{id:"code-content"},u(l,n)))};var Rt=n(96486),Ft=n.n(Rt);function Lt(){var e;const{t}=(0,r.useTranslation)(),[n,s]=(0,a.useState)(!1),[l,u]=(0,a.useState)({clientId:!0,clientSecret:!0,accessKey:!0,secretKey:!0}),d=e=>{let t=Object.assign({},l);switch(e.currentTarget.id){case"clientId":t.clientId=!l.clientId,u(t);break;case"clientSecret":t.clientSecret=!l.clientSecret,u(t);break;case"accessKey":t.accessKey=!l.accessKey,u(t);break;case"secretKey":t.secretKey=!l.secretKey,u(t)}},{kafka:p,cluster:m,connectorType:g,name:v,userServiceAccount:f,configString:C,savingError:E}=nt(),h=(0,a.useCallback)((()=>s((e=>!e))),[]),y=JSON.parse(C),S=JSON.parse(C).connector,b=JSON.parse(C).kafka,k=Ft().mapKeys(y,((e,t)=>t.replace(/\./g,"_"))),T=e=>"*".repeat(e.length);return o().createElement(at,{title:t("Review"),description:t(n?"reviewJSONStepDescription":"reviewStepDescription"),component:o().createElement(c.Switch,{id:"toggle-json-view",label:t("ViewJSONFormat"),labelOff:t("ViewJSONFormat"),isChecked:n,onChange:h})},o().createElement(c.Card,null,o().createElement(c.CardBody,null,o().createElement(c.Form,null,E&&o().createElement(c.FormAlert,null,o().createElement(c.Alert,{variant:"danger",title:E,"aria-live":"polite",isInline:!0})),n?o().createElement(qt,null):o().createElement(o().Fragment,null,o().createElement(c.Grid,null,o().createElement(c.GridItem,{span:4},o().createElement("strong",null,t("Connector category"))),o().createElement(c.GridItem,{span:8},g.description)),o().createElement(c.Grid,null,o().createElement(c.GridItem,{span:4},o().createElement("strong",null,t("Kafka instance"))),o().createElement(c.GridItem,{span:8},p.name)),o().createElement(c.Grid,null,o().createElement(c.GridItem,{span:4},o().createElement("strong",null,t("OSD Cluster"))),o().createElement(c.GridItem,{span:8},m.name)),o().createElement(c.Title,{headingLevel:"h3",size:c.TitleSizes["2xl"]},t("Basic")),o().createElement(c.Grid,null,o().createElement(c.GridItem,{span:4},o().createElement("strong",null,t("Connector name"))),o().createElement(c.GridItem,{span:8},v)),o().createElement(c.Grid,null,o().createElement(c.GridItem,{span:4},o().createElement("strong",null,t("Type"))),o().createElement(c.GridItem,{span:8},null===(e=g.labels)||void 0===e?void 0:e.map((e=>e)))),(null==f?void 0:f.clientId)&&o().createElement(c.Grid,null,o().createElement(c.GridItem,{span:4},o().createElement("strong",null,t("Client ID"))),o().createElement(c.GridItem,{span:8},o().createElement(c.Flex,null,o().createElement(c.FlexItem,null,l.clientId?T(null==f?void 0:f.clientId):null==f?void 0:f.clientId),o().createElement(c.FlexItem,{onClick:d,id:"clientId"},l.clientId?o().createElement(i.EyeIcon,null):o().createElement(i.EyeSlashIcon,null))))),(null==f?void 0:f.clientSecret)&&o().createElement(c.Grid,null,o().createElement(c.GridItem,{span:4},o().createElement("strong",null,t("Client Secret"))),o().createElement(c.GridItem,{span:8},o().createElement(c.Flex,null,o().createElement(c.FlexItem,null,l.clientSecret?T(null==f?void 0:f.clientSecret):null==f?void 0:f.clientSecret),o().createElement(c.FlexItem,{onClick:d,id:"clientSecret"},l.clientSecret?o().createElement(i.EyeIcon,null):o().createElement(i.EyeSlashIcon,null))))),o().createElement(c.Title,{headingLevel:"h3",size:c.TitleSizes["2xl"]},t("Connector specific")),S&&Object.keys(S).map((e=>o().createElement(c.Grid,null,o().createElement(c.GridItem,{span:4},o().createElement("strong",null,Ft().startCase(e))),o().createElement(c.GridItem,{span:8},Ft().startCase(e)===t("Access Key")||Ft().startCase(e)===t("Secret Key")?o().createElement(c.Flex,null,o().createElement(c.FlexItem,null,l[e]?T(S[e]):S[e]),o().createElement(c.FlexItem,{onClick:d,id:e},l[e]?o().createElement(i.EyeIcon,null):o().createElement(i.EyeSlashIcon,null))):S[e])))),b&&Object.keys(b).map((e=>o().createElement(c.Grid,null,o().createElement(c.GridItem,{span:4},o().createElement("strong",null,Ft().startCase(e))),o().createElement(c.GridItem,{span:8},b[e])))),void 0===S&&Object.keys(k).map((e=>o().createElement(c.Grid,null,o().createElement(c.GridItem,{span:4},o().createElement("strong",null,Ft().startCase(e))),o().createElement(c.GridItem,{span:8},Ft().startCase(e)===t("Database Password")||Ft().startCase(e)===t("Password")?T(k[e]):k[e])))))))))}const zt=({onClose:e})=>{const{t}=(0,r.useTranslation)(),n=Ze(),[c,i]=(0,q.useActor)(n);let{hasCustomConfigurator:s,activeStep:l,configureSteps:u}=(0,q.useSelector)(n,(0,a.useCallback)((e=>({isLoading:e.matches({configureConnector:"loadConfigurator"}),hasErrors:e.matches("failure"),hasCustomConfigurator:!1!==e.context.Configurator&&void 0!==e.context.Configurator,activeStep:e.context.activeConfigurationStep,configuration:e.context.connectorConfiguration,configureSteps:e.context.configurationSteps,Configurator:e.context.Configurator,configuratorRef:e.children.configuratorRef})),[n]));const d=function(){const{t:e}=(0,r.useTranslation)(),t=Ze(),{isActive:n,canJumpTo:c,enableNext:i}=(0,q.useSelector)(t,(0,a.useCallback)((e=>({isActive:e.matches("selectKafka"),canJumpTo:Qe.transition(e,"jumpToSelectKafka").changed||e.matches("selectKafka"),enableNext:Qe.transition(e,"next").changed})),[t]));return{name:e("Kafka instance"),isActive:n,component:o().createElement(de,null,o().createElement(Pt,null)),canJumpTo:c,enableNext:i}}(),p=function(){const{t:e}=(0,r.useTranslation)(),t=Ze(),{isActive:n,canJumpTo:c,enableNext:i}=(0,q.useSelector)(t,(0,a.useCallback)((e=>({isActive:e.matches("basicConfiguration"),canJumpTo:Qe.transition(e,"jumpToConfigureConnector").changed||e.matches("basicConfiguration"),enableNext:Qe.transition(e,"next").changed,activeStep:e.context.activeConfigurationStep})),[t]));return{name:e("Common"),isActive:n,component:o().createElement(de,null,o().createElement(ot,null)),canJumpTo:c,enableNext:i}}(),m=function(){const{t:e}=(0,r.useTranslation)(),t=Ze(),{isActive:n,canJumpTo:c,enableNext:i}=(0,q.useSelector)(t,(0,a.useCallback)((e=>({isActive:e.matches("configureConnector"),canJumpTo:Qe.transition(e,"jumpToConfigureConnector").changed||e.matches("configureConnector"),enableNext:Qe.transition(e,"next").changed})),[t]));return{name:e("Connector Specific"),isActive:n,component:o().createElement(de,null,o().createElement(yt,null)),canJumpTo:c,enableNext:i}}();if("saved"===c.value)return null;const g=e=>Qe.transition(c,{type:"jumpToConfigureConnector",subStep:e}).changed,v=[{name:t("Connector"),isActive:c.matches("selectConnector"),component:o().createElement(de,null,o().createElement(bt,null)),canJumpTo:Qe.transition(c,"jumpToSelectConnector").changed||c.matches("selectConnector"),enableNext:Qe.transition(c,"next").changed},d,{name:t("OSD cluster"),isActive:c.matches("selectCluster"),component:o().createElement(de,null,o().createElement(ct,null)),canJumpTo:Qe.transition(c,"jumpToSelectCluster").changed||c.matches("selectCluster"),enableNext:Qe.transition(c,"next").changed},{name:t("Configurations"),isActive:c.matches("basicConfiguration"),canJumpTo:Qe.transition(c,"jumpToSelectCluster").changed||c.matches("basicConfiguration"),steps:(()=>{let e=[p];return s&&void 0!==u&&u&&u.map(((t,n)=>{e.push({name:t,isActive:c.matches("configureConnector")&&l===n,component:o().createElement(de,null,o().createElement(yt,null)),canJumpTo:g(n+1),enableNext:Qe.transition(c,"next").changed})})),(!s&&void 0===u||!1===u)&&e.push(m),e})()},{name:t("Review"),isActive:c.matches("reviewConfiguration"),component:o().createElement(de,null,o().createElement(Lt,null)),canJumpTo:Qe.transition(c,"jumpToReviewConfiguration").changed||c.matches("reviewConfiguration"),enableNext:Qe.transition(c,"next").changed,nextButtonText:"Create connector"}],f=me(v),C=f.reduceRight(((e,t,n)=>t.isActive&&n>e?n:e),-1)+1;return o().createElement(ge,{className:"cos",steps:v,currentStep:C,onNext:()=>i("next"),onBack:()=>i("prev"),onClose:e,onSave:()=>!1,goToStep:e=>{switch(e){case 1:i("jumpToSelectConnector");break;case 2:i("jumpToSelectKafka");break;case 3:i("jumpToSelectCluster");break;case 4:i("jumpToBasicConfiguration");break;case 5:i("jumpToConfigureConnector");break;case f.length:i("jumpToReviewConfiguration");break;default:e<f.length&&i({type:"jumpToConfigureConnector",subStep:e-5})}},goToStepById:(...e)=>console.log("goToStepById",e),goToStepByName:(...e)=>console.log("goToStepByName",e),hasNoBodyPadding:!0})},_t=(e,t)=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){const a=Promise.resolve({steps:!1,Configurator:!1});return new Promise((o=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){try{const a=yield Gt(t,e);yield Vt(a.remoteEntry),o(function(e,t){return(0,A.__awaiter)(this,void 0,void 0,(function*(){yield n.I("default");const a=window[e];yield a.init(n.S.default);const o=(yield window[e].get(t))();return console.log(`loaded federated configurator configuration from ${e}`,o),o.default}))}(a.scope,a.module))}catch(e){o(a)}}))))})),Gt=(e,t)=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){console.log("Fetched federated configurator remotes configuration",e);const n=e[t.id];return console.log(`Candidate configuration for "${t.id}"`,n),n?(a=n)&&a.remoteEntry&&"string"==typeof a.remoteEntry&&a.scope&&"string"==typeof a.scope&&a.module&&"string"==typeof a.module?(console.log("Found a generic configuration for the connector",n),n):(console.log("Couldn't find a valid configuration for the requested connector"),Promise.reject()):(console.log("Couldn't find any configuration for the requested connector"),Promise.reject());var a})),Vt=e=>(0,A.__awaiter)(void 0,void 0,void 0,(function*(){return new Promise(((t,n)=>{const a=document.createElement("script");a.src=e,a.type="text/javascript",a.async=!0,a.onload=()=>{console.log(`Dynamic federated module loaded: ${e}`),document.head.removeChild(a),t()},a.onerror=()=>{console.error(`Dynamic federated module Error: ${e}`),console.log(`Dynamic federated module Removed: ${e}`),document.head.removeChild(a),n()},document.head.appendChild(a)}))}));const Mt=({onSave:e,onClose:t})=>{const{t:n}=(0,r.useTranslation)(),i=(0,K.useConfig)(),s=(0,K.useBasename)(),{connectorsApiBasePath:l,getToken:u}=M(),[d,p]=(0,a.useState)(!1),m=()=>p(!1);return o().createElement(o().Fragment,null,o().createElement(c.PageSection,{variant:"light",hasShadowBottom:!0},o().createElement(c.Breadcrumb,null,o().createElement(c.BreadcrumbItem,{to:null==s?void 0:s.getBasename()},n("Connectors")),o().createElement(c.BreadcrumbItem,{isActive:!0},n("Create connector"))),o().createElement(c.Level,{className:"pf-u-pt-md pf-u-pb-md"},o().createElement(c.Title,{headingLevel:"h1"},n("Create connector")))),o().createElement(c.PageSection,{padding:{default:"noPadding"},style:{zIndex:0},type:"wizard"},o().createElement(Ue,{accessToken:u,connectorsApiBasePath:l,fetchConfigurator:e=>_t(e,(null==i?void 0:i.cos.configurators)||{}),onSave:e},o().createElement(zt,{onClose:()=>p(!0)}),o().createElement(c.Modal,{title:n("Leave page?"),variant:"small",isOpen:d,onClose:m,actions:[o().createElement(c.Button,{key:"confirm",variant:"primary",onClick:t},"Confirm"),o().createElement(c.Button,{key:"cancel",variant:"link",onClick:m},"Cancel")]},n("Changes you have made will be lost and no connector will be created.")))))},Kt=({getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n})=>{const{t:c}=(0,r.useTranslation)(),i=(0,K.useAlert)(),s=(0,E.useHistory)(),l=(0,a.useCallback)((()=>s.push("/")),[s]),u=(0,a.useCallback)((()=>s.push("/create-connector")),[s]),d=(0,a.useCallback)((()=>{null==i||i.addAlert({id:"connector-created",variant:K.AlertVariant.success,title:c("wizard.creation-success")}),l()}),[i,l,c]);return o().createElement(V,{getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n},o().createElement(E.Switch,null,o().createElement(E.Route,{path:"/",exact:!0},o().createElement(ae,{onCreateConnector:u})),o().createElement(E.Route,{path:"/create-connector"},o().createElement(Mt,{onSave:d,onClose:l}))))}},91031:(e,t,n)=>{n.d(t,{g:()=>c});var a=n(75418),o=n.n(a),r=n(21012);const c=()=>o().createElement(r.EmptyState,null,o().createElement(r.EmptyStateIcon,{variant:"container",component:r.Spinner}),o().createElement(r.Title,{size:"lg",headingLevel:"h4"},"Loading"))},78800:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(59093),o=n(4958),r=n(2899),c=n.n(r),i=n(16486),s=n.n(i),l=n(73337),u=n.n(l),d=n(31521);const p={en:o.Z};c().use(u()).use(s()).use(d.initReactI18next).init({backend:{loadPath:`${n.p}locales/{{lng}}/{{ns}}.json`},fallbackLng:"en",load:"all",debug:!0,ns:["public"],defaultNS:"public",nsSeparator:":",keySeparator:".",interpolation:{defaultVariables:void 0,escapeValue:!1,format:(e,t,n)=>{if((0,a.isDate)(e)&&t){const r=n?p[n]:o.Z;return"short"===t?(0,a.format)(e,"P",{locale:r}):"long"===t?(0,a.format)(e,"PPPP",{locale:r}):"relative"===t?(0,a.formatRelative)(e,new Date,{locale:r}):"ago"===t?(0,a.formatDistance)(e,new Date,{locale:r,addSuffix:!0}):(0,a.format)(e,t,{locale:r})}return e}}});const m=c()}}]);
//# sourceMappingURL=670.64ece2b9.js.map
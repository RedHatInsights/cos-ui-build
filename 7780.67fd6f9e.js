"use strict";(self.webpackChunkcos_ui=self.webpackChunkcos_ui||[]).push([[7780],{53603:(e,t,n)=>{n.d(t,{e:()=>Cn});var a=n(70655),r=n(35898),o=n.n(r),c=n(96486),i=n.n(c),l=n(88693),s=n(22908);var d=n(75418),u=n.n(d),p=n(31521),m=n(21012),g=n(91999);const v=({name:e,status:t})=>{const n=function(e){var t;const{t:n}=(0,p.useTranslation)(),a=[{value:E.Ready,label:n("Running")},{value:E.Failed,label:n("Failed")},{value:E.Assigning,label:n("Creation pending")},{value:E.Assigned,label:n("Creation in progress")},{value:E.Updating,label:n("Creation in progress")},{value:E.Provisioning,label:n("Creation in progress")},{value:E.Deleting,label:n("Deleting")},{value:E.Deleted,label:n("Deleted")}];return(null===(t=a.find((t=>t.value===e)))||void 0===t?void 0:t.label)||e}(t);return u().createElement(m.Flex,null,u().createElement(m.FlexItem,{spacer:{default:"spacerSm"}},u().createElement(f,{name:e,status:t})),u().createElement(m.FlexItem,null,n))},f=({name:e,status:t})=>{switch(null==t?void 0:t.toLowerCase()){case"ready":return u().createElement(g.CheckCircleIcon,{className:"cos--connectors__table--icon--completed"});case"failed":return u().createElement(g.ExclamationCircleIcon,{className:"cos--connectors__table--icon--failed"});case"accepted":return u().createElement(g.PendingIcon,null);case"provisioning":case"preparing":return u().createElement(m.Spinner,{size:"md","aria-label":e,"aria-valuetext":"Creation in progress"});case"deprovision":case"deleted":return null}return u().createElement(g.PendingIcon,null)};var E;!function(e){e.Ready="ready",e.Failed="failed",e.Assigning="assigning",e.Assigned="assigned",e.Updating="updating",e.Provisioning="provisioning",e.Deleting="deleting",e.Deleted="deleted"}(E||(E={}));var C=n(91031);const h="paginatedApi";var y;!function(e){e.Overview="overview",e.Configuration="configuration"}(y||(y={}));const b=(0,d.createContext)(null),S=({getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n,children:a})=>u().createElement(b.Provider,{value:{getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n}},a),T=()=>{const e=(0,d.useContext)(b);if(!e)throw new Error("useAppContext must be used inside an AppContextProvider");return Object.assign({},e)};var k=n(98068),I=n(9980),x=n(98823);const w=({error:e})=>u().createElement("div",{role:"alert"},u().createElement("p",null,"Something went wrong:"),u().createElement("pre",null,e.message)),A=({children:e})=>u().createElement(x.ErrorBoundary,{FallbackComponent:w,resetKeys:[Date.now()]},e),P=(e,t)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const r=Promise.resolve({steps:!1,Configurator:!1});return new Promise((o=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){try{const r=yield B(t,e);yield O(r.remoteEntry),o(function(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){yield n.I("default");const a=window[e];yield a.init(n.S.default);const r=(yield window[e].get(t))();return console.log(`loaded federated configurator configuration from ${e}`,r),r.default}))}(r.scope,r.module))}catch(e){o(r)}}))))})),B=(e,t)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){console.log("Fetched federated configurator remotes configuration",e);const n=e[t.id]||e[t.id.split("-")[0]];return console.log(`Candidate configuration for "${t.id}"`,n),n?(a=n)&&a.remoteEntry&&"string"==typeof a.remoteEntry&&a.scope&&"string"==typeof a.scope&&a.module&&"string"==typeof a.module?(console.log("Found a generic configuration for the connector",n),n):(console.log("Couldn't find a valid configuration for the requested connector"),Promise.reject()):(console.log("Couldn't find any configuration for the requested connector"),Promise.reject());var a})),O=e=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){return new Promise(((t,n)=>{const a=document.createElement("script");a.src=e,a.type="text/javascript",a.async=!0,a.onload=()=>{console.log(`Dynamic federated module loaded: ${e}`),document.head.removeChild(a),t()},a.onerror=()=>{console.error(`Dynamic federated module Error: ${e}`),console.log(`Dynamic federated module Removed: ${e}`),document.head.removeChild(a),n()},document.head.appendChild(a)}))}));const N=e=>{const t={};return e.forEach(((e,n)=>{t[n]=e})),t},_=({editMode:e,configuration:t,changeIsValid:n,onUpdateConfiguration:a})=>{var r;const{t:o}=(0,p.useTranslation)();return u().createElement(u().Fragment,null,u().createElement(m.Title,{headingLevel:"h3",size:m.TitleSizes["2xl"],className:"pf-u-pr-md pf-u-pb-md"},o("Common")),u().createElement(m.Form,null,u().createElement(m.FormGroup,{label:o("Connector name"),isRequired:!0,fieldId:"connector-name",labelIcon:u().createElement(m.Popover,{bodyContent:u().createElement("p",null,o("Unique name for the connector."))},u().createElement("button",{type:"button","aria-label":"More info for name field.",onClick:e=>e.preventDefault(),"aria-describedby":"simple-form-name-01",className:"pf-c-form__group-label-help"},u().createElement(g.HelpIcon,{noVerticalAlign:!0})))},e?u().createElement(m.TextInput,{value:t.name,onChange:e=>(e=>{a("common",Object.assign(Object.assign({},t),{name:e})),n(""!==e)})(e),id:"connector-name"}):u().createElement(m.Text,{component:m.TextVariants.p},t.name)),u().createElement(m.FormGroup,{label:o("Service account"),fieldId:"service-account"},u().createElement(u().Fragment,null,u().createElement(m.FormGroup,{label:o("client-id"),isRequired:!0,fieldId:"clientId"},u().createElement(m.ClipboardCopy,{isReadOnly:!0,hoverTip:"copy",clickTip:"Copied"},null===(r=null==t?void 0:t.service_account)||void 0===r?void 0:r.client_id))))))};var D=n(75220),j=n(71322);const F=new(n.n(j)())({allErrors:!0,useDefaults:!1,strict:"log",strictSchema:!1});function q(e){const t=F.compile(e);return e=>{var n;return t(e),(null===(n=t.errors)||void 0===n?void 0:n.length)?{details:t.errors}:null}}var L=n(39443),R=n(38524),z=n(39494),G=n.n(z);const V=(e,t)=>void 0!==t?u().createElement(p.Translation,null,(n=>u().createElement(m.Popover,{bodyContent:t},u().createElement("button",{type:"button","aria-label":n("More info for {{name}}",{name:e}),onClick:e=>e.preventDefault(),"aria-describedby":"form-group-label-info",className:"pf-c-form__group-label-help"},u().createElement(g.HelpIcon,{noVerticalAlign:!0}))))):void 0;class M extends(G()){constructor(e,t){super(e,t)}getField(e){const t=super.getField(e),{description:n,example:r,title:o}=t,c=(0,a.__rest)(t,["description","example","title"]);return Object.assign({helperText:(i=r,void 0!==i?`Example: ${i}`:void 0),labelIcon:V(o,n),title:o},c);var i}}const H=new D.Resolver,K=({schema:e,configuration:t,onChange:n,editCase:r})=>{e.type=e.type||"object";try{delete e.properties.steps}catch(e){}const o=q(e),c=new M(e,o),{required:l}=c.schema;const s=(e,t)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const r=JSON.parse(JSON.stringify(e));let o=[];if(void 0!==r.data_shape){o=yield function(){var e;return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=JSON.parse(JSON.stringify(c));let n=[];for(const[a]of Object.entries(null===(e=t.schema.properties.data_shape)||void 0===e?void 0:e.properties)){const e=yield H.resolve(t.schema,{jsonPointer:`#/$defs/data_shape/${a}`}),r=yield e.result;n=Object.assign(Object.assign({},n),{[a]:r})}return n}))}();const{data_shape:e}=r;Object.keys(e).map((t=>{var n,a;const c=null===(a=null===(n=o[t].properties)||void 0===n?void 0:n.format)||void 0===a?void 0:a.default;i().isEmpty(e[t])&&(r.data_shape[t]={format:c})}))}const s={};for(const[e,t]of Object.entries(r))for(const n in l)if(e===l[n]&&void 0!==t){const n={[e]:t};Object.assign(s,n)}const d=(e,t)=>{const n=Object.keys(e).sort(),a=t.slice().sort();return JSON.stringify(n)===JSON.stringify(a)};r.data_shape,t=d(s,l),n(r,t||!1)}));return u().createElement(m.Grid,{hasGutter:!0},u().createElement(J,{schema:c,model:t,onChangeModel:e=>s(e,!1),className:"connector-specific pf-c-form pf-m-9-col-on-lg"},Object.keys(c.schema.properties).map((e=>!["processors","error_handler"].includes(e)&&u().createElement(R.AutoField,{key:e,name:e,disabled:r&&i().find(c.schema.properties[e].oneOf,{format:"password"})})))))};const J=function e(t){class n extends(L.AutoForm.Auto(t)){onChange(e,t){if(""===t)return super.onChange(e,void 0);super.onChange(e,t)}}return n.Auto=e,n}(L.ValidatedQuickForm),$=({editMode:e,schema:t,configuration:n,changeIsValid:a,onUpdateConfiguration:r})=>{const{t:o}=(0,p.useTranslation)(),c=JSON.parse(JSON.stringify(n));Object.keys(c).map((e=>{i().isEmpty(c[e])&&(c[e]="")}));return u().createElement(u().Fragment,null,u().createElement(m.Title,{headingLevel:"h3",size:m.TitleSizes["2xl"],className:"pf-u-pr-md pf-u-pb-md"},o("Connector specific")),e?u().createElement(K,{schema:t,configuration:c||{},onChange:(e,t)=>{r("connector",e),a(t)},editCase:!0}):u().createElement(m.Form,null,Object.entries(t.properties).filter((([e,t])=>!["object","array"].includes(t.type)||"data_shape"===e)).map((([e,n])=>u().createElement(m.FormGroup,{key:e,label:n.title||i().capitalize(e.replace("_"," ")),fieldId:e,isRequired:t.required.includes(e),labelIcon:u().createElement(m.Popover,{bodyContent:u().createElement("p",null,n.description?n.description:i().capitalize(e.replace("_"," ")))},u().createElement("button",{type:"button","aria-label":"More info for name field",onClick:e=>e.preventDefault(),"aria-describedby":"simple-form-name-01",className:"pf-c-form__group-label-help"},u().createElement(g.HelpIcon,{noVerticalAlign:!0})))},"data_shape"===e?u().createElement(W,{data:c[e]}):u().createElement(m.Text,{component:m.TextVariants.p},i().isObject(c[e])?JSON.stringify(c[e]):c[e]))))))},W=({data:e})=>u().createElement(u().Fragment,null,Object.keys(e).map((t=>u().createElement(m.FormGroup,{key:t,label:i().upperFirst(t),fieldId:t},u().createElement(m.Text,{component:m.TextVariants.p},e[t].format))))),U=({editMode:e,schema:t,configuration:n,changeIsValid:a,onUpdateConfiguration:r})=>{var o;const[c,l]=(0,d.useState)(!1),[s,v]=(0,d.useState)(),[f,E]=(0,d.useState)(),{t:C}=(0,p.useTranslation)(),h=()=>{l(!1)};(0,d.useEffect)((()=>(E(Object.keys(n)[0]),"dead_letter_queue"!==Object.keys(n)[0]||i().isEmpty(n.dead_letter_queue)||v(n.dead_letter_queue[Object.keys(n.dead_letter_queue)[0]]),()=>{})),[n]);const y=q(t),b=new z.JSONSchemaBridge(t,y),{error_handler:S}=null===(o=b.schema)||void 0===o?void 0:o.properties,T=S.oneOf.map((e=>{const t=Object.keys(e.properties);return u().createElement(m.SelectOption,{key:t[0],value:t[0]})}));return u().createElement(u().Fragment,null,u().createElement(m.Title,{headingLevel:"h3",size:m.TitleSizes["2xl"],className:"pf-u-pr-md pf-u-pb-md"},"Error handling"),u().createElement(m.Form,null,u().createElement(m.FormGroup,{label:C("Error handler"),fieldId:"error-handler_strategy",className:"error-handler_strategy"},e?u().createElement(m.Select,{variant:m.SelectVariant.single,"aria-label":"Select Error handler",onToggle:()=>l((e=>!e)),onSelect:(e,t,n)=>{n?h():(l(!1),v(""),E(t),a("dead_letter_queue"!==t||!!s),r("error",{[t]:{}}))},selections:f,isOpen:c,placeholderText:"Select type"},T):u().createElement(m.Text,{component:m.TextVariants.p},f)),"dead_letter_queue"===f&&u().createElement(m.FormGroup,{label:"Dead Letter Topic Name",isRequired:!0,fieldId:"topic",labelIcon:u().createElement(m.Popover,{bodyContent:u().createElement("p",null,"The name of the Kafka topic used as dead letter queue")},u().createElement("button",{type:"button","aria-label":"More info for name field",onClick:e=>e.preventDefault(),"aria-describedby":"simple-form-name-01",className:"pf-c-form__group-label-help"},u().createElement(g.HelpIcon,{noVerticalAlign:!0})))},e?u().createElement(m.TextInput,{value:s,onChange:e=>{v(e),a(!!e),r("error",{dead_letter_queue:{topic:e}})},id:"topic"}):u().createElement(m.Text,{component:m.TextVariants.p},s))))},Q=(e,t)=>((e,t)=>{let n=[];return i().each(e,((e,a)=>{void 0!==t&&t[a]!==e&&t[a]!=={}&&""!==e&&n.push(a)})),n})(e,t).reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:e[n]})),{}),Z=({onSave:e,editMode:t,updateEditMode:n,connectorData:r,connectorTypeDetails:c})=>{var s,g;const{t:v}=(0,p.useTranslation)(),f=(0,I.useAlert)(),E=(0,I.useConfig)(),{connectorsApiBasePath:h,getToken:y}=T(),[b,S]=(0,d.useState)(!1),[k,x]=(0,d.useState)(!1),[w,B]=(0,d.useState)(0),[O,D]=(0,d.useState)({}),[j,F]=(0,d.useState)(),[q,L]=(0,d.useState)({}),[R,z]=(0,d.useState)(),[G,V]=(0,d.useState)(!0),M=()=>S(!1),H=(0,d.useCallback)(((e,t)=>{switch(x(!0),e){case"common":D(t);break;case"connector":F(t);break;case"error":L(t)}}),[D,F,L]),K=(0,d.useCallback)((e=>{null==f||f.addAlert({id:"connectors-table-error",variant:m.AlertVariant.danger,title:v("something_went_wrong"),description:e})}),[f,v]),J=(0,d.useCallback)((()=>{n(!1),null==f||f.addAlert({id:"connector-created",variant:m.AlertVariant.success,title:v("edit.edit-success")}),e()}),[f,v,n,e]),W=()=>{var e;const{name:t,service_account:n}=r;D({name:t,service_account:n}),F(null==r?void 0:r.connector),L(null===(e=null==r?void 0:r.connector)||void 0===e?void 0:e.error_handler)},Z=()=>{W(),n(!1),M()},X=(0,d.useCallback)(((e,t)=>{F(e),V(t)}),[F,V]);let ee;(0,d.useEffect)((()=>{W(),(0,a.__awaiter)(void 0,void 0,void 0,(function*(){try{ee=yield P(c,(null==E?void 0:E.cos.configurators)||{}),z(ee)}catch(e){console.log("No configurator provided.",e)}}))}),[]);return u().createElement(u().Fragment,null,u().createElement(m.PageSection,{variant:m.PageSectionVariants.light},u().createElement(m.Grid,{style:{paddingBottom:"50px"}},u().createElement(m.GridItem,{span:3},u().createElement("div",null,u().createElement(m.Tabs,{activeKey:w,onSelect:(e,t)=>{B(t)},isVertical:!0},u().createElement(m.Tab,{eventKey:0,title:u().createElement(m.TabTitleText,null,v("Common"))}),r.connector_type_id.includes("debezium")&&R&&R.steps&&R.steps.map(((e,t)=>u().createElement(m.Tab,{key:e,eventKey:t+1,title:u().createElement(m.TabTitleText,null,e)}))),!r.connector_type_id.includes("debezium")&&u().createElement(u().Fragment,null,u().createElement(m.Tab,{eventKey:1,title:u().createElement(m.TabTitleText,null,v("Connector specific"))}),u().createElement(m.Tab,{eventKey:2,title:u().createElement(m.TabTitleText,null,v("Error handling"))}))))),u().createElement(m.GridItem,{span:9},u().createElement(m.Grid,null,u().createElement(m.GridItem,{span:10},0===w&&u().createElement(A,null,!i().isEmpty(O)&&u().createElement(_,{editMode:t,configuration:O,changeIsValid:V,onUpdateConfiguration:H})),r.connector_type_id.includes("debezium")&&(null==R?void 0:R.Configurator)&&u().createElement(A,null,u().createElement(u().Fragment,null,u().createElement(m.Title,{headingLevel:"h3",size:m.TitleSizes["2xl"],className:"pf-u-pr-md pf-u-pb-md"},null==R?void 0:R.steps[w-1]),u().createElement(u().Suspense,{fallback:C.g},u().createElement(Y,{Configurator:null==R?void 0:R.Configurator,isEditMode:t,configuration:j,updateFedConfiguration:X,connector:c,step:w})))),!r.connector_type_id.includes("debezium")&&1===w&&u().createElement(A,null,u().createElement($,{editMode:t,schema:null===(s=c)||void 0===s?void 0:s.schema,configuration:j,changeIsValid:V,onUpdateConfiguration:H})),!r.connector_type_id.includes("debezium")&&2===w&&u().createElement(A,null,u().createElement(U,{editMode:t,schema:null===(g=c)||void 0===g?void 0:g.schema,configuration:q,changeIsValid:V,onUpdateConfiguration:H}))),u().createElement(m.GridItem,{span:2,className:"pf-u-pl-md"},!t&&u().createElement(m.Button,{variant:"primary",onClick:()=>{n(!t)}},v("Edit Properties"))))))),t&&u().createElement(m.PageSection,{className:"pf-u-p-md pf-u-box-shadow-md-top configuration-page_footer",hasShadowTop:!0,variant:"light"},u().createElement(m.Button,{variant:"primary",className:"pf-u-mr-md pf-u-mb-sm",onClick:()=>{(({accessToken:e,connectorsApiBasePath:t,connectorUpdate:n,connectorId:a,updatedName:r})=>{const c=new l.ConnectorsApi(new l.Configuration({accessToken:e,basePath:t}));return(e,t)=>{const l=o().CancelToken.source();return c.patchConnector(a,Object.assign(Object.assign({},r&&{name:r}),!i().isEmpty(n)&&{connector:Object.assign({},n)}),{cancelToken:l.token,headers:{"Content-type":"application/merge-patch+json"}}).then((()=>{e()})).catch((e=>{o().isCancel(e)||t(e.response.data.reason)})),()=>{l.cancel("Operation canceled by the user.")}}})(Object.assign({accessToken:y,connectorsApiBasePath:h,connectorUpdate:Object.assign({},Q(Object.assign(Object.assign({},j instanceof Map?N(j):j),{error_handler:q}),r.connector)),connectorId:r.id},O.name!==r.name&&{updatedName:O.name}))(J,K)},isDisabled:!G},v("Save")),u().createElement(m.Button,{variant:"secondary",onClick:k?()=>S(!0):Z},v("Cancel"))),u().createElement(m.Modal,{title:v("Leave page?"),variant:"small",isOpen:b,onClose:M,actions:[u().createElement(m.Button,{key:"confirm",variant:"primary",onClick:Z},v("Leave")),u().createElement(m.Button,{key:"cancel",variant:"link",onClick:M},v("Cancel"))]},v("Changes you made to the connector properties will not be saved.")))},Y=({Configurator:e,connector:t,configuration:n,updateFedConfiguration:a,isEditMode:r,step:o})=>{let c;return n instanceof Map?c=new Map(n):(c=JSON.parse(JSON.stringify(n)),Object.keys(c).map((e=>{i().isEmpty(c[e])&&(c[e]="")}))),u().createElement(e,{activeStep:o-1,connector:t,isViewMode:!r,configuration:c instanceof Map?c:new Map(Object.entries(c)),onChange:a})},X=(e,t)=>u().createElement(u().Fragment,null,t&&u().createElement(u().Fragment,null,u().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},e),u().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},t))),ee=({connectorData:e})=>{var t,n,a;return u().createElement(m.PageSection,{variant:m.PageSectionVariants.light},u().createElement(m.TextContent,null,u().createElement(m.TextList,{component:m.TextListVariants.dl},X("Connector id",null==e?void 0:e.id),X("Connector type",null==e?void 0:e.connector_type_id),X("Kafka_instance",null===(t=null==e?void 0:e.kafka)||void 0===t?void 0:t.id),X("Bootstrap server",null===(n=null==e?void 0:e.kafka)||void 0===n?void 0:n.url),X("Targeted OSD Cluster",null===(a=null==e?void 0:e.deployment_location)||void 0===a?void 0:a.cluster_id),X("Owner",null==e?void 0:e.owner),X("Time created",null==e?void 0:e.created_at),X("Time updated",null==e?void 0:e.modified_at))))},te=e=>e.includes("&")?e.substr(1,e.indexOf("&")-1):e.substr(1),ne=({onSave:e})=>{let{id:t}=(0,k.useParams)(),{hash:n}=(0,k.useLocation)();const a=(0,k.useHistory)(),r=(0,I.useAlert)(),{t:c}=(0,p.useTranslation)(),{connectorsApiBasePath:i,getToken:s}=T(),[g,v]=(0,d.useState)(te(n)),[f,E]=(0,d.useState)(),[h,b]=(0,d.useState)(),[S,x]=(0,d.useState)(),w=(0,d.useCallback)((e=>{b(e)}),[]),A=(0,d.useCallback)((e=>{x(e)}),[]),P=(0,d.useCallback)((e=>{E(e)}),[E]),B=(0,d.useCallback)((e=>{null==r||r.addAlert({id:"connectors-table-error",variant:m.AlertVariant.danger,title:c("something_went_wrong"),description:e})}),[r,c]);(0,d.useEffect)((()=>{n.includes(y.Configuration)&&E(!0)}),[]),(0,d.useEffect)((()=>{(({accessToken:e,connectorsApiBasePath:t,connectorId:n})=>{const a=new l.ConnectorsApi(new l.Configuration({accessToken:e,basePath:t}));return(e,t)=>{const r=o().CancelToken.source();return a.getConnector(n,{cancelToken:r.token}).then((t=>{e(t.data)})).catch((e=>{o().isCancel(e)||t(e.response.data.reason)})),()=>{r.cancel("Operation canceled by the user.")}}})({accessToken:s,connectorsApiBasePath:i,connectorId:t})(w,B)}),[t]),(0,d.useEffect)((()=>{v(te(n))}),[n]),(0,d.useEffect)((()=>{(null==h?void 0:h.connector_type_id)&&(({accessToken:e,connectorsApiBasePath:t,connectorTypeId:n})=>{const a=new l.ConnectorTypesApi(new l.Configuration({accessToken:e,basePath:t}));return e=>{const t=o().CancelToken.source();return a.getConnectorTypeByID(n,{cancelToken:t.token}).then((t=>{e(t.data)})).catch((e=>{o().isCancel(e)||console.log("Error:",e.response.data.reason)})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:s,connectorsApiBasePath:i,connectorTypeId:null==h?void 0:h.connector_type_id})(A)}),[h]);return u().createElement(u().Fragment,null,!h&&u().createElement(C.g,null),h&&u().createElement(u().Fragment,null,u().createElement(ae,{connectorData:h}),u().createElement(m.PageSection,{padding:{default:"noPadding"},style:{zIndex:0},variant:m.PageSectionVariants.light},u().createElement(m.Tabs,{activeKey:g,onSelect:(e,t)=>{v(t),a.push(`#${t}`)},className:"connector_detail-tabs"},u().createElement(m.Tab,{eventKey:y.Overview,title:u().createElement(m.TabTitleText,null,c("Overview"))},u().createElement(ee,{connectorData:h})),u().createElement(m.Tab,{eventKey:y.Configuration,title:u().createElement(m.TabTitleText,null,c("Configuration"))},S?u().createElement(Z,{onSave:e,editMode:f||!1,updateEditMode:P,connectorData:h,connectorTypeDetails:S}):u().createElement(C.g,null))))))},ae=({connectorData:e})=>{var t;const{t:n}=(0,p.useTranslation)(),a=(0,I.useBasename)();return u().createElement(m.PageSection,{variant:"light",hasShadowBottom:!0},u().createElement(m.Breadcrumb,null,u().createElement(m.BreadcrumbItem,{to:null==a?void 0:a.getBasename()},n("Connectors")),u().createElement(m.BreadcrumbItem,{isActive:!0},null==e?void 0:e.name)),u().createElement(m.Level,{className:"pf-u-pt-md pf-u-pb-md"},u().createElement(m.LevelItem,null,u().createElement(m.Level,null,u().createElement(m.Title,{headingLevel:"h1",className:"pf-u-pr-md"},null==e?void 0:e.name),u().createElement(v,{name:null==e?void 0:e.name,status:null===(t=null==e?void 0:e.status)||void 0===t?void 0:t.state}))),u().createElement(m.LevelItem,null)))},re=({children:e,connector:t,onClose:n})=>{var a;return u().createElement(m.Drawer,{isExpanded:void 0!==t},u().createElement(m.DrawerContent,{panelContent:t?u().createElement(oe,{name:t.name,id:t.id,bootstrapServer:t.kafka.url,kafkaId:t.kafka.id,owner:t.owner,cluster:t.deployment_location.cluster_id,createdAt:new Date(t.created_at),modifiedAt:new Date(t.modified_at),status:null===(a=t.status)||void 0===a?void 0:a.state,onClose:n}):void 0},e))},oe=({name:e,id:t,bootstrapServer:n,kafkaId:a,owner:r,cluster:o,createdAt:c,modifiedAt:i,status:l,onClose:s})=>{const{t:g}=(0,p.useTranslation)(),[f,E]=(0,d.useState)(0),C=(e,t)=>u().createElement(u().Fragment,null,t&&u().createElement(u().Fragment,null,u().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},e),u().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},t)));return u().createElement(m.DrawerPanelContent,{widths:{default:"width_50"}},u().createElement(m.DrawerHead,null,u().createElement(m.TextContent,null,u().createElement(m.Text,{component:m.TextVariants.small,className:"connector-drawer__header-text"},"Connector name"),u().createElement(m.Flex,null,u().createElement(m.FlexItem,null,u().createElement(m.Title,{headingLevel:"h2",size:m.TitleSizes.xl,className:"connector-drawer__header-title"},e)),u().createElement(m.FlexItem,{spacer:{default:"spacerSm"}},u().createElement(v,{name:e,status:l})))),u().createElement(m.DrawerActions,null,u().createElement(m.DrawerCloseButton,{onClick:s}))),u().createElement(m.DrawerPanelBody,null,u().createElement(m.Tabs,{activeKey:f,onSelect:(e,t)=>{E(t)}},u().createElement(m.Tab,{eventKey:0,title:u().createElement(m.TabTitleText,null,g("Details"))},u().createElement("div",{className:"connector-drawer__tab-content"},u().createElement(m.TextContent,null,u().createElement(m.TextList,{component:m.TextListVariants.dl},C("Connector",e),C("Connector Id",t),C("Bootstrap server",n),C("Kafka_instance",a),C("Targeted OSD Cluster",o),C("Owner",r),C("Time created",u().createElement("time",{title:g("{{date}}",{date:c}),dateTime:c.toISOString()},g("{{ date, ago }}",{date:c}))),C("Time updated",u().createElement("time",{title:g("{{date}}",{date:i}),dateTime:i.toISOString()},g("{{ date, ago }}",{date:i}))))))))))};var ce=n(55706),ie=n(86445);const le=({children:e})=>{const{t}=(0,p.useTranslation)();return u().createElement(ie.TableComposable,{"aria-label":"Sortable Table",className:(0,ce.css)("connectors-table-view__table")},u().createElement(ie.Thead,null,u().createElement(ie.Tr,null,u().createElement(ie.Th,null,t("Name")),u().createElement(ie.Th,null,t("Connector")),u().createElement(ie.Th,null,t("Status")))),u().createElement(ie.Tbody,null,e))},se=({connectorId:e,name:t,type:n,status:a,isSelected:r,canStart:o,canStop:c,canDelete:i,onStart:l,onStop:s,onDelete:d,openDetail:g,onSelect:f})=>{const{t:E}=(0,p.useTranslation)(),C=[{title:"Start",onClick:l,isDisabled:!o},{title:"Stop",onClick:s,isDisabled:!c},{title:"Delete",onClick:d,isDisabled:!i},{title:"Edit",onClick:()=>g("configuration"),isDisabled:!1},{isSeparator:!0},{title:"Details",onClick:f}];return u().createElement(ie.Tr,{onClick:e=>{var t;"button"!==(null===(t=e.target)||void 0===t?void 0:t.type)&&f()},className:(0,ce.css)("pf-c-table-row__item","pf-m-selectable",r&&"pf-m-selected")},u().createElement(ie.Td,{dataLabel:E("Name")},u().createElement(m.Text,{component:m.TextVariants.a,isVisitedLink:!0,onClick:()=>g("overview")},t)),u().createElement(ie.Td,{dataLabel:E("Type")},n),u().createElement(ie.Td,{dataLabel:E("Status")},u().createElement(v,{name:t,status:a})),u().createElement(ie.Td,{actions:{items:C},"data-testid":`actions-for-${e}`}))},de=({itemCount:e,page:t,perPage:n,isCompact:a=!1,onChange:r})=>u().createElement(m.Pagination,{itemCount:e,page:t,perPage:n,perPageOptions:[{title:"1",value:1},{title:"5",value:5},{title:"10",value:10}],onSetPage:(e,t)=>r(t,n),onPerPageSelect:(e,n)=>r(t,n),variant:a?"top":"bottom",isCompact:a});var ue=n(3889),pe=n.n(ue);const me=(e,t=200)=>{if(isNaN(t))throw new TypeError("durationInMs for debounce should be a number");if("function"!=typeof e)throw new TypeError("fnToDebounce should be a function");return(0,d.useCallback)(pe()(e,t),[e,t])},ge=({itemCount:e,page:t,perPage:n,onChange:a})=>{const{t:r}=(0,p.useTranslation)(),o=(0,d.useRef)(null),c=me(a,1e3),i=u().createElement(u().Fragment,null,u().createElement(m.ToolbarItem,null,u().createElement(m.InputGroup,null,u().createElement(m.TextInput,{name:"name",id:"name",type:"search","aria-label":"filter by connector name",onChange:e=>c({size:n,page:1,name:e}),ref:o}),u().createElement(m.Button,{variant:"control","aria-label":"search button for search input"},u().createElement(g.SearchIcon,null))))),l=u().createElement(u().Fragment,null,u().createElement(m.ToolbarToggleGroup,{toggleIcon:u().createElement(g.FilterIcon,null),breakpoint:"xl"},i),u().createElement(m.ToolbarGroup,{variant:"icon-button-group"},u().createElement(m.ToolbarItem,null,u().createElement(k.NavLink,{className:"pf-c-button pf-m-primary",to:"/create-connector"},r("createConnectorInstance")))),u().createElement(m.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},u().createElement(de,{itemCount:e,page:t,perPage:n,onChange:a,isCompact:!0})));return u().createElement(m.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl",className:"pf-u-p-md"},u().createElement(m.ToolbarContent,null,l))},ve=({connectorName:e,onCancel:t,onConfirm:n,showDialog:a})=>{const{t:r}=(0,p.useTranslation)(),[o,c]=(0,d.useState)(""),i=o===e;return u().createElement(m.Modal,{variant:m.ModalVariant.small,title:r("Delete connector"),titleIconVariant:"warning",isOpen:a,onClose:t,actions:[u().createElement(m.Button,{key:"confirm",variant:"danger",isDisabled:!i,onClick:()=>{c(""),n()}},r("Delete")),u().createElement(m.Button,{key:"cancel",variant:"link",onClick:()=>{c(""),t()}},r("Cancel"))]},u().createElement(m.Stack,null,u().createElement(m.StackItem,null,u().createElement(p.Trans,null,"Connector ",u().createElement("strong",null,{connectorName:e})," will be deleted.")),u().createElement(m.StackItem,null,u().createElement(p.Trans,null,"Type ",u().createElement("strong",null,{connectorName:e})," to confirm the deletion.")),u().createElement(m.StackItem,null,u().createElement(m.TextInput,{value:o,type:"text",onChange:c,"aria-label":"name input"}))))},fe=()=>{const{t:e}=(0,p.useTranslation)();return u().createElement(m.EmptyState,{variant:m.EmptyStateVariant.full},u().createElement(m.EmptyStateIcon,{icon:g.ExclamationCircleIcon}),u().createElement(m.Title,{headingLevel:"h1",size:m.TitleSizes.lg},e("Something went wrong")),u().createElement(m.EmptyStateBody,null,e("There was a problem processing the request. Please try again.")))};var Ee=n(34558);const Ce=({onHelp:e,onCreate:t})=>{const{t:n}=(0,p.useTranslation)();return u().createElement(m.EmptyState,{variant:m.EmptyStateVariant.xl,className:(0,ce.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},u().createElement(m.EmptyStateIcon,{icon:Ee.ZP}),u().createElement(m.Title,{headingLevel:"h1",size:m.TitleSizes["4xl"]},n("Welcome to Managed Connectors")),u().createElement(m.EmptyStateBody,null,u().createElement(p.Trans,null,"For help getting started, access the"," ",u().createElement(m.Button,{variant:m.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:e},"quick start guide."))),u().createElement(m.Button,{variant:"primary",onClick:t},n("Create Connector")))},he=({onClear:e})=>{const{t}=(0,p.useTranslation)();return u().createElement(m.EmptyState,{variant:m.EmptyStateVariant.large,className:(0,ce.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},u().createElement(m.EmptyStateIcon,{icon:g.SearchIcon}),u().createElement(m.Title,{headingLevel:"h2",size:m.TitleSizes.xl},t("No results found")),u().createElement(m.EmptyStateBody,null,u().createElement(p.Trans,null,"No results match the filter criteria."," ",u().createElement(m.Button,{variant:m.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:e},t("Clear all filters"))," ","to show results.")))};var ye=n(38801),be=n(41428),Se=n(66310);const Te=(0,Se.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",connector:{}},{events:{"connector.start":()=>({}),"connector.stop":()=>({}),"connector.remove":()=>({}),"connector.select":()=>({}),"connector.actionSuccess":e=>e,"connector.actionError":e=>e},actions:{notifySuccess:()=>({}),notifyError:()=>({}),notifySelect:({connector:e})=>({connector:e})}}),ke=Te.assign(((e,t)=>({connector:t.connector})),"connector.actionSuccess"),Ie=Te.createMachine({id:"connector",initial:"verify",context:Te.initialContext,states:{verify:{always:[{target:"ready",cond:"isReady"},{target:"stopped",cond:"isStopped"},{target:"deleted",cond:"isDeleted"}]},ready:{on:{"connector.stop":"stoppingConnector","connector.remove":"deletingConnector"}},stopped:{on:{"connector.start":"startingConnector","connector.remove":"deletingConnector"}},deleted:{},startingConnector:{invoke:{id:"startingConnectorCb",src:e=>(({accessToken:e,connectorsApiBasePath:t,connector:n})=>{const a=new l.ConnectorsApi(new l.Configuration({accessToken:e,basePath:t}));return e=>{const t=o().CancelToken.source();return a.patchConnector(n.id,{desired_state:l.ConnectorDesiredState.Ready},{cancelToken:t.token,headers:{"Content-type":"application/merge-patch+json"}}).then((t=>{e({type:"connector.actionSuccess",connector:t.data})})).catch((t=>{o().isCancel(t)||e({type:"connector.actionError",error:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:e.connector})},on:{"connector.actionSuccess":{target:"verify",actions:[ke,"notifySuccess"]},"connector.actionError":{target:"verify",actions:"notifyError"}}},stoppingConnector:{invoke:{id:"stoppingConnectorCb",src:e=>(({accessToken:e,connectorsApiBasePath:t,connector:n})=>{const a=new l.ConnectorsApi(new l.Configuration({accessToken:e,basePath:t}));return e=>{const t=o().CancelToken.source();return a.patchConnector(n.id,{desired_state:l.ConnectorDesiredState.Stopped},{cancelToken:t.token,headers:{"Content-type":"application/merge-patch+json"}}).then((t=>{e({type:"connector.actionSuccess",connector:t.data})})).catch((t=>{o().isCancel(t)||e({type:"connector.actionError",error:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:e.connector})},on:{"connector.actionSuccess":{target:"verify",actions:["updateState","notifySuccess"]},"connector.actionError":{target:"verify",actions:"notifyError"}}},deletingConnector:{invoke:{id:"deletingConnectorCb",src:e=>(({accessToken:e,connectorsApiBasePath:t,connector:n})=>{const a=new l.ConnectorsApi(new l.Configuration({accessToken:e,basePath:t}));return e=>{const t=o().CancelToken.source();return a.deleteConnector(n.id,{cancelToken:t.token}).then((()=>{e({type:"connector.actionSuccess",connector:Object.assign(Object.assign({},n),{status:"deleting",desired_state:"deleted"})})})).catch((t=>{o().isCancel(t)||e({type:"connector.actionError",error:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:e.connector})},on:{"connector.actionSuccess":{target:"deleted",actions:["updateState","notifySuccess"]},"connector.actionError":{target:"verify",actions:"notifyError"}}}},on:{"connector.select":{actions:"notifySelect"}}},{guards:{isReady:e=>"ready"===e.connector.desired_state,isStopped:e=>"stopped"===e.connector.desired_state,isDeleted:e=>"deleted"===e.connector.desired_state},actions:{notifySuccess:(0,be.sendParent)("actionSuccess"),notifyError:(0,be.sendParent)("actionFailure"),notifySelect:(0,be.sendParent)((({connector:e})=>({type:"selectConnector",connector:e})))}});var xe=n(45764);function we(e,t,n){const a=(0,Se.createModel)({request:{page:1,size:10},response:void 0,pollingEnabled:(null==n?void 0:n.pollingEnabled)||!1,onBeforeSetResponse:null==n?void 0:n.onBeforeSetResponse,dataTransformer:t},{events:Object.assign({},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e}),actions:{notifyReady:()=>({}),notifyLoading:()=>({}),notifySuccess:()=>({}),notifyError:()=>({}),forwardUnknownEventsToParent:()=>({})}}),r=a.assign(((e,t)=>{var n,a;return t.page!==e.request.page?{}:(e.onBeforeSetResponse&&e.onBeforeSetResponse(null===(n=e.response)||void 0===n?void 0:n.items),{response:{items:null===(a=t.items)||void 0===a?void 0:a.map((t=>e.dataTransformer(t))),total:t.total,error:void 0}})}),"api.setResponse"),o=a.assign((e=>{e.actor&&e.actor.stop&&e.actor.stop();return{actor:(0,xe.spawn)(d(e))}})),c=a.assign(((e,t)=>{var n,a;return t.page!==e.request.page?{}:{response:{items:(null===(n=e.response)||void 0===n?void 0:n.items)||[],total:(null===(a=e.response)||void 0===a?void 0:a.total)||0,error:t.error}}}),"api.setError"),i=a.assign((e=>({request:Object.assign(Object.assign({},e.request),{page:e.request.page+1})})),"api.nextPage"),l=a.assign((e=>({request:Object.assign(Object.assign({},e.request),{page:e.request.page-1})})),"api.prevPage"),s=a.assign(((e,t)=>{const{page:n,size:a,query:r}=t;return{request:{page:n||e.request.page,size:a||e.request.size,query:r}}}),"api.query"),d=t=>n=>e(t.request,(e=>n(a.events["api.setResponse"](e))),(e=>n(a.events["api.setError"](e))));return a.createMachine({id:"paginatedApiMachine",context:a.initialContext,type:"parallel",states:{api:{initial:"idle",states:{idle:{entry:a.actions.notifyReady(),on:{"api.query":{target:"loading",actions:s}}},success:{always:[{target:"queryEmpty",cond:"isQueryEmpty"},{target:"queryResults",cond:"isQuerySuccesful"},{target:"empty",cond:"isTotalZero"},{target:"results"}]},queryEmpty:{tags:"queryEmpty",on:{"api.query":{target:"loading",actions:s},"api.prevPage":{target:"loading",actions:l,cond:"isNotFirstPage"},"api.refresh":{target:"loading"}}},queryResults:{tags:"queryResults",on:{"api.query":{target:"loading",actions:s},"api.nextPage":{target:"loading",actions:i,cond:"isNotLastPage"},"api.prevPage":{target:"loading",actions:l,cond:"isNotFirstPage"},"api.refresh":{target:"loading"}}},empty:{tags:"empty",on:{"api.query":{target:"loading",actions:s},"api.refresh":{target:"loading"}}},results:{tags:"results",on:{"api.query":{target:"loading",actions:s},"api.nextPage":{target:"loading",actions:i,cond:"isNotLastPage"},"api.prevPage":{target:"loading",actions:l,cond:"isNotFirstPage"},"api.refresh":{target:"loading"}}},error:{tags:"error",on:{"api.query":{target:"loading",actions:s},"api.refresh":{target:"loading"},"api.prevPage":{target:"loading",actions:l,cond:"isNotFirstPage"}}},loading:{tags:["loading"],entry:[a.actions.notifyLoading(),o],on:{"api.query":{target:"loading",actions:s},"api.setResponse":{target:"success",actions:[r,a.actions.notifySuccess()]},"api.setError":{target:"error",actions:[c,a.actions.notifyError()]}}}},on:{"*":{actions:"forwardUnknownEventsToParent"}}},polling:{entry:o,on:{"api.setResponse":{actions:r}},after:{INTERVAL:{cond:"isPollingEnabled",target:"polling"}}}}},{delays:{INTERVAL:5e3},actions:{notifyReady:(0,be.sendParent)({type:"api.ready"}),notifySuccess:(0,be.sendParent)((e=>Object.assign({type:"api.success"},e.response))),notifyError:(0,be.sendParent)((e=>{var t;return{type:"api.error",error:null===(t=e.response)||void 0===t?void 0:t.error}})),notifyLoading:(0,be.sendParent)((e=>Object.assign({type:"api.loading"},e.request))),forwardUnknownEventsToParent:(0,be.pure)(((e,t)=>!1===Object.keys(a.events).includes(t.type)?(0,be.sendParent)(((e,t,n)=>n._event.data)):[]))},guards:{isNotFirstPage:e=>void 0!==e.response&&e.request.page>1,isNotLastPage:e=>void 0!==e.response&&e.request.size>0&&e.request.page<Math.ceil(e.response.total/e.request.size),isTotalZero:e=>{var t;return 0===(null===(t=e.response)||void 0===t?void 0:t.total)},isQuerySuccesful:e=>{var t;return void 0!==e.request.query&&void 0!==e.response&&(null===(t=e.response)||void 0===t?void 0:t.total)>0},isQueryEmpty:e=>{var t;return void 0!==e.request.query&&void 0!==e.response&&0===(null===(t=e.response)||void 0===t?void 0:t.total)},isPollingEnabled:e=>e.pollingEnabled}})}const Ae=e=>(0,ye.useSelector)(e,(0,d.useCallback)((e=>({request:e.context.request,response:e.context.response,loading:e.hasTag("loading"),queryEmpty:e.hasTag("queryEmpty"),queryResults:e.hasTag("queryResults"),noResults:e.hasTag("empty"),results:e.hasTag("results"),error:e.hasTag("error"),firstRequest:void 0===e.context.response})),[e])),Pe=(0,Se.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",selectedConnector:void 0},{events:Object.assign(Object.assign({},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e}),{selectConnector:e=>e,deselectConnector:()=>({})}),actions:{notifyError:()=>({})}}),Be=Pe.assign(((e,t)=>({selectedConnector:t.connector})),"selectConnector"),Oe=Pe.assign((e=>({selectedConnector:void 0})),"deselectConnector"),Ne=Pe.createMachine({id:"connectors",initial:"root",context:Pe.initialContext,states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:h,src:e=>we((({accessToken:e,connectorsApiBasePath:t})=>{const n=new l.ConnectorsApi(new l.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const r=o().CancelToken.source(),{page:c,size:i}=e;return n.listConnectors(`${c}`,`${i}`,{cancelToken:r.token}).then((e=>{t({items:e.data.items||[],total:e.data.total,page:e.data.page,size:e.data.size})})).catch((t=>{o().isCancel(t)||a({error:t.message,page:e.page})})),()=>{r.cancel("Operation canceled by the user.")}}})(e),(t=>(0,xe.spawn)((e=>Ie.withContext(e))({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,connector:t}),`connector-${t.id}`)),{pollingEnabled:!0,onBeforeSetResponse:e=>{e&&e.forEach((e=>{e&&e.stop&&e.stop()}))}})},states:{idle:{on:{"api.ready":"ready"}},ready:{entry:(0,xe.send)("api.query",{to:h})}},on:{"api.refresh":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.nextPage":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.prevPage":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.query":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.error":{actions:"notifyError"},selectConnector:{actions:Be},deselectConnector:{actions:Oe}}},listing:{}}}}},{actions:{notifyError:(e,t)=>{console.log(e,t),"api.error"===t.type&&e.onError&&e.onError(t.error)}}}),_e=(0,d.createContext)(null),De=({children:e,accessToken:t,connectorsApiBasePath:n,onError:a})=>{const r=(0,ye.useInterpret)(Ne,{context:{accessToken:t,connectorsApiBasePath:n,onError:a},devTools:!0});return u().createElement(_e.Provider,{value:r},e)},je=()=>{const e=(0,d.useContext)(_e);if(!e)throw new Error("useConnectorsMachineService() must be used in a child of <ConnectorsMachineProvider>");return e},Fe=()=>{const e=je(),t=Ae(e.state.children.paginatedApi),{selectedConnector:n}=(0,ye.useSelector)(e,(0,d.useCallback)((e=>({selectedConnector:e.context.selectedConnector})),[e])),a=(0,d.useCallback)((()=>{e.send({type:"deselectConnector"})}),[e]),r=(0,d.useCallback)((t=>{e.send(Object.assign({type:"api.query"},t))}),[e]);return Object.assign(Object.assign({},t),{selectedConnector:n,deselectConnector:a,query:r})},qe=({onCreateConnector:e,onConnectorDetail:t})=>{const{t:n}=(0,p.useTranslation)(),a=(0,I.useAlert)(),{connectorsApiBasePath:r,getToken:o}=T(),c=(0,d.useCallback)((e=>{null==a||a.addAlert({id:"connectors-table-error",variant:I.AlertVariant.danger,title:n("common.something_went_wrong"),description:e})}),[a,n]);return u().createElement(De,{accessToken:o,connectorsApiBasePath:r,onError:c},u().createElement(Le,{onCreateConnector:e,onConnectorDetail:t}))},Le=({onCreateConnector:e,onConnectorDetail:t})=>(()=>{const e=je();return(0,ye.useSelector)(e,(0,d.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?u().createElement(Re,{onCreateConnector:e,onConnectorDetail:t}):u().createElement(C.g,null),Re=({onCreateConnector:e,onConnectorDetail:t})=>{const{loading:n,error:a,noResults:r,queryEmpty:o,firstRequest:c,request:i,response:l,selectedConnector:s,deselectConnector:d,query:p}=Fe();switch(!0){case c:return u().createElement(C.g,null);case o:return u().createElement(he,{onClear:()=>p({page:1,size:10})});case n:return u().createElement(u().Fragment,null,u().createElement(m.PageSection,{variant:"light"},u().createElement(ze,null)),u().createElement(m.PageSection,{padding:{default:"noPadding"},isFilled:!0},u().createElement(m.Card,null,u().createElement(ge,{itemCount:(null==l?void 0:l.total)||0,page:i.page,perPage:i.size,onChange:(e,t)=>p({page:e,size:t})}),u().createElement(C.g,null))));case r:return u().createElement(Ce,{onCreate:e,onHelp:function(){throw new Error("Function not implemented.")}});case a:return u().createElement(fe,null);default:return u().createElement(re,{connector:s,onClose:d},u().createElement(m.PageSection,{variant:"light"},u().createElement(ze,null)),u().createElement(m.PageSection,{padding:{default:"noPadding"},isFilled:!0},u().createElement(Ge,{onConnectorDetail:t})))}},ze=()=>{const{t:e}=(0,p.useTranslation)();return u().createElement(m.TextContent,null,u().createElement(m.Title,{headingLevel:"h1"},e("Connectors")))},Ge=({onConnectorDetail:e})=>{var t;const{request:n,response:a,selectedConnector:r,query:o}=Fe();return u().createElement(m.Card,{className:"pf-u-pb-xl"},u().createElement(ge,{itemCount:(null==a?void 0:a.total)||0,page:n.page,perPage:n.size,onChange:(e,t)=>o({page:e,size:t})}),u().createElement("div",{className:"pf-u-p-md"},u().createElement(le,null,null===(t=null==a?void 0:a.items)||void 0===t?void 0:t.map((t=>u().createElement(Ve,{connectorRef:t,key:t.id,selectedConnector:r,onConnectorDetail:e}))))),u().createElement(de,{itemCount:(null==a?void 0:a.total)||0,page:n.page,perPage:n.size,onChange:(e,t)=>o({page:e,size:t}),isCompact:!1}))},Ve=({connectorRef:e,selectedConnector:t,onConnectorDetail:n})=>{var a;const{connector:r,canStart:o,canStop:c,canDelete:i,onStart:l,onStop:s,onDelete:p,onSelect:m}=(e=>{const{connector:t,canStart:n,canStop:a,canDelete:r}=(0,ye.useSelector)(e,(0,d.useCallback)((e=>({connector:e.context.connector,canStart:!0===Ie.transition(e,"connector.start").changed,canStop:!0===Ie.transition(e,"connector.stop").changed,canDelete:!0===Ie.transition(e,"connector.remove").changed})),[e]));return{connector:t,canStart:n,canStop:a,canDelete:r,onStart:(0,d.useCallback)((()=>e.send({type:"connector.start"})),[e]),onStop:(0,d.useCallback)((()=>e.send({type:"connector.stop"})),[e]),onDelete:(0,d.useCallback)((()=>e.send({type:"connector.remove"})),[e]),onSelect:(0,d.useCallback)((()=>e.send({type:"connector.select"})),[e])}})(e),[g,v]=(0,d.useState)(!1);return u().createElement(u().Fragment,null,u().createElement(ve,{connectorName:r.name,showDialog:g,onCancel:()=>{v(!1)},onConfirm:()=>{v(!1),p()}}),u().createElement(se,{connectorId:r.id,name:r.name,type:r.connector_type_id,category:"TODO: MISSING",status:null===(a=r.status)||void 0===a?void 0:a.state,isSelected:(null==t?void 0:t.id)===r.id,canStart:o,canStop:c,canDelete:i,onStart:l,onStop:s,onSelect:m,openDetail:e=>{n(r.id,e)},onDelete:()=>v(!0)}))};var Me=n(64616);function He(e){const t=[];for(const n of e)if(n.steps)for(const e of n.steps)t.push(e);else t.push(n);return t}class Ke extends d.Component{constructor(e){super(e),this.handleKeyClicks=e=>{e.keyCode===m.KEY_CODES.ESCAPE_KEY&&(this.state.isNavOpen?this.setState({isNavOpen:!this.state.isNavOpen}):this.props.isOpen&&this.props.onClose&&this.props.onClose())},this.getFlattenedSteps=()=>{const{steps:e}=this.props;return He(e)},this.getFlattenedStepsIndex=(e,t)=>{for(let n=0;n<e.length;n++)if(e[n].name===t)return n+1;return 0},this.initSteps=e=>{for(let t=0;t<e.length;t++){if(e[t].steps)for(let n=0;n<e[t].steps.length;n++)e[t].steps[n]=Object.assign({canJumpTo:!0},e[t].steps[n]);e[t]=Object.assign({canJumpTo:!0},e[t])}return e},this.getElement=e=>"function"==typeof e?e():e||document.body;const t=Ke.currentId++;this.titleId=e.titleId||`pf-wizard-title-${t}`,this.descriptionId=e.descriptionId||`pf-wizard-description-${t}`,this.state={isNavOpen:!1}}componentDidMount(){const e="undefined"!=typeof document?document.body:null;e&&e.addEventListener("keydown",this.handleKeyClicks,!1)}componentWillUnmount(){const e="undefined"!=typeof document&&document.body||null;e&&e.removeEventListener("keydown",this.handleKeyClicks,!1)}render(){const e=this.props,{width:t,height:n,title:r,description:o,onClose:c,onSave:i,onBack:l,onNext:s,onGoToStep:d,goToStep:p,goToStepById:g,goToStepByName:v,className:f,steps:E,currentStep:C,nextButtonText:h="Next",backButtonText:y="Back",cancelButtonText:b="Cancel",hideClose:S,closeButtonAriaLabel:T="close",navAriaLabel:k,navAriaLabelledBy:I,mainAriaLabel:x,mainAriaLabelledBy:w,hasNoBodyPadding:A,footer:P,appendTo:B,isOpen:O,titleId:N,descriptionId:_}=e,D=(0,a.__rest)(e,["width","height","title","description","onClose","onSave","onBack","onNext","onGoToStep","goToStep","goToStepById","goToStepByName","className","steps","currentStep","nextButtonText","backButtonText","cancelButtonText","hideClose","closeButtonAriaLabel","navAriaLabel","navAriaLabelledBy","mainAriaLabel","mainAriaLabelledBy","hasNoBodyPadding","footer","appendTo","isOpen","titleId","descriptionId"]),j=this.getFlattenedSteps(),F=j.length<C?j.length:C,q=j[F-1],L=this.initSteps(E),R=q===j[0],z=!q||void 0===q.enableNext||q.enableNext,G={goToStepById:g,goToStepByName:v,onNext:s,onBack:l,onClose:c,activeStep:q},V=Object.assign(Object.assign({},n?{height:n}:{}),t?{width:t}:{}),M=u().createElement(m.WizardContextProvider,{value:G},u().createElement("div",Object.assign({},D,{className:(0,ce.css)(Me.Z.wizard,q&&q.isFinishedStep&&"pf-m-finished",f),style:Object.keys(V).length?V:void 0}),r&&u().createElement(m.WizardHeader,{titleId:this.titleId,descriptionId:this.descriptionId,onClose:c,title:r,description:o,closeButtonAriaLabel:T,hideClose:S}),u().createElement(m.WizardToggle,{mainAriaLabel:x,isInPage:void 0===O,mainAriaLabelledBy:(r||w)&&(w||this.titleId),isNavOpen:this.state.isNavOpen,onNavToggle:e=>this.setState({isNavOpen:e}),nav:e=>{const t={isOpen:e,"aria-label":k,"aria-labelledby":(r||I)&&(I||this.titleId)};return u().createElement(m.WizardNav,Object.assign({},t),L.map(((e,n)=>{if(e.isFinishedStep)return null;let a,r;if(e.steps){let o=!1,c=!1;for(const t of e.steps)q.name===t.name&&(o=!0),t.canJumpTo&&(c=!0);return r=this.getFlattenedStepsIndex(j,e.steps[0].name),u().createElement(m.WizardNavItem,{key:n,content:e.name,isCurrent:o,isDisabled:!c,step:r,onNavItemClick:p},u().createElement(m.WizardNav,Object.assign({},t,{returnList:!0}),e.steps.map(((e,t)=>e.isFinishedStep?null:(r=this.getFlattenedStepsIndex(j,e.name),a=e.canJumpTo,u().createElement(m.WizardNavItem,{key:`child_${t}`,content:e.name,isCurrent:q.name===e.name,isDisabled:!a,step:r,onNavItemClick:p}))))))}return r=this.getFlattenedStepsIndex(j,e.name),a=e.canJumpTo,u().createElement(m.WizardNavItem,Object.assign({},e.stepNavItemProps,{key:n,content:e.name,isCurrent:q.name===e.name,isDisabled:!a,step:r,onNavItemClick:p}))})))},steps:E,activeStep:q,hasNoBodyPadding:A},P||u().createElement("footer",{className:(0,ce.css)(Me.Z.wizardFooter)},u().createElement(m.Button,{variant:m.ButtonVariant.primary,type:"submit",onClick:s,isDisabled:!z},q&&q.nextButtonText||h),!q.hideBackButton&&u().createElement(m.Button,{variant:m.ButtonVariant.secondary,onClick:l,className:(0,ce.css)(R&&"pf-m-disabled")},y),!q.hideCancelButton&&u().createElement("div",{className:Me.Z.wizardFooterCancel},u().createElement(m.Button,{variant:m.ButtonVariant.link,onClick:c},b))))));return void 0!==O?u().createElement(m.Modal,{width:null!==t?t:void 0,isOpen:O,variant:m.ModalVariant.large,"aria-labelledby":this.titleId,"aria-describedby":this.descriptionId,showClose:!1,hasNoBodyWrapper:!0},M):M}}Ke.displayName="Wizard",Ke.currentId=0,Ke.defaultProps={title:void 0,description:"",className:"",nextButtonText:"Next",backButtonText:"Back",cancelButtonText:"Cancel",hideClose:!1,closeButtonAriaLabel:"Close",navAriaLabel:void 0,navAriaLabelledBy:void 0,mainAriaLabel:void 0,mainAriaLabelledBy:void 0,hasNoBodyPadding:!1,onGoToStep:void 0,width:void 0,height:void 0,footer:void 0,appendTo:void 0,isOpen:void 0};const Je=(0,Se.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",clusters:void 0,selectedCluster:void 0,error:void 0},{events:Object.assign({selectCluster:e=>Object.assign({},e),deselectCluster:()=>({}),confirm:()=>({})},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e})}),$e=Je.assign(((e,t)=>{const{type:n}=t;return{response:(0,a.__rest)(t,["type"])}}),"api.success"),We=Je.assign({selectedCluster:(e,t)=>{var n,a;return null===(a=null===(n=e.response)||void 0===n?void 0:n.items)||void 0===a?void 0:a.find((e=>e.id===t.selectedCluster))}},"selectCluster"),Ue=Je.assign({selectedCluster:void 0},"deselectCluster"),Qe=Je.createMachine({id:"clusters",initial:"root",context:Je.initialContext,states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:h,src:e=>we((({accessToken:e,connectorsApiBasePath:t})=>{const n=new l.ConnectorClustersApi(new l.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const r=o().CancelToken.source(),{page:c,size:i}=e;return n.listConnectorClusters(`${c}`,`${i}`,{cancelToken:r.token}).then((e=>{t({items:e.data.items||[],total:e.data.total,page:e.data.page,size:e.data.size})})).catch((t=>{o().isCancel(t)||a({error:t.message,page:e.page})})),()=>{r.cancel("Operation canceled by the user.")}}})(e),(e=>e))},states:{idle:{entry:(0,xe.send)("api.query",{to:h}),on:{"api.ready":"ready"}},ready:{}},on:{"api.refresh":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.nextPage":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.prevPage":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.query":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.success":{actions:$e}}},selection:{id:"selection",initial:"verify",states:{verify:{always:[{target:"selecting",cond:"noClusterSelected"},{target:"valid",cond:"clusterSelected"}]},selecting:{entry:(0,xe.sendParent)("isInvalid"),on:{selectCluster:{target:"valid",actions:We}}},valid:{entry:(0,xe.sendParent)("isValid"),on:{selectCluster:{target:"verify",actions:We,cond:(e,t)=>void 0!==t.selectedCluster},deselectCluster:{target:"verify",actions:Ue},confirm:{target:"#done",cond:"clusterSelected"}}}}}}},done:{id:"done",type:"final",data:{selectedCluster:e=>e.selectedCluster}}}},{guards:{clusterSelected:e=>void 0!==e.selectedCluster,noClusterSelected:e=>void 0===e.selectedCluster}}),Ze=(0,Se.createModel)({name:"",sACreated:!1,userServiceAccount:{clientId:"",clientSecret:""}},{events:{setName:e=>e,setSaCreated:e=>e,setServiceAccount:e=>e,confirm:()=>({})}}),Ye=Ze.assign({name:(e,t)=>t.name},"setName"),Xe=Ze.assign({sACreated:(e,t)=>t.sACreated},"setSaCreated"),et=Ze.assign(((e,t)=>({userServiceAccount:t.serviceAccount})),"setServiceAccount"),tt=Ze.createMachine({id:"configureBasic",initial:"verify",states:{verify:{always:[{target:"valid",cond:"isBasicConfigured"},{target:"typing"}]},typing:{entry:(0,xe.sendParent)("isInvalid"),on:{setName:{target:"verify",actions:Ye},setSaCreated:{target:"verify",actions:Xe},setServiceAccount:{target:"verify",actions:et}}},valid:{id:"valid",entry:(0,xe.sendParent)("isValid"),on:{setName:{target:"verify",actions:Ye},setSaCreated:{target:"verify",actions:Xe},setServiceAccount:{target:"verify",actions:et},confirm:{target:"#done",cond:"isBasicConfigured"}}},done:{id:"done",type:"final",data:{name:e=>e.name,sACreated:e=>e.sACreated,userServiceAccount:e=>e.userServiceAccount}}}},{guards:{isBasicConfigured:e=>void 0!==e.name&&e.name.length>0&&void 0!==e.userServiceAccount&&e.userServiceAccount.clientId.length>0&&e.userServiceAccount.clientSecret.length>0}}),nt=(0,Se.createModel)({connector:{id:"something",name:"something",version:"0.1",schema:{}},steps:[],activeStep:0,isActiveStepValid:!1,configuration:void 0},{events:{entry:()=>({}),change:({configuration:e,isValid:t})=>({configuration:e,isValid:t}),next:()=>({}),prev:()=>({}),complete:()=>({})},actions:{changedStep:()=>({})}}),at=nt.assign((e=>({activeStep:Math.min(e.activeStep+1,e.steps.length-1),isActiveStepValid:!1})),"next"),rt=nt.assign((e=>({activeStep:Math.max(e.activeStep-1,0),isActiveStepValid:!1})),"prev"),ot=nt.assign(((e,t)=>({configuration:t.configuration,isActiveStepValid:t.isValid})),"change"),ct=nt.createMachine({id:"configurator",initial:"configuring",context:{connector:{id:"something",name:"something",version:"0.1",schema:{}},steps:["one","two","three"],activeStep:0,isActiveStepValid:!1,configuration:void 0},states:{configuring:{entry:(0,xe.sendParent)("isInvalid"),always:[{target:"valid",cond:"activeStepValid"}]},valid:{id:"valid",initial:"determineStep",entry:(0,xe.sendParent)("isValid"),states:{determineStep:{always:[{target:"#valid.lastStep",cond:"isLastStep"},{target:"#valid.hasNextStep"}]},hasNextStep:{on:{next:{target:"#configurator.configuring",actions:[at,"changedStep"]}}},lastStep:{on:{next:"#configurator.configured"}}}},configured:{type:"final",data:({configuration:e})=>({configuration:e})}},on:{change:{target:"configuring",actions:ot},prev:{target:"configuring",actions:[rt,"changedStep"]}}},{actions:{changedStep:(0,xe.sendParent)((e=>({type:"changedStep",step:e.activeStep})))},guards:{isLastStep:e=>e.activeStep===e.steps.length-1,activeStepValid:e=>e.isActiveStepValid}}),it={context:(0,xe.createSchema)()},lt=(0,Se.createModel)({connector:{id:"something",name:"something",version:"0.1"},Configurator:void 0,steps:void 0,error:void 0}),st=lt.createMachine({schema:it,id:"configurator",initial:"loading",context:lt.initialContext,states:{loading:{invoke:{id:"fetchConfigurator",src:"fetchConfigurator",onDone:{target:"success",actions:(0,xe.assign)(((e,t)=>t.data))},onError:{target:"failure",actions:(0,xe.assign)({error:(e,t)=>t.data})}}},failure:{entry:(0,be.escalate)((e=>({message:e.error})))},success:{type:"final",data:({Configurator:e,steps:t})=>({Configurator:e,steps:t})}}}),dt=(0,Se.createModel)({accessToken:()=>Promise.resolve(""),connectorsApiBasePath:"",response:void 0,selectedConnector:void 0,error:void 0},{events:Object.assign({selectConnector:e=>Object.assign({},e),deselectConnector:()=>({}),confirm:()=>({})},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e})}),ut=dt.assign(((e,t)=>{const{type:n}=t;return{response:(0,a.__rest)(t,["type"])}}),"api.success"),pt=dt.assign({selectedConnector:(e,t)=>{var n,a;return null===(a=null===(n=e.response)||void 0===n?void 0:n.items)||void 0===a?void 0:a.find((e=>e.id===t.selectedConnector))}},"selectConnector"),mt=dt.assign({selectedConnector:void 0},"deselectConnector"),gt=dt.createMachine({context:dt.initialContext,id:"connectors",initial:"root",states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:h,src:e=>we((({accessToken:e,connectorsApiBasePath:t})=>{const n=new l.ConnectorTypesApi(new l.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const r=o().CancelToken.source(),{page:c,size:i,query:l}=e,{name:s,categories:d=[]}=l||{};return n.getConnectorTypes("1","1000",void 0,void 0,{cancelToken:r.token}).then((e=>{const n=s?s.toLowerCase():void 0,a=e.data.items||[];let r=n?null==a?void 0:a.filter((e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(n)})):a;r=d.length>0?null==r?void 0:r.filter((e=>{var t;return((null===(t=e.labels)||void 0===t?void 0:t.filter((e=>d.includes(e))))||[]).length>0})):r;const o=r.length,l=(c-1)*i,u=r.slice(l,l+i);t({items:u,total:o,page:c,size:i})})).catch((t=>{o().isCancel(t)||a({error:t.message,page:e.page})})),()=>{r.cancel("Operation canceled by the user.")}}})(e),(e=>e))},states:{idle:{entry:(0,xe.send)({type:"api.query",query:{categories:["sink","source"]}},{to:h}),on:{"api.ready":"ready"}},ready:{}},on:{"api.refresh":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.nextPage":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.prevPage":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.query":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.success":{actions:ut}}},selection:{id:"selection",initial:"verify",states:{verify:{always:[{target:"selecting",cond:"noConnectorSelected"},{target:"valid",cond:"connectorSelected"}]},selecting:{entry:(0,xe.sendParent)("isInvalid"),on:{selectConnector:{target:"valid",actions:pt,cond:(e,t)=>void 0!==t.selectedConnector}}},valid:{entry:(0,xe.sendParent)("isValid"),on:{selectConnector:{target:"verify",actions:pt},deselectConnector:{target:"verify",actions:mt},confirm:{target:"#done",cond:"connectorSelected"}}}}}}},done:{id:"done",type:"final",data:{selectedConnector:e=>e.selectedConnector}}}},{guards:{connectorSelected:e=>void 0!==e.selectedConnector,noConnectorSelected:e=>void 0===e.selectedConnector}}),vt=(0,Se.createModel)({topic:"",userErrorHandler:""},{events:{setTopic:e=>e,setErrorHandler:e=>e,confirm:()=>({})}}),ft=vt.assign({topic:(e,t)=>t.topic},"setTopic"),Et=vt.assign(((e,t)=>({userErrorHandler:t.errorHandler})),"setErrorHandler"),Ct=vt.createMachine({id:"configureErrorHandler",initial:"verify",states:{verify:{always:[{target:"valid",cond:"isErrorHandlerConfigured"},{target:"typing"}]},typing:{entry:(0,xe.sendParent)("isInvalid"),on:{setTopic:{target:"verify",actions:ft},setErrorHandler:{target:"verify",actions:Et}}},valid:{id:"valid",entry:(0,xe.sendParent)("isValid"),on:{setTopic:{target:"verify",actions:ft},setErrorHandler:{target:"verify",actions:Et},confirm:{target:"#done",cond:"isErrorHandlerConfigured"}}},done:{id:"done",type:"final",data:{topic:e=>e.topic,userErrorHandler:e=>e.userErrorHandler}}}},{guards:{isErrorHandlerConfigured:e=>void 0!==e.userErrorHandler&&"dead_letter_queue"===e.userErrorHandler?void 0!==e.topic&&e.topic.length>0:void 0!==e.topic&&e.topic.length>0||void 0!==e.userErrorHandler}}),ht=(0,Se.createModel)({accessToken:()=>Promise.resolve(""),kafkaManagementBasePath:"",instances:void 0,selectedInstance:void 0,error:void 0},{events:Object.assign({selectInstance:e=>Object.assign({},e),deselectInstance:()=>({}),confirm:()=>({})},{"api.refresh":()=>({}),"api.nextPage":()=>({}),"api.prevPage":()=>({}),"api.query":e=>e,"api.setResponse":e=>e,"api.setError":e=>e,"api.ready":()=>({}),"api.loading":e=>e,"api.success":e=>e,"api.error":e=>e})}),yt=ht.assign(((e,t)=>{const{type:n}=t;return{response:(0,a.__rest)(t,["type"])}}),"api.success"),bt=ht.assign({selectedInstance:(e,t)=>{var n,a;return null===(a=null===(n=e.response)||void 0===n?void 0:n.items)||void 0===a?void 0:a.find((e=>e.id===t.selectedInstance))}},"selectInstance"),St=ht.assign({selectedInstance:void 0},"deselectInstance"),Tt=ht.createMachine({id:"kafkas",initial:"root",context:ht.initialContext,states:{root:{type:"parallel",states:{api:{initial:"idle",invoke:{id:h,src:e=>we((({accessToken:e,kafkaManagementBasePath:t})=>{const n=new s.DefaultApi(new l.Configuration({accessToken:e,basePath:t}));return(e,t,a)=>{const r=o().CancelToken.source(),{page:c,size:i,query:l}=e,{name:s,statuses:d,owner:u,cloudProviders:p,regions:m}=l||{},g=[s&&s.length>0?` name LIKE ${s}`:void 0,u&&u.length>0?` owner LIKE ${u}`:void 0,d&&d.length>0?d.map((e=>`status = ${e}`)).join(" OR "):void 0,p&&p.length>0?p.map((e=>`cloud_provider = ${e}`)).join(" OR "):void 0,m&&m.length>0?m.map((e=>`region = ${e}`)).join(" OR "):void 0].filter(Boolean).map((e=>`(${e})`)).join(" AND ");return n.getKafkas(`${c}`,`${i}`,void 0,g,{cancelToken:r.token}).then((e=>{t({items:e.data.items||[],total:e.data.total,page:e.data.page,size:e.data.size})})).catch((t=>{o().isCancel(t)||a({error:t.message,page:e.page})})),()=>{r.cancel("Operation canceled by the user.")}}})(e),(e=>e))},states:{idle:{entry:(0,xe.send)("api.query",{to:h}),on:{"api.ready":"ready"}},ready:{}},on:{"api.refresh":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.nextPage":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.prevPage":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.query":{actions:(0,xe.send)(((e,t)=>t),{to:h})},"api.success":{actions:yt}}},selection:{id:"selection",initial:"verify",states:{verify:{always:[{target:"selecting",cond:"noInstanceSelected"},{target:"valid",cond:"instanceSelected"}]},selecting:{entry:(0,be.sendParent)("isInvalid"),on:{selectInstance:{target:"valid",actions:bt}}},valid:{entry:(0,be.sendParent)("isValid"),on:{selectInstance:{target:"verify",actions:bt,cond:(e,t)=>void 0!==t.selectedInstance},deselectInstance:{target:"verify",actions:St},confirm:{target:"#done",cond:"instanceSelected"}}}}}}},done:{id:"done",type:"final",data:{selectedInstance:e=>e.selectedInstance}}}},{guards:{instanceSelected:e=>void 0!==e.selectedInstance,noInstanceSelected:e=>void 0===e.selectedInstance}}),kt=(0,Se.createModel)({initialConfiguration:void 0,configString:"",name:""},{events:{save:()=>({}),success:()=>({}),failure:e=>e}}),It=kt.assign((e=>({kafka:e.kafka,cluster:e.cluster,connectorType:e.connectorType,name:e.name,userServiceAccount:e.userServiceAccount,topic:e.topic,userErrorHandler:e.userErrorHandler,configString:At(e.initialConfiguration)}))),xt=kt.assign(((e,t)=>({savingError:t.message})),"failure"),wt=kt.createMachine({id:"review",initial:"verify",context:kt.initialContext,entry:It,states:{verify:{always:[{target:"valid",cond:"isAllConfigured"}]},valid:{id:"valid",entry:(0,xe.sendParent)("isValid"),on:{save:"saving"}},saving:{invoke:{src:e=>(({accessToken:e,connectorsApiBasePath:t,kafka:n,cluster:a,connectorType:r,configuration:c,name:i,userServiceAccount:s,userErrorHandler:d,topic:u})=>{const p=new l.ConnectorsApi(new l.Configuration({accessToken:e,basePath:t}));return e=>{const t=o().CancelToken.source();let m={};m=d?Object.assign(Object.assign({},c),{error_handler:{[d]:u?{topic:u}:{}}}):c;const g={kind:"Connector",name:i,channel:l.Channel.Stable,deployment_location:{kind:"addon",cluster_id:a.id},desired_state:l.ConnectorDesiredState.Ready,connector_type_id:r.id,kafka:{id:n.id,url:n.bootstrap_server_host||"demo"},service_account:{client_id:s.clientId,client_secret:s.clientSecret},connector:m};return p.createConnector(!0,g,{cancelToken:t.token}).then((()=>{e({type:"success"})})).catch((t=>{o().isCancel(t)||e({type:"failure",message:t.response.data.reason})})),()=>{t.cancel("Operation canceled by the user.")}}})({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafka:e.kafka,cluster:e.cluster,connectorType:e.connectorType,configuration:JSON.parse(e.configString),name:e.name,userServiceAccount:e.userServiceAccount,topic:e.topic,userErrorHandler:e.userErrorHandler})},on:{success:"saved",failure:{target:"valid",actions:xt}},tags:["saving"]},saved:{type:"final"}}},{guards:{isAllConfigured:e=>void 0!==e.configString}});function At(e){const t=e instanceof Map?N(e):e;try{return JSON.stringify(t,null,2)}catch(e){return""}}const Pt=(0,Se.createModel)({},{events:{isValid:()=>({}),isInvalid:()=>({}),prev:()=>({}),next:()=>({}),changedStep:({step:e})=>({step:e}),jumpToSelectKafka:()=>({}),jumpToSelectCluster:()=>({}),jumpToSelectConnector:()=>({}),jumpToConfigureConnector:({subStep:e})=>({subStep:e}),jumpToBasicConfiguration:()=>({}),jumpToErrorConfiguration:()=>({}),jumpToReviewConfiguration:()=>({})},actions:{notifySave:()=>({})}}),Bt=Pt.createMachine({id:"creationWizard",initial:"selectConnector",context:Pt.initialContext,states:{selectConnector:{initial:"selecting",invoke:{id:"selectConnectorRef",src:gt,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,selectedConnector:e.selectedConnector}),onDone:{target:"selectKafka",actions:(0,xe.assign)(((e,t)=>({selectedConnector:t.data.selectedConnector,connectorConfiguration:!1,activeConfigurationStep:0,isConfigurationValid:!1,configurationSteps:!1})))},onError:".error"},states:{error:{},selecting:{on:{isValid:"valid"}},valid:{on:{isInvalid:"selecting",next:{actions:(0,xe.send)("confirm",{to:"selectConnectorRef"})}}}}},selectKafka:{initial:"selecting",invoke:{id:"selectKafkaInstanceRef",src:Tt,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,selectedInstance:e.selectedKafkaInstance,request:{page:1,size:10}}),onDone:{target:"selectCluster",actions:(0,xe.assign)({selectedKafkaInstance:(e,t)=>t.data.selectedInstance})},onError:".error"},states:{error:{},selecting:{on:{isValid:"valid"}},valid:{on:{isInvalid:"selecting",next:{actions:(0,xe.send)("confirm",{to:"selectKafkaInstanceRef"})}}}},on:{prev:"selectConnector"}},selectCluster:{initial:"selecting",invoke:{id:"selectClusterRef",src:Qe,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,selectedCluster:e.selectedCluster}),onDone:{target:"basicConfiguration",actions:(0,xe.assign)({selectedCluster:(e,t)=>t.data.selectedCluster})},onError:".error"},states:{error:{},selecting:{on:{isValid:"valid"}},valid:{on:{isInvalid:"selecting",next:{actions:(0,xe.send)("confirm",{to:"selectClusterRef"})}}}},on:{prev:"selectKafka"}},configureConnector:{initial:"loadConfigurator",states:{loadConfigurator:{invoke:{id:"configuratorLoader",src:"makeConfiguratorLoaderMachine",data:e=>({connector:e.selectedConnector}),onDone:{target:"configure",actions:(0,xe.assign)(((e,t)=>({Configurator:t.data.Configurator,configurationSteps:t.data.steps})))},onError:{actions:(e,t)=>console.error(t.data.message)}}},configure:{id:"configure",initial:"submittable",invoke:{id:"configuratorRef",src:ct,data:e=>({connector:e.selectedConnector,configuration:e.connectorConfiguration,steps:e.configurationSteps||["single step"],activeStep:e.activeConfigurationStep||0,isActiveStepValid:!1!==e.connectorConfiguration}),onDone:[{target:"#creationWizard.reviewConfiguration",actions:(0,xe.assign)(((e,t)=>({connectorConfiguration:t.data.configuration||!0}))),cond:e=>!!e.configurationSteps},{target:"#creationWizard.errorConfiguration",actions:(0,xe.assign)(((e,t)=>({connectorConfiguration:t.data.configuration||!0})))}],onError:{actions:(e,t)=>console.error(t.data.message)}},states:{submittable:{on:{isInvalid:"invalid",next:{actions:(0,xe.send)("next",{to:"configuratorRef"})}}},invalid:{on:{isValid:"submittable"}}},on:{prev:[{actions:(0,xe.send)("prev",{to:"configuratorRef"}),cond:"areThereSubsteps"},{target:"#creationWizard.basicConfiguration"}],changedStep:{actions:(0,xe.assign)({activeConfigurationStep:(e,t)=>t.step})}}}}},basicConfiguration:{id:"configureBasic",initial:"submittable",invoke:{id:"basicRef",src:tt,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafkaManagementApiBasePath:e.kafkaManagementApiBasePath,kafka:e.selectedKafkaInstance,cluster:e.selectedCluster,connectorType:e.selectedConnector,initialConfiguration:e.connectorConfiguration,name:e.name,sACreated:e.sACreated,userServiceAccount:e.userServiceAccount,topic:e.topic,userErrorHandler:e.userErrorHandler}),onDone:{target:"configureConnector",actions:[(0,xe.assign)(((e,t)=>({name:t.data.name,sACreated:t.data.sACreated,userServiceAccount:t.data.userServiceAccount})))]},onError:{actions:(e,t)=>console.error(t.data.message)}},states:{submittable:{on:{isInvalid:"invalid",next:{actions:(0,xe.send)("confirm",{to:"basicRef"})}}},invalid:{on:{isValid:"submittable"}}},on:{prev:"selectCluster"}},errorConfiguration:{id:"configureErrorHandler",initial:"submittable",invoke:{id:"errorRef",src:Ct,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafkaManagementApiBasePath:e.kafkaManagementApiBasePath,kafka:e.selectedKafkaInstance,cluster:e.selectedCluster,connector:e.selectedConnector,initialConfiguration:e.connectorConfiguration,topic:e.topic,userErrorHandler:e.userErrorHandler}),onDone:{target:"reviewConfiguration",actions:[(0,xe.assign)(((e,t)=>({topic:t.data.topic,userErrorHandler:t.data.userErrorHandler})))]},onError:{actions:(e,t)=>console.error(t.data.message)}},states:{submittable:{on:{isInvalid:"invalid",next:{actions:(0,xe.send)("confirm",{to:"errorRef"})}}},invalid:{on:{isValid:"submittable"}}},on:{prev:"configureConnector"}},reviewConfiguration:{id:"review",initial:"reviewing",invoke:{id:"reviewRef",src:wt,data:e=>({accessToken:e.accessToken,connectorsApiBasePath:e.connectorsApiBasePath,kafkaManagementApiBasePath:e.kafkaManagementApiBasePath,kafka:e.selectedKafkaInstance,cluster:e.selectedCluster,connectorType:e.selectedConnector,initialConfiguration:e.connectorConfiguration,name:e.name,userServiceAccount:e.userServiceAccount,topic:e.topic,userErrorHandler:e.userErrorHandler}),onDone:{target:"#creationWizard.saved",actions:[(0,xe.assign)(((e,t)=>({connectorConfiguration:t.data}))),"notifySave"]},onError:{actions:(e,t)=>console.error(t.data.message)}},states:{reviewing:{on:{isValid:"valid"}},valid:{on:{isInvalid:"reviewing",next:{actions:(0,xe.send)("save",{to:"reviewRef"})}}}},on:{prev:[{target:"#creationWizard.configureConnector",cond:e=>!!e.configurationSteps},{target:"#creationWizard.errorConfiguration"}]}},saved:{id:"saved",type:"final"}},on:{jumpToSelectConnector:{target:"selectConnector"},jumpToSelectKafka:{target:"selectKafka",cond:"isConnectorSelected"},jumpToSelectCluster:{target:"selectCluster",cond:"isKafkaInstanceSelected"},jumpToBasicConfiguration:{target:"basicConfiguration",cond:"isClusterSelected"},jumpToConfigureConnector:{target:"configureConnector",cond:"isBasicConfigured",actions:(0,xe.assign)(((e,t)=>({activeConfigurationStep:t.subStep||0})))},jumpToErrorConfiguration:{target:"errorConfiguration",cond:"isConnectorConfigured"},jumpToReviewConfiguration:{target:"reviewConfiguration",cond:"isConnectorConfigured"}}},{guards:{isKafkaInstanceSelected:e=>void 0!==e.selectedKafkaInstance,isClusterSelected:e=>void 0!==e.selectedCluster,isConnectorSelected:(e,t)=>{const n=t.subStep;return n?void 0!==e.selectedConnector&&(void 0!==e.connectorConfiguration||n<=e.activeConfigurationStep):void 0!==e.selectedConnector},isConnectorConfigured:e=>e.configurationSteps?void 0!==e.connectorConfiguration&&!1!==e.connectorConfiguration||e.activeConfigurationStep===e.configurationSteps.length-1&&!0===e.isConfigurationValid:void 0!==e.connectorConfiguration&&!1!==e.connectorConfiguration,isBasicConfigured:e=>void 0!==e.name&&e.name.length>0&&void 0!==e.userServiceAccount&&e.userServiceAccount.clientId.length>0&&e.userServiceAccount.clientSecret.length>0,isErrorHandlerConfigured:e=>void 0!==e.userErrorHandler&&"dead_letter_queue"===e.userErrorHandler?void 0!==e.topic&&e.topic.length>0:void 0!==e.topic&&e.topic.length>0||void 0!==e.userErrorHandler,areThereSubsteps:e=>e.activeConfigurationStep>0},actions:{notifySave:e=>{e.onSave&&e.onSave()}},services:{makeConfiguratorLoaderMachine:()=>st}}),Ot=(0,d.createContext)(null),Nt=({children:e,accessToken:t,connectorsApiBasePath:n,fetchConfigurator:a,onSave:r})=>{const o=(0,d.useCallback)((()=>st.withConfig({services:{fetchConfigurator:e=>a(e.connector)}})),[a]),c=(0,ye.useInterpret)(Bt,{devTools:!0,context:{accessToken:t,connectorsApiBasePath:n,onSave:r},services:{makeConfiguratorLoaderMachine:o}});return u().createElement(Ot.Provider,{value:c},e)},_t=()=>{const e=(0,d.useContext)(Ot);if(!e)throw new Error("useCreationWizardMachineService() must be used in a child of <CreationWizardMachineProvider>");return e},Dt=()=>{const e=_t();return(0,ye.useSelector)(e,(0,d.useCallback)((e=>({connectorTypeRef:e.children.selectConnectorRef,kafkaRef:e.children.selectKafkaInstanceRef,clusterRef:e.children.selectClusterRef,basicRef:e.children.basicRef,errorRef:e.children.errorRef,reviewRef:e.children.reviewRef})),[]))},jt=()=>{var e;const{clusterRef:t}=Dt(),n=Ae(null===(e=t.getSnapshot())||void 0===e?void 0:e.children.paginatedApi),{selectedId:a}=(0,ye.useSelector)(t,(0,d.useCallback)((e=>{var t;return{selectedId:null===(t=e.context.selectedCluster)||void 0===t?void 0:t.id}}),[])),r=(0,d.useCallback)((e=>{t.send({type:"selectCluster",selectedCluster:e})}),[t]),o=(0,d.useCallback)((e=>{t.send(Object.assign({type:"api.query"},e))}),[t]);return Object.assign(Object.assign({},n),{selectedId:a,onSelect:r,onQuery:o})},Ft=()=>{var e;const{connectorTypeRef:t}=Dt(),n=Ae(null===(e=t.getSnapshot())||void 0===e?void 0:e.children.paginatedApi),{selectedId:a}=(0,ye.useSelector)(t,(0,d.useCallback)((e=>{var t;return{selectedId:null===(t=e.context.selectedConnector)||void 0===t?void 0:t.id}}),[])),r=(0,d.useCallback)((e=>{t.send({type:"selectConnector",selectedConnector:e})}),[t]),o=(0,d.useCallback)((e=>{t.send(Object.assign({type:"api.query"},e))}),[t]);return Object.assign(Object.assign({},n),{selectedId:a,onSelect:r,onQuery:o})},qt=()=>{var e;const{kafkaRef:t}=Dt(),n=Ae(null===(e=t.getSnapshot())||void 0===e?void 0:e.children.paginatedApi),{selectedId:a}=(0,ye.useSelector)(t,(0,d.useCallback)((e=>{var t;return{selectedId:null===(t=e.context.selectedInstance)||void 0===t?void 0:t.id}}),[])),r=(0,d.useCallback)((e=>{t.send({type:"selectInstance",selectedInstance:e})}),[t]),o=(0,d.useCallback)((e=>{t.send(Object.assign({type:"api.query"},e))}),[t]);return Object.assign(Object.assign({},n),{selectedId:a,onSelect:r,onQuery:o})},Lt=()=>{const{reviewRef:e}=Dt(),{kafka:t,cluster:n,connectorType:a,topic:r,userErrorHandler:o,name:c,userServiceAccount:i,configString:l,isSaving:s,savingError:u}=(0,ye.useSelector)(e,(0,d.useCallback)((e=>({kafka:e.context.kafka,cluster:e.context.cluster,connectorType:e.context.connectorType,name:e.context.name,userServiceAccount:e.context.userServiceAccount,topic:e.context.topic,userErrorHandler:e.context.userErrorHandler,configString:e.context.configString,isSaving:e.hasTag("saving"),savingError:e.context.savingError})),[]));return{kafka:t,cluster:n,connectorType:a,topic:r,userErrorHandler:o,name:c,userServiceAccount:i,configString:l,isSaving:s,savingError:u}},Rt=({onHelp:e})=>{const{t}=(0,p.useTranslation)();return u().createElement(m.EmptyState,{variant:m.EmptyStateVariant.xl,className:(0,ce.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},u().createElement(m.EmptyStateIcon,{icon:g.ClusterIcon}),u().createElement(m.Title,{headingLevel:"h1",size:m.TitleSizes["4xl"]},t("No OSD Cluster available")),u().createElement(m.EmptyStateBody,null,u().createElement(p.Trans,null,"Development preview instances are available for creation. For help getting started, access the"," ",u().createElement(m.Button,{variant:m.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:e},"quick start guide."))))},zt=({title:e,description:t,component:n,children:a})=>u().createElement("div",{className:"pf-l-stack"},u().createElement("div",{className:"pf-l-stack__item pf-u-p-md"},u().createElement(m.Level,null,u().createElement(m.LevelItem,null,u().createElement(m.Title,{headingLevel:"h2"},e)),u().createElement(m.LevelItem,null,n)),"string"==typeof t?u().createElement("p",{className:"wizard-step__description"},t):t),u().createElement("div",{className:"pf-l-stack__item pf-l-stack pf-m-fill pf-u-pl-md pf-u-pr-md  pf-u-pb-md"},a));function Gt(){return(()=>{const{clusterRef:e}=Dt();return(0,ye.useSelector)(e,(0,d.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?u().createElement(Vt,null):null}const Vt=()=>{const{t:e}=(0,p.useTranslation)(),{response:t,selectedId:n,loading:a,error:r,noResults:o,queryEmpty:c,firstRequest:i,onSelect:l,onQuery:s}=jt();return u().createElement(zt,{title:e("OSD cluster"),description:e("clusterStepDescription")},(()=>{var e;switch(!0){case i:return u().createElement(C.g,null);case c:return u().createElement(u().Fragment,null,u().createElement(Mt,null),u().createElement(he,{onClear:()=>s({page:1,size:10})}));case o||r:return u().createElement(Rt,{onHelp:function(){throw new Error("Function not implemented.")}});case a:return u().createElement(u().Fragment,null,u().createElement(Mt,null),u().createElement(C.g,null));default:return u().createElement(u().Fragment,null,u().createElement(Mt,null),u().createElement("div",{className:"pf-l-stack__item pf-m-fill"},u().createElement(m.Gallery,{hasGutter:!0},null===(e=null==t?void 0:t.items)||void 0===e?void 0:e.map((e=>u().createElement(m.Card,{isHoverable:!0,key:e.id,isSelectable:!0,isSelected:n===e.id,onClick:()=>l(e.id)},u().createElement(m.CardHeader,null,u().createElement(m.CardTitle,null,e.name)),u().createElement(m.CardBody,null,u().createElement(m.DescriptionList,null,u().createElement(m.DescriptionListGroup,null,u().createElement(m.DescriptionListTerm,null,"Owner"),u().createElement(m.DescriptionListDescription,null,e.owner)),u().createElement(m.DescriptionListGroup,null,u().createElement(m.DescriptionListTerm,null,"Created"),u().createElement(m.DescriptionListDescription,null,e.created_at))))))))))}})())},Mt=()=>{const{request:e,onQuery:t}=jt(),n=(0,d.useRef)(null),a=me(t,1e3),r=u().createElement(u().Fragment,null,u().createElement(m.ToolbarItem,null,u().createElement(m.InputGroup,null,u().createElement(m.TextInput,{name:"textInput2",id:"textInput2",type:"search","aria-label":"search input example",onChange:t=>a({size:e.size,page:1,name:t}),ref:n}),u().createElement(m.Button,{variant:"control","aria-label":"search button for search input"},u().createElement(g.SearchIcon,null))))),o=u().createElement(u().Fragment,null,u().createElement(m.ToolbarToggleGroup,{toggleIcon:u().createElement(g.FilterIcon,null),breakpoint:"xl"},r),u().createElement(m.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},u().createElement(Ht,{isCompact:!0})));return u().createElement(m.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl"},u().createElement(m.ToolbarContent,null,o))},Ht=({isCompact:e=!1})=>{const{request:t,response:n,onQuery:a}=jt();return u().createElement(de,{itemCount:(null==n?void 0:n.total)||0,page:t.page,perPage:t.size,onChange:(e,t)=>a({page:e,size:t}),isCompact:e})};var Kt=n(2899);const Jt=({isOpen:e,sACreated:t,handleModalToggle:n,serviceAccount:r,onSetServiceAccount:c,onSetSaCreated:i})=>{const[p,v]=(0,d.useState)(!1),[f,E]=(0,d.useState)(""),[C,h]=(0,d.useState)("default"),[y,b]=(0,d.useState)(!1),{kafkaManagementApiBasePath:S,getToken:k}=T(),x=(0,I.useAlert)();return u().createElement(m.Modal,{variant:m.ModalVariant.medium,title:t?"":(0,Kt.t)("create_service_account"),isOpen:e,onClose:n,actions:t?[]:[u().createElement(m.Button,{key:"Create",variant:"primary",spinnerAriaValueText:y?(0,Kt.t)("Loading"):void 0,isLoading:y,isDisabled:"error"===C||y,onClick:()=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){if("default"===C&&0===f.length)h("error");else{let e;b(!0);try{e=yield(({accessToken:e,kafkaManagementApiBasePath:t,sortDesc:n})=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const a=o().CancelToken.source(),r=new s.SecurityApi(new l.Configuration({accessToken:e,basePath:t})),c=yield r.createServiceAccount({name:`connector-${n}`},{cancelToken:a.token});return{clientId:c.data.client_id,clientSecret:c.data.client_secret}})))({accessToken:k,kafkaManagementApiBasePath:S,sortDesc:f}),i(!0),c(null!=e?e:{clientId:"",clientSecret:""}),b(!1)}catch(e){console.log("Error:",e),b(!1),null==x||x.addAlert({id:"connectors-table-error",variant:m.AlertVariant.danger,title:(0,Kt.t)("something_went_wrong"),description:"error"})}}}))},(0,Kt.t)("Create")),u().createElement(m.Button,{key:"cancel",variant:"link",onClick:n},(0,Kt.t)("Cancel"))]},t?u().createElement(m.EmptyState,{variant:m.EmptyStateVariant.large},u().createElement(m.EmptyStateIcon,{icon:g.KeyIcon}),u().createElement(m.Title,{headingLevel:"h4",size:"lg"},(0,Kt.t)("credentials-generated")),u().createElement(m.TextContent,{className:"pf-u-mt-lg"},u().createElement(m.Text,{component:m.TextVariants.small},(0,Kt.t)("connect-kafka-with-sa"))),u().createElement(m.InputGroup,{className:"pf-u-mt-lg"},u().createElement(m.InputGroupText,{style:{whiteSpace:"nowrap"},id:"Client-id-value"},(0,Kt.t)("client-id")),u().createElement(m.ClipboardCopy,{isReadOnly:!0,className:"pf-u-w-100",hoverTip:(0,Kt.t)("copy"),clickTip:(0,Kt.t)("copied")},r.clientId)),u().createElement(m.InputGroup,{className:"pf-u-mt-lg"},u().createElement(m.InputGroupText,{style:{whiteSpace:"nowrap"},id:"Client-secret-value"},(0,Kt.t)("client-secret")),u().createElement(m.ClipboardCopy,{className:"pf-u-w-100",isReadOnly:!0,hoverTip:(0,Kt.t)("copy"),clickTip:(0,Kt.t)("copied")},r.clientSecret)),u().createElement(m.TextContent,{className:"pf-u-mt-lg"},u().createElement(m.Text,{component:m.TextVariants.small},(0,Kt.t)("service-account-alert-msg"))),u().createElement(m.Bullseye,{className:"pf-u-mt-lg"},u().createElement(m.Checkbox,{id:"copied",label:(0,Kt.t)("copied-clientid-secret"),"aria-label":(0,Kt.t)("copied-clientid-secret"),onChange:()=>v(!p),isChecked:p})),u().createElement(m.Button,{variant:"primary",isDisabled:!p,onClick:n},(0,Kt.t)("close"))):u().createElement(m.Form,null,u().createElement(m.FormGroup,{label:(0,Kt.t)("short-description"),labelIcon:u().createElement(m.Popover,{headerContent:u().createElement("div",null,(0,Kt.t)("short-description")),bodyContent:u().createElement("div",null,(0,Kt.t)("short-description-help-text"))},u().createElement("button",{type:"button","aria-label":(0,Kt.t)("short-description-tooltip"),onClick:e=>e.preventDefault(),"aria-describedby":"short-description",className:"pf-c-form__group-label-help"},u().createElement(g.HelpIcon,{noVerticalAlign:!0}))),isRequired:!0,fieldId:"short-description-01",helperText:(0,Kt.t)("short-description-example-text"),helperTextInvalid:f.length>0?(0,Kt.t)("short-description-example-text"):(0,Kt.t)("required"),validated:C},u().createElement(m.TextInput,{isRequired:!0,validated:C,type:"text",id:"short-description-01",name:"short-description-01","aria-describedby":"short-description",value:f,onChange:(e,t)=>{h(/^[A-Za-z0-9-]+$/.test(e)?"success":"error"),E(e)}}))))},$t=()=>{const{t:e}=(0,p.useTranslation)(),{name:t,serviceAccount:n,sACreated:a,onSetSaCreated:r,onSetName:o,onSetServiceAccount:c}=(()=>{const{basicRef:e}=Dt(),{name:t,sACreated:n,serviceAccount:a}=(0,ye.useSelector)(e,(0,d.useCallback)((e=>({name:e.context.name,sACreated:e.context.sACreated,serviceAccount:e.context.userServiceAccount})),[])),r=(0,d.useCallback)((t=>{e.send({type:"setName",name:t})}),[e]),o=(0,d.useCallback)((t=>{e.send({type:"setSaCreated",sACreated:t})}),[e]),c=(0,d.useCallback)((t=>{e.send({type:"setServiceAccount",serviceAccount:t})}),[e]);return{serviceAccount:a,name:t,sACreated:n,onSetSaCreated:o,onSetName:r,onSetServiceAccount:c}})(),[i,l]=(0,d.useState)(!1),s=()=>{l(!i)};return(0,d.useEffect)((()=>{null!=n||c({clientId:"",clientSecret:""})}),[]),u().createElement(u().Fragment,null,u().createElement(zt,{title:e("Common"),description:e("basicStepDescription")},u().createElement(m.Grid,{hasGutter:!0},u().createElement(m.Form,{className:"pf-m-9-col-on-lg"},u().createElement(m.FormGroup,{label:e("Name"),isRequired:!0,fieldId:"name",helperText:"Please provide a unique name for the connector",className:"pf-u-mb-0"},u().createElement(m.TextInput,{value:t,onChange:o,id:"name"})),u().createElement(m.FormGroup,{label:e("Service account"),fieldId:"service-account",className:"pf-u-mb-0"},u().createElement(m.TextContent,null,u().createElement("span",{className:"step-common_service_account-desc"},e("service-account-desc-text"))),u().createElement(m.Button,{variant:"secondary",onClick:s,className:"pf-u-mt-md",isDisabled:a},e("create-service-account"))),n&&u().createElement(u().Fragment,null,u().createElement(m.FormGroup,{label:e("client-id"),isRequired:!0,fieldId:"clientId",className:"pf-u-mb-0"},u().createElement(m.TextInput,{value:n.clientId,onChange:e=>c(Object.assign(Object.assign({},n),{clientId:e})),id:"clientId"})),u().createElement(m.FormGroup,{label:e("client-secret"),isRequired:!0,fieldId:"clientSecret",className:"pf-u-mb-0"},u().createElement(m.TextInput,{value:n.clientSecret,onChange:e=>c(Object.assign(Object.assign({},n),{clientSecret:e})),id:"clientSecret"})))))),u().createElement(Jt,{isOpen:i,handleModalToggle:s,serviceAccount:n,onSetServiceAccount:c,onSetSaCreated:r,sACreated:a}))},Wt=({actor:e,Configurator:t})=>{const{activeStep:n,configuration:a,connector:r}=(0,ye.useSelector)(e,(0,d.useCallback)((e=>({connector:e.context.connector,activeStep:e.context.activeStep,configuration:e.context.configuration})),[e]));return u().createElement(t,{activeStep:n,configuration:a,connector:r,onChange:(t,n)=>e.send({type:"change",configuration:t,isValid:n})})},Ut=({actor:e})=>{const{configuration:t,connector:n}=(0,ye.useSelector)(e,(0,d.useCallback)((e=>({connector:e.context.connector,configuration:e.context.configuration})),[e]));return u().createElement(K,{schema:n.schema,configuration:t||{},onChange:(t,n)=>e.send({type:"change",configuration:t,isValid:n})})},Qt=()=>{const{t:e}=(0,p.useTranslation)(),t=_t(),{isLoading:n,hasErrors:a,Configurator:r,configuratorRef:o,hasCustomConfigurator:c}=(0,ye.useSelector)(t,(0,d.useCallback)((e=>({isLoading:e.matches({configureConnector:"loadConfigurator"}),hasErrors:e.matches("failure"),hasCustomConfigurator:!1!==e.context.Configurator&&void 0!==e.context.Configurator,configuration:e.context.connectorConfiguration,Configurator:e.context.Configurator,configuratorRef:e.children.configuratorRef})),[t]));return u().createElement(zt,{title:e("Configurations"),description:e("configurationStepDescription")},(()=>{switch(!0){case n:return u().createElement(m.EmptyState,null,u().createElement(m.EmptyStateIcon,{variant:"container",component:m.Spinner}),u().createElement(m.Title,{size:"lg",headingLevel:"h4"},e("loading")));case a:return u().createElement(m.EmptyState,null,u().createElement(m.EmptyStateIcon,{icon:g.ExclamationCircleIcon}),u().createElement(m.Title,{size:"lg",headingLevel:"h4"},"Error message"));case c:return u().createElement(u().Suspense,{fallback:null},u().createElement(Wt,{actor:o,Configurator:r}));default:return u().createElement(Ut,{actor:o})}})())},Zt=(e,t)=>({key:e,node:t(e)});function Yt(){return(()=>{const{connectorTypeRef:e}=Dt();return(0,ye.useSelector)(e,(0,d.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?u().createElement(Xt,null):null}function Xt(){const{t:e}=(0,p.useTranslation)(),{response:t,loading:n,error:a,noResults:r,queryEmpty:o,firstRequest:c,selectedId:i,onSelect:l,onQuery:s}=Ft();return u().createElement(zt,{title:e("Connector"),description:e("connectorTypeStepDescription")},(()=>{var e;switch(!0){case c:return u().createElement(C.g,null);case o:return u().createElement(u().Fragment,null,u().createElement(en,null),u().createElement(he,{onClear:()=>s({page:1,size:10})}));case r||a:return u().createElement(fe,null);case n:return u().createElement(u().Fragment,null,u().createElement(en,null),u().createElement(C.g,null));default:return u().createElement(u().Fragment,null,u().createElement(en,null),u().createElement("div",{className:"pf-l-stack__item pf-m-fill"},u().createElement(m.Gallery,{hasGutter:!0},null===(e=null==t?void 0:t.items)||void 0===e?void 0:e.map((e=>u().createElement(m.Card,{isHoverable:!0,key:e.id,isSelectable:!0,isSelected:i===e.id,onClick:()=>l(e.id)},u().createElement(m.CardHeader,null,u().createElement(m.CardTitle,null,e.name)),u().createElement(m.CardBody,null,u().createElement(m.DescriptionList,null,u().createElement(m.DescriptionListGroup,null,u().createElement(m.DescriptionListDescription,null,e.description)),u().createElement(m.DescriptionListGroup,null,u().createElement(m.DescriptionListTerm,null,"Version"),u().createElement(m.DescriptionListDescription,null,e.version)),u().createElement(m.DescriptionListGroup,null,u().createElement(m.DescriptionListTerm,null,"ID"),u().createElement(m.DescriptionListDescription,null,e.id))))))))))}})())}const en=()=>{const{t:e}=(0,p.useTranslation)(),{request:t,onQuery:n}=Ft(),[a,r]=(0,d.useState)(!1),o=(0,d.useRef)(null),c=me(n,1e3),{name:i,categories:l=[]}=t.query||{},s=(0,d.useCallback)((()=>n({page:1,size:t.size})),[n,t.size]),v=(0,d.useCallback)((()=>r((e=>!e))),[]),f=(e,a)=>{((e,a,r)=>{n(Object.assign(Object.assign({},t),{query:Object.assign(Object.assign({},t.query||{}),{[e]:a.includes(r)?a.filter((e=>e!==r)):[...a||[],r]})}))})("categories",l,a.key)};(0,d.useEffect)((()=>{o.current&&(o.current.value=i||"")}),[o,i]);const E=[u().createElement(m.SelectOption,{key:"sink",value:"sink"},e("sink")),u().createElement(m.SelectOption,{key:"source",value:"source"},e("source"))],C=u().createElement(u().Fragment,null,u().createElement(m.ToolbarItem,null,u().createElement(m.InputGroup,null,u().createElement(m.TextInput,{name:"name",id:"name",type:"search","aria-label":"filter by connector name",onChange:e=>c({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{name:e})}),ref:o}),u().createElement(m.Button,{variant:"control","aria-label":"search button for search input"},u().createElement(g.SearchIcon,null)))),u().createElement(m.ToolbarGroup,{variant:"filter-group"},u().createElement(m.ToolbarFilter,{chips:l.map((t=>Zt(t,e))),deleteChip:f,deleteChipGroup:()=>{return e="categories",n(Object.assign(Object.assign({},t),{query:Object.assign(Object.assign({},t.query||{}),{[e]:void 0})}));var e},categoryName:"Connector type"},u().createElement(m.Select,{variant:"checkbox","aria-label":"Connector type",onToggle:v,onSelect:(t,n)=>f(0,Zt(n,e)),selections:l,isOpen:a,placeholderText:"Connector type"},E)))),h=u().createElement(u().Fragment,null,u().createElement(m.ToolbarToggleGroup,{toggleIcon:u().createElement(g.FilterIcon,null),breakpoint:"xl"},C),u().createElement(m.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},u().createElement(tn,{isCompact:!0})));return u().createElement(m.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl",clearAllFilters:s},u().createElement(m.ToolbarContent,{className:"pf-m-no-padding"},h))},tn=({isCompact:e=!1})=>{const{request:t,response:n,onQuery:a}=Ft();return u().createElement(de,{itemCount:(null==n?void 0:n.total)||0,page:t.page,perPage:t.size,onChange:(e,t)=>a({page:e,size:t}),isCompact:e})},nn=()=>{var e;const[t,n]=u().useState(!1),{t:a}=(0,p.useTranslation)(),{connector:r,topic:o,errorHandler:c,onSetTopic:i,onSetErrorHandler:l}=(()=>{const{errorRef:e}=Dt(),{connector:t,topic:n,errorHandler:a}=(0,ye.useSelector)(e,(0,d.useCallback)((e=>({topic:e.context.topic,errorHandler:e.context.userErrorHandler,connector:e.context.connector})),[])),r=(0,d.useCallback)((t=>{e.send({type:"setTopic",topic:t})}),[e]),o=(0,d.useCallback)((t=>{e.send({type:"setErrorHandler",errorHandler:t})}),[e]);return{errorHandler:a,topic:n,onSetErrorHandler:o,onSetTopic:r,connector:t}})(),s=(0,d.useCallback)((()=>n((e=>!e))),[]),g=(0,d.useCallback)(((e,t,a)=>{a?v():(n(!1),i(""),l(t))}),[]),v=(0,d.useCallback)((()=>{n(!1)}),[]),f=q(r.schema),E=new z.JSONSchemaBridge(r.schema,f),{error_handler:C}=null===(e=E.schema)||void 0===e?void 0:e.properties,h=C.oneOf.map((e=>{const t=Object.keys(e.properties);return u().createElement(m.SelectOption,{key:t[0],value:t[0]})}));return u().createElement(zt,{title:a("Error handler"),description:a("Configure error handling stop, log and dead letter queues")},u().createElement(m.Grid,{hasGutter:!0},u().createElement(m.Form,{className:"pf-m-9-col-on-lg"},u().createElement(m.FormGroup,{label:a("Error handler"),fieldId:"error-handler_strategy",className:"error-handler_strategy pf-u-mb-0"},u().createElement(m.Select,{variant:m.SelectVariant.single,"aria-label":"Select Error handler",onToggle:s,onSelect:g,selections:c,isOpen:t,placeholderText:"Select type"},h)),"dead_letter_queue"===c&&u().createElement(m.FormGroup,{label:"Dead Letter Topic Name",isRequired:!0,fieldId:"topic",helperText:"The name of the Kafka topic used as dead letter queue"},u().createElement(m.TextInput,{value:o,onChange:i,id:"topic"})))))},an=({onHelp:e})=>{const{t}=(0,p.useTranslation)();return u().createElement(m.EmptyState,{variant:m.EmptyStateVariant.xl,className:(0,ce.css)("pf-u-pt-2xl pf-u-pt-3xl-on-md")},u().createElement(m.EmptyStateIcon,{icon:g.SpaceShuttleIcon}),u().createElement(m.Title,{headingLevel:"h1",size:m.TitleSizes["4xl"]},t("No Kafka instance available")),u().createElement(m.EmptyStateBody,null,u().createElement(p.Trans,null,"Development preview instances are available for creation. For help getting started, access the"," ",u().createElement(m.Button,{variant:m.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:e},"quick start guide."))))},rn=()=>(()=>{const{kafkaRef:e}=Dt();return(0,ye.useSelector)(e,(0,d.useCallback)((e=>e.matches({root:{api:"ready"}})),[e]))})()?u().createElement(on,null):null,on=()=>{const{t:e}=(0,p.useTranslation)(),{response:t,loading:n,error:a,selectedId:r,noResults:o,queryEmpty:c,firstRequest:i,onSelect:l,onQuery:s}=qt();return u().createElement(zt,{title:e("Kafka instance"),description:e("kafkaStepDescription")},(()=>{var e;switch(!0){case i:return u().createElement(C.g,null);case c:return u().createElement(u().Fragment,null,u().createElement(cn,null),u().createElement(he,{onClear:()=>s({page:1,size:10})}));case o||a:return u().createElement(an,{onHelp:function(){throw new Error("Function not implemented.")}});case n:return u().createElement(u().Fragment,null,u().createElement(cn,null),u().createElement(C.g,null));default:return u().createElement(u().Fragment,null,u().createElement(cn,null),u().createElement("div",{className:"pf-l-stack__item pf-m-fill"},u().createElement(m.Gallery,{hasGutter:!0},null===(e=null==t?void 0:t.items)||void 0===e?void 0:e.map((e=>u().createElement(m.Card,{isHoverable:!0,key:e.id,isSelectable:!0,isSelected:r===e.id,onClick:()=>l(e.id)},u().createElement(m.CardHeader,null,u().createElement(m.CardTitle,null,e.name)),u().createElement(m.CardBody,null,u().createElement(m.DescriptionList,null,u().createElement(m.DescriptionListGroup,null,u().createElement(m.DescriptionListTerm,null,"Region"),u().createElement(m.DescriptionListDescription,null,e.region)),u().createElement(m.DescriptionListGroup,null,u().createElement(m.DescriptionListTerm,null,"Owner"),u().createElement(m.DescriptionListDescription,null,e.owner)),u().createElement(m.DescriptionListGroup,null,u().createElement(m.DescriptionListTerm,null,"Created"),u().createElement(m.DescriptionListDescription,null,e.created_at))))))))))}})())},cn=()=>{const{t:e}=(0,p.useTranslation)(),{request:t,onQuery:n}=qt(),[a,r]=(0,d.useState)(!1),[o,c]=(0,d.useState)(!1),[i,l]=(0,d.useState)(!1),[s,v]=(0,d.useState)(!1),[f,E]=(0,d.useState)("Name"),C=(0,d.useCallback)((()=>r((e=>!e))),[]),h=(0,d.useCallback)((()=>c((e=>!e))),[]),y=(0,d.useCallback)((()=>l((e=>!e))),[]),b=(0,d.useCallback)((()=>v((e=>!e))),[]),S=me(n,1e3),{name:T,owner:k,cloudProviders:I=[],regions:x=[],statuses:w=[]}=t.query||{},A=(0,d.useCallback)((()=>n({page:1,size:t.size})),[n,t.size]),P=(0,d.useRef)(null),B=(0,d.useRef)(null),O=(e,a,r)=>n(Object.assign(Object.assign({},t),{query:Object.assign(Object.assign({},t.query||{}),{[e]:a.includes(r)?a.filter((e=>e!==r)):[...a||[],r]})})),N=(e,t)=>{O("statuses",w,t.key)},_=(e,t)=>{O("cloudProviders",I,t.key)},D=(e,t)=>{O("regions",x,t.key)},j=e=>n(Object.assign(Object.assign({},t),{query:Object.assign(Object.assign({},t.query||{}),{[e]:void 0})})),F=(0,d.useCallback)((e=>{const t=(null==e?void 0:e.target).innerText;E(t),v((e=>!e))}),[]);(0,d.useEffect)((()=>{P.current&&(P.current.value=T||""),B.current&&(B.current.value=k||"")}),[P,T,k]);const q=ln.map((({value:e,label:t})=>u().createElement(m.DropdownItem,{key:e},t))),L=dn.filter((e=>"preparing"!==e.value)).map((({value:e,label:t})=>u().createElement(m.SelectOption,{key:e,value:e},t))),R=sn.map((({value:e,label:t})=>u().createElement(m.SelectOption,{key:e,value:e},t))),z=un.map((({value:e,label:t})=>u().createElement(m.SelectOption,{key:e,value:e},t))),G=u().createElement(m.ToolbarItem,null,u().createElement(m.Dropdown,{onSelect:e=>F(e),position:m.DropdownPosition.left,toggle:u().createElement(m.DropdownToggle,{onToggle:b,style:{width:"100%"}},u().createElement(g.FilterIcon,{size:"sm"})," ",f),isOpen:s,dropdownItems:q,style:{width:"100%"}})),V=u().createElement(u().Fragment,null,u().createElement(m.ToolbarGroup,{variant:"filter-group"},G,u().createElement(m.ToolbarFilter,{chips:w.map((t=>Zt(t,e))),deleteChip:N,deleteChipGroup:()=>j("statuses"),categoryName:e("status"),showToolbarItem:f===e("status")},u().createElement(m.Select,{variant:"checkbox","aria-label":e("status"),onToggle:C,onSelect:(t,n)=>N(0,Zt(n,e)),selections:w,isOpen:a,placeholderText:e("Filter by status")},L)),u().createElement(m.ToolbarFilter,{chips:I.map((t=>Zt(t,e))),deleteChip:_,deleteChipGroup:()=>j("cloudProviders"),categoryName:e("CloudProvider"),showToolbarItem:f===e("CloudProvider")},u().createElement(m.Select,{variant:"checkbox","aria-label":e("CloudProvider"),onToggle:h,onSelect:(t,n)=>_(0,Zt(n,e)),selections:I,isOpen:o,placeholderText:e("Filter by cloud provider")},R)),u().createElement(m.ToolbarFilter,{chips:x.map((t=>Zt(t,e))),deleteChip:D,deleteChipGroup:()=>j("regions"),categoryName:e("region"),showToolbarItem:f===e("region")},u().createElement(m.Select,{variant:"checkbox","aria-label":e("region"),onToggle:y,onSelect:(t,n)=>D(0,Zt(n,e)),selections:x,isOpen:i,placeholderText:e("Filter by region")},z)),u().createElement(m.ToolbarFilter,{chips:T?[T]:[],deleteChip:()=>j("name"),categoryName:e("name")},f===e("name")&&u().createElement(m.ToolbarItem,null,u().createElement(m.InputGroup,null,u().createElement(m.TextInput,{name:e("name"),id:e("name"),type:"search",placeholder:e("nameSearchPlaceholder"),"aria-label":e("nameSearchPlaceholder"),onChange:e=>S({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{name:e})}),ref:P}),u().createElement(m.Button,{variant:"control","aria-label":"search button for name input",onClick:()=>{var e;return n({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{name:(null===(e=P.current)||void 0===e?void 0:e.value)||""})})}},u().createElement(g.SearchIcon,null))))),u().createElement(m.ToolbarFilter,{chips:k?[k]:[],deleteChip:()=>j("owner"),categoryName:e("owner")},f===e("owner")&&u().createElement(m.ToolbarItem,null,u().createElement(m.InputGroup,null,u().createElement(m.TextInput,{name:e("owner"),id:e("owner"),type:"search",placeholder:e("ownerSearchPlaceholder"),"aria-label":e("ownerSearchPlaceholder"),onChange:e=>S({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{owner:e})}),ref:B}),u().createElement(m.Button,{variant:"control","aria-label":"search button for owner input",onClick:()=>{var e;return n({size:t.size,page:1,query:Object.assign(Object.assign({},t.query),{owner:(null===(e=B.current)||void 0===e?void 0:e.value)||""})})}},u().createElement(g.SearchIcon,null))))))),M=u().createElement(u().Fragment,null,u().createElement(m.ToolbarToggleGroup,{toggleIcon:u().createElement(g.FilterIcon,null),breakpoint:"xl"},V),u().createElement(m.ToolbarGroup,{variant:"icon-button-group"},u().createElement(m.ToolbarItem,null,u().createElement(m.Button,{variant:"primary"},e("Create Kafka instance")))),u().createElement(m.ToolbarItem,{variant:"pagination",alignment:{default:"alignRight"}},u().createElement(pn,{isCompact:!0})));return u().createElement(m.Toolbar,{id:"toolbar-group-types",collapseListedFiltersBreakpoint:"xl",clearAllFilters:A},u().createElement(m.ToolbarContent,null,M))},ln=[{value:"name",label:"Name"},{value:"status",label:"Status"},{value:"cloudprovider",label:"Cloud Provider"},{value:"region",label:"Region"},{value:"owner",label:"Owner"}],sn=[{value:"aws",label:"Amazon Web Services"}],dn=[{value:"ready",label:"Ready"},{value:"failed",label:"Failed"},{value:"accepted",label:"Creation pending"},{value:"provisioning",label:"Creation in progress"},{value:"preparing",label:"Creation in progress"},{value:"deprovision",label:"Deletion in progress"}],un=[{value:"us-east-1",label:"US East, N. Virginia"}],pn=({isCompact:e=!1})=>{const{request:t,response:n,onQuery:a}=qt();return u().createElement(de,{itemCount:(null==n?void 0:n.total)||0,page:t.page,perPage:t.size,onChange:(e,t)=>a({page:e,size:t}),isCompact:e})},mn=()=>{const[e,t]=u().useState(!1),[n,r]=u().useState(!1),o=u().useRef(),c=u().useRef();const{configString:i}=Lt();const l=(e,t)=>t?e:function(e){const t=["secretKey","accessKey"];return JSON.stringify(e,((e,n)=>-1===t.indexOf(e)?n:"*".repeat(n.length)),2)}(JSON.parse(e)),s=(e,n)=>{((e,t)=>{const n=e.currentTarget.parentElement,a=document.createElement("textarea");a.value=t.toString(),n.appendChild(a),a.select(),document.execCommand("copy"),n.removeChild(a)})(e,n),t(!0)},d=u().createElement(u().Fragment,null,u().createElement(m.CodeBlockAction,null,u().createElement(m.Button,{variant:"plain",ref:c,"aria-label":"show hidden fields icon",onClick:()=>r(!n)},n?u().createElement(g.EyeSlashIcon,null):u().createElement(g.EyeIcon,null)),u().createElement(m.Tooltip,{content:u().createElement("div",null,n?"Hide service account":"Show service account"),reference:c})),u().createElement(m.CodeBlockAction,null,u().createElement(m.ClipboardCopyButton,{id:"copy-button",textId:"code-content","aria-label":"Copy to clipboard",onClick:e=>s(e,l(i,n)),exitDelay:600,maxWidth:"110px",variant:"plain"},e?"Successfully copied to clipboard!":"Copy to clipboard")),u().createElement(m.CodeBlockAction,null,u().createElement(m.Button,{variant:"plain",ref:o,"aria-label":"Download icon",onClick:e=>{return t=e,r=l(i,n),(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const e=t.currentTarget.parentElement,n=new Blob([r],{type:"application/json"}),a=yield URL.createObjectURL(n),o=document.createElement("a");o.href=a,o.download="connectorConfig.json",e.appendChild(o),o.click(),e.removeChild(o)}));var t,r}},u().createElement(g.FileDownloadIcon,null)),u().createElement(m.Tooltip,{content:u().createElement("div",null,"Download JSON"),reference:o})));return u().createElement(m.CodeBlock,{actions:d},u().createElement(m.CodeBlockCode,{id:"code-content"},l(i,n)))};function gn(){var e;const{t}=(0,p.useTranslation)(),[n,a]=(0,d.useState)(!1),[r,o]=(0,d.useState)({clientId:!0,clientSecret:!0,accessKey:!0,secretKey:!0}),c=e=>{let t=Object.assign({},r);switch(e.currentTarget.id){case"clientId":t.clientId=!r.clientId,o(t);break;case"clientSecret":t.clientSecret=!r.clientSecret,o(t);break;case"accessKey":t.accessKey=!r.accessKey,o(t);break;case"secretKey":t.secretKey=!r.secretKey,o(t)}},{kafka:l,cluster:s,connectorType:v,name:f,topic:E,userErrorHandler:C,userServiceAccount:h,configString:y,savingError:b}=Lt(),S=(0,d.useCallback)((()=>a((e=>!e))),[]),T=JSON.parse(y),k=JSON.parse(y).connector,I=JSON.parse(y).kafka,x=i().mapKeys(T,((e,t)=>t.replace(/\./g,"_"))),w=e=>"*".repeat(e.length);return u().createElement(zt,{title:t("Review"),description:t(n?"reviewJSONStepDescription":"reviewStepDescription"),component:u().createElement(m.Switch,{id:"toggle-json-view",label:t("ViewJSONFormat"),labelOff:t("ViewJSONFormat"),isChecked:n,onChange:S})},u().createElement(m.Form,null,b&&u().createElement(m.FormAlert,null,u().createElement(m.Alert,{variant:"danger",title:b,"aria-live":"polite",isInline:!0})),n?u().createElement(mn,null):u().createElement(u().Fragment,null,u().createElement(m.Grid,null,u().createElement(m.GridItem,{span:4},u().createElement("strong",null,t("Connector category"))),u().createElement(m.GridItem,{span:8},v.description)),u().createElement(m.Grid,null,u().createElement(m.GridItem,{span:4},u().createElement("strong",null,t("Kafka instance"))),u().createElement(m.GridItem,{span:8},l.name)),u().createElement(m.Grid,null,u().createElement(m.GridItem,{span:4},u().createElement("strong",null,t("OSD Cluster"))),u().createElement(m.GridItem,{span:8},s.name)),u().createElement(m.Title,{headingLevel:"h3",size:m.TitleSizes["2xl"]},t("Basic")),u().createElement(m.Grid,null,u().createElement(m.GridItem,{span:4},u().createElement("strong",null,t("Connector name"))),u().createElement(m.GridItem,{span:8},f)),u().createElement(m.Grid,null,u().createElement(m.GridItem,{span:4},u().createElement("strong",null,t("Type"))),u().createElement(m.GridItem,{span:8},null===(e=v.labels)||void 0===e?void 0:e.map((e=>e)))),(null==h?void 0:h.clientId)&&u().createElement(m.Grid,null,u().createElement(m.GridItem,{span:4},u().createElement("strong",null,t("client-id"))),u().createElement(m.GridItem,{span:8},u().createElement(m.Flex,null,u().createElement(m.FlexItem,null,r.clientId?w(null==h?void 0:h.clientId):null==h?void 0:h.clientId),u().createElement(m.FlexItem,{onClick:c,id:"clientId"},r.clientId?u().createElement(g.EyeIcon,null):u().createElement(g.EyeSlashIcon,null))))),(null==h?void 0:h.clientSecret)&&u().createElement(m.Grid,null,u().createElement(m.GridItem,{span:4},u().createElement("strong",null,t("client-secret"))),u().createElement(m.GridItem,{span:8},u().createElement(m.Flex,null,u().createElement(m.FlexItem,null,r.clientSecret?w(null==h?void 0:h.clientSecret):null==h?void 0:h.clientSecret),u().createElement(m.FlexItem,{onClick:c,id:"clientSecret"},r.clientSecret?u().createElement(g.EyeIcon,null):u().createElement(g.EyeSlashIcon,null))))),u().createElement(m.Title,{headingLevel:"h3",size:m.TitleSizes["2xl"]},t("Connector specific")),k&&Object.keys(k).map((e=>u().createElement(m.Grid,{key:e},u().createElement(m.GridItem,{span:4},u().createElement("strong",null,i().startCase(e))),u().createElement(m.GridItem,{span:8},i().startCase(e)===t("Access Key")||i().startCase(e)===t("Secret Key")?u().createElement(m.Flex,null,u().createElement(m.FlexItem,null,r[e]?w(k[e]):k[e]),u().createElement(m.FlexItem,{onClick:c,id:e},r[e]?u().createElement(g.EyeIcon,null):u().createElement(g.EyeSlashIcon,null))):k[e])))),I&&Object.keys(I).map((e=>u().createElement(m.Grid,{key:e},u().createElement(m.GridItem,{span:4},u().createElement("strong",null,i().startCase(e))),u().createElement(m.GridItem,{span:8},I[e])))),void 0===k&&Object.keys(x).map((e=>u().createElement(m.Grid,{key:e},u().createElement(m.GridItem,{span:4},u().createElement("strong",null,i().startCase(e))),u().createElement(m.GridItem,{span:8},i().startCase(e)===t("Database Password")||i().startCase(e)===t("Password")?w(x[e]):"object"==typeof x[e]?"data_shape"===e?u().createElement(vn,{data:x[e]}):JSON.stringify(x[e]):x[e])))),C&&u().createElement(u().Fragment,null,u().createElement(m.Title,{headingLevel:"h3",size:m.TitleSizes["2xl"]},t("Error handling")),u().createElement(m.Grid,null,u().createElement(m.GridItem,{span:4},u().createElement("strong",null,t("Error handling"))),u().createElement(m.GridItem,{span:8},C)),E&&u().createElement(m.Grid,null,u().createElement(m.GridItem,{span:4},u().createElement("strong",null,i().startCase(E))),u().createElement(m.GridItem,{span:8},E))))))}const vn=({data:e})=>u().createElement(u().Fragment,null,Object.keys(e).map((t=>u().createElement(m.TextContent,null,u().createElement(m.TextList,{component:m.TextListVariants.dl},u().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},i().upperFirst(t),":"),u().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},e[t].format))))));const fn=({onClose:e})=>{const{t}=(0,p.useTranslation)(),n=_t(),[a,r]=(0,ye.useActor)(n);let{hasCustomConfigurator:o,activeStep:c,configureSteps:i}=(0,ye.useSelector)(n,(0,d.useCallback)((e=>({isLoading:e.matches({configureConnector:"loadConfigurator"}),hasErrors:e.matches("failure"),hasCustomConfigurator:!1!==e.context.Configurator&&void 0!==e.context.Configurator,activeStep:e.context.activeConfigurationStep,configuration:e.context.connectorConfiguration,configureSteps:e.context.configurationSteps,Configurator:e.context.Configurator,configuratorRef:e.children.configuratorRef})),[n]));const l=function(){const{t:e}=(0,p.useTranslation)(),t=_t(),{isActive:n,canJumpTo:a,enableNext:r}=(0,ye.useSelector)(t,(0,d.useCallback)((e=>({isActive:e.matches("selectKafka"),canJumpTo:Bt.transition(e,"jumpToSelectKafka").changed||e.matches("selectKafka"),enableNext:Bt.transition(e,"next").changed})),[t]));return{name:e("Kafka instance"),isActive:n,component:u().createElement(A,null,u().createElement(rn,null)),canJumpTo:a,enableNext:r}}(),s=function(){const{t:e}=(0,p.useTranslation)(),t=_t(),{isActive:n,canJumpTo:a,enableNext:r}=(0,ye.useSelector)(t,(0,d.useCallback)((e=>({isActive:e.matches("basicConfiguration"),canJumpTo:Bt.transition(e,"jumpToBasicConfiguration").changed||e.matches("basicConfiguration"),enableNext:Bt.transition(e,"next").changed,activeStep:e.context.activeConfigurationStep})),[t]));return{name:e("Common"),isActive:n,component:u().createElement(A,null,u().createElement($t,null)),canJumpTo:a,enableNext:r}}(),m=function(){const{t:e}=(0,p.useTranslation)(),t=_t(),{isActive:n,canJumpTo:a,enableNext:r}=(0,ye.useSelector)(t,(0,d.useCallback)((e=>({isActive:e.matches("configureConnector"),canJumpTo:Bt.transition(e,"jumpToConfigureConnector").changed||e.matches("configureConnector"),enableNext:Bt.transition(e,"next").changed})),[t]));return{name:e("Connector Specific"),isActive:n,component:u().createElement(A,null,u().createElement(Qt,null)),canJumpTo:a,enableNext:r}}(),g=function(){const{t:e}=(0,p.useTranslation)(),t=_t(),{isActive:n,canJumpTo:a,enableNext:r}=(0,ye.useSelector)(t,(0,d.useCallback)((e=>({isActive:e.matches("errorConfiguration"),canJumpTo:Bt.transition(e,"jumpToErrorConfiguration").changed||e.matches("errorConfiguration"),enableNext:Bt.transition(e,"next").changed,activeStep:e.context.activeConfigurationStep})),[t]));return{name:e("Error handling"),isActive:n,component:u().createElement(A,null,u().createElement(nn,null)),canJumpTo:a,enableNext:r}}();if("saved"===a.value)return null;const v=e=>Bt.transition(a,{type:"jumpToConfigureConnector",subStep:e}).changed,f=[{name:t("Connector"),isActive:a.matches("selectConnector"),component:u().createElement(A,null,u().createElement(Yt,null)),canJumpTo:Bt.transition(a,"jumpToSelectConnector").changed||a.matches("selectConnector"),enableNext:Bt.transition(a,"next").changed},l,{name:t("OSD cluster"),isActive:a.matches("selectCluster"),component:u().createElement(A,null,u().createElement(Gt,null)),canJumpTo:Bt.transition(a,"jumpToSelectCluster").changed||a.matches("selectCluster"),enableNext:Bt.transition(a,"next").changed},{name:t("Configurations"),isActive:a.matches("basicConfiguration"),canJumpTo:Bt.transition(a,"jumpToBasicConfiguration").changed||a.matches("basicConfiguration"),steps:(()=>{let e=[s];return o&&void 0!==i&&i&&i.map(((t,n)=>{e.push({name:t,isActive:a.matches("configureConnector")&&c===n,component:u().createElement(A,null,u().createElement(Qt,null)),canJumpTo:v(n+1),enableNext:Bt.transition(a,"next").changed})})),(!o&&void 0===i||!1===i)&&(e.push(m),e.push(g)),e})()},{name:t("Review"),isActive:a.matches("reviewConfiguration"),component:u().createElement(A,null,u().createElement(gn,null)),canJumpTo:Bt.transition(a,"jumpToReviewConfiguration").changed||a.matches("reviewConfiguration"),enableNext:Bt.transition(a,"next").changed,nextButtonText:"Create connector"}],E=He(f),C=E.reduceRight(((e,t,n)=>t.isActive&&n>e?n:e),-1)+1;return u().createElement(Ke,{className:"cos",steps:f,currentStep:C,onNext:()=>r("next"),onBack:()=>r("prev"),onClose:e,onSave:()=>!1,goToStep:e=>{switch(e){case 1:r("jumpToSelectConnector");break;case 2:r("jumpToSelectKafka");break;case 3:r("jumpToSelectCluster");break;case 4:r("jumpToBasicConfiguration");break;case 5:r("jumpToConfigureConnector");break;case 6:r("jumpToErrorConfiguration");break;case E.length:r("jumpToReviewConfiguration");break;default:e<E.length&&r({type:"jumpToConfigureConnector",subStep:e-6})}},goToStepById:(...e)=>console.log("goToStepById",e),goToStepByName:(...e)=>console.log("goToStepByName",e),hasNoBodyPadding:!0})},En=({onSave:e,onClose:t})=>{const{t:n}=(0,p.useTranslation)(),a=(0,I.useConfig)(),r=(0,I.useBasename)(),{connectorsApiBasePath:o,getToken:c}=T(),[i,l]=(0,d.useState)(!1),s=()=>l(!1);return u().createElement(u().Fragment,null,u().createElement(m.PageSection,{variant:"light",hasShadowBottom:!0},u().createElement(m.Breadcrumb,null,u().createElement(m.BreadcrumbItem,{to:null==r?void 0:r.getBasename()},n("Connectors")),u().createElement(m.BreadcrumbItem,{isActive:!0},n("Create connector"))),u().createElement(m.Level,{className:"pf-u-pt-md pf-u-pb-md"},u().createElement(m.Title,{headingLevel:"h1"},n("Create connector")))),u().createElement(m.PageSection,{padding:{default:"noPadding"},style:{zIndex:0},type:"wizard"},u().createElement(Nt,{accessToken:c,connectorsApiBasePath:o,fetchConfigurator:e=>P(e,(null==a?void 0:a.cos.configurators)||{}),onSave:e},u().createElement(fn,{onClose:()=>l(!0)}),u().createElement(m.Modal,{title:n("Leave page?"),variant:"small",isOpen:i,onClose:s,actions:[u().createElement(m.Button,{key:"confirm",variant:"primary",onClick:t},"Confirm"),u().createElement(m.Button,{key:"cancel",variant:"link",onClick:s},"Cancel")]},n("Changes you have made will be lost and no connector will be created.")))))},Cn=({getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n})=>{const{t:a}=(0,p.useTranslation)(),r=(0,I.useAlert)(),o=(0,k.useHistory)(),c=(0,d.useCallback)((()=>o.push("/")),[o]),i=(0,d.useCallback)((()=>o.push("/create-connector")),[o]),l=(0,d.useCallback)(((e,t)=>o.push({pathname:`/${e}`,hash:`#${t}`})),[o]),s=(0,d.useCallback)((()=>{null==r||r.addAlert({id:"connector-created",variant:I.AlertVariant.success,title:a("wizard.creation-success")}),c()}),[r,c,a]);return u().createElement(S,{getToken:e,connectorsApiBasePath:t,kafkaManagementApiBasePath:n},u().createElement(k.Switch,null,u().createElement(k.Route,{path:"/",exact:!0},u().createElement(qe,{onCreateConnector:i,onConnectorDetail:l})),u().createElement(k.Route,{path:"/create-connector"},u().createElement(En,{onSave:s,onClose:c})),u().createElement(k.Route,{path:"/:id/"},u().createElement(ne,{onSave:c}))))}},91031:(e,t,n)=>{n.d(t,{g:()=>c});var a=n(75418),r=n.n(a),o=n(21012);const c=()=>r().createElement(o.EmptyState,null,r().createElement(o.EmptyStateIcon,{variant:"container",component:o.Spinner}),r().createElement(o.Title,{size:"lg",headingLevel:"h4"},"Loading"))},78800:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(59093),r=n(4958),o=n(2899),c=n.n(o),i=n(16486),l=n.n(i),s=n(73337),d=n.n(s),u=n(31521);const p={en:r.Z};c().use(d()).use(l()).use(u.initReactI18next).init({backend:{loadPath:`${n.p}locales/{{lng}}/{{ns}}.json`},fallbackLng:"en",load:"all",debug:!0,ns:["public"],defaultNS:"public",nsSeparator:":",keySeparator:".",interpolation:{defaultVariables:void 0,escapeValue:!1,format:(e,t,n)=>{if((0,a.isDate)(e)&&t){const o=n?p[n]:r.Z;return"short"===t?(0,a.format)(e,"P",{locale:o}):"long"===t?(0,a.format)(e,"PPPP",{locale:o}):"relative"===t?(0,a.formatRelative)(e,new Date,{locale:o}):"ago"===t?(0,a.formatDistance)(e,new Date,{locale:o,addSuffix:!0}):(0,a.format)(e,t,{locale:o})}return e}}});const m=c()}}]);
//# sourceMappingURL=7780.67fd6f9e.js.map